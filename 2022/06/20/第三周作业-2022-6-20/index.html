

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="背景：报全程班和单就业的小伙伴，本周建议学习内容：第十一天、第十二天、第十三天 、第十四天。">
<meta property="og:type" content="article">
<meta property="og:title" content="第三周作业-2022-6-20">
<meta property="og:url" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/index.html">
<meta property="og:site_name" content="5-12 23:30">
<meta property="og:description" content="背景：报全程班和单就业的小伙伴，本周建议学习内容：第十一天、第十二天、第十三天 、第十四天。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656763185363.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656763499122.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656763529259.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656763543110.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656763572737.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656763589189.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656763749199.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656237530645.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/20200319134530223.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/20200319135158648.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656239495710.png">
<meta property="og:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656239640058.png">
<meta property="article:published_time" content="2022-06-20T11:40:58.000Z">
<meta property="article:modified_time" content="2022-07-04T12:41:37.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/1656763185363.png">
  
  
  <title>第三周作业-2022-6-20 - 5-12 23:30</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="第三周作业-2022-6-20">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-06-20 11:40" pubdate>
        June 20, 2022 am
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      37k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      312 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">第三周作业-2022-6-20</h1>
            
            <div class="markdown-body">
              <h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>：报全程班和单就业的小伙伴，本周建议学习内容：第十一天、第十二天、第十三天 、第十四天。</p>
<span id="more"></span>

<p>请同学们完成作业后，将博客作业提交到此链接：<a target="_blank" rel="noopener" href="https://www.wjx.top/vj/POHTQOH.aspx%E3%80%82">https://www.wjx.top/vj/POHTQOH.aspx。</a></p>
<h1 id="章节内容"><a href="#章节内容" class="headerlink" title="章节内容"></a>章节内容</h1><p>第十一天：<br>软件管理2<br>1、ubunut软件管理<br>2、磁盘类型和结构<br>3、MBR和GPT分区类型<br>4、文件系统管理<br>5、挂载管理和swap空间管理<br>6、移动设备和raid初步<br>7、raid工作原理和特性”<br>第十二天：<br>磁盘存储和文件系统管理<br>1、逻辑卷工作原理和创建<br>2、逻辑卷扩容和缩容及快照管理<br>3、网络和OSI分层结构<br>4、局域网及网络线缆<br>5、网络设备和局域网技术<br>6、tcpip协议和tcp详解<br>7、tcp协议三次握手和四次挥手详解”<br>第十三天：<br>网络协议和管理配置<br>1、udp和internet层协议<br>2、ip地址组成和分类<br>3、网络地址规划和子网划分<br>4、网卡配置文件和命令<br>5、网络路由和配置<br>6、多网卡绑定bond和team<br>7、网桥实现和网络工具”<br>第十四天：<br>shell脚本进阶<br>1、ununtu网络配置<br>2、shell脚本编程进阶while循环和控制<br>3、shell脚本进阶shift和select<br>4、shell脚本进阶函数实现<br>5、shell脚本进阶函数递归和信号捕捉<br>6、shell脚本进阶常用工具<br>7、shell脚本进阶数组”</p>
<h1 id="作业："><a href="#作业：" class="headerlink" title="作业："></a>作业：</h1><h2 id="1、图文并茂说明raid0-raid1-raid10-raid01-raid5等原理。"><a href="#1、图文并茂说明raid0-raid1-raid10-raid01-raid5等原理。" class="headerlink" title="1、图文并茂说明raid0,raid1, raid10, raid01, raid5等原理。"></a>1、图文并茂说明raid0,raid1, raid10, raid01, raid5等原理。</h2><p>独立硬盘冗余阵列（RAID, Redundant Array of Independent Disks），旧称廉价磁盘冗余阵列 （Redundant Array of Inexpensive Disks），简称磁盘阵列。利用虚拟化存储技术把多个硬盘组合起 来，成为一个或多个硬盘阵列组，目的为提升性能或数据冗余，或是两者同时提升。 </p>
<p>RAID功能实现：1、 提高IO能力，磁盘并行读写 ；2、提高耐用性，磁盘冗余算法来实现。 </p>
<p>（1）raid0,  条带集</p>
<p>以 chunk 单位,读写数据,因为读写时都可以并行处理，所以在所有的级别中，RAID 0的速度是最快的。 但是RAID 0既没有冗余功能，也不具备容错能力，如果一个磁盘（物理）损坏，所有数据都会丢失 .</p>
<p>磁盘利用率：100%</p>
<p>优点：读写速度快</p>
<p>缺点：不容错</p>
<p>硬盘个数：2+</p>
<p><img src="1656763185363.png" srcset="/img/loading.gif" lazyload alt="1656763185363"></p>
<p>（2）raid1, 镜像集</p>
<p>也称为镜像, 两组以上的N个磁盘相互作镜像，在一些多线程操作系统中能有很好的读取速度，理论上读 取速度等于硬盘数量的倍数，与RAID 0相同。另外写入速度有微小的降低。 </p>
<p>磁盘利用率：50%</p>
<p>优点：读写速率一般，容错</p>
<p>硬盘个数：2</p>
<p><img src="1656763499122.png" srcset="/img/loading.gif" lazyload alt="1656763499122"></p>
<p>（3）raid10, 先镜像后条带（RAID1的安全+RAID0的高速）</p>
<p>磁盘利用率：50%</p>
<p>优点：读写速率快，容错</p>
<p>硬盘个数：4</p>
<p><img src="1656763529259.png" srcset="/img/loading.gif" lazyload alt="1656763529259"></p>
<p>（4）raid01, 先条带后镜像</p>
<p><img src="1656763543110.png" srcset="/img/loading.gif" lazyload alt="1656763543110"></p>
<p>（5）raid5 ，带奇偶校验的条带集</p>
<p>磁盘利用率：(n-1)/n</p>
<p>优点：读写速率快，容错，允许坏一块硬盘</p>
<p>硬盘个数：3,3+</p>
<p><img src="1656763572737.png" srcset="/img/loading.gif" lazyload alt="1656763572737"></p>
<p>（6）raid6，带奇偶校验的条带集（双份校验位,算法更复杂 ）</p>
<p>磁盘利用率：(n-2)/n</p>
<p>优点：读写速率快，容错，允许坏两块硬盘</p>
<p>硬盘个数：4,4+</p>
<p><img src="1656763589189.png" srcset="/img/loading.gif" lazyload alt="1656763589189"></p>
<h2 id="2、创建一个至少有两个PV组成的大小为20G的名为testvg的VG，要求PE大小为16M，而后在卷组中创建大小为5G的逻辑卷testlv-挂载至-users目录"><a href="#2、创建一个至少有两个PV组成的大小为20G的名为testvg的VG，要求PE大小为16M，而后在卷组中创建大小为5G的逻辑卷testlv-挂载至-users目录" class="headerlink" title="2、创建一个至少有两个PV组成的大小为20G的名为testvg的VG，要求PE大小为16M，而后在卷组中创建大小为5G的逻辑卷testlv;挂载至/users目录"></a>2、创建一个至少有两个PV组成的大小为20G的名为testvg的VG，要求PE大小为16M，而后在卷组中创建大小为5G的逻辑卷testlv;挂载至/users目录</h2><p>（1）添加硬盘</p>
<p><img src="1656763749199.png" srcset="/img/loading.gif" lazyload alt="1656763749199"></p>
<p>（2）此时系统还没有识别到新增加的硬盘 ，需要使用命令进行扫描硬盘</p>
<figure class="highlight tap"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><pre><code class="hljs tap">[root@node1 test]<span class="hljs-comment"># echo &#x27;- - -&#x27; &gt; /sys/class/scsi_host/host0/scan </span><br>[root@node1 test]<span class="hljs-comment"># ll /dev/sd*</span><br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 0 </span>Jun<span class="hljs-number"> 19 </span>07:45 /dev/sda<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 1 </span>Jun<span class="hljs-number"> 19 </span>07:45 /dev/sda1<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 2 </span>Jun<span class="hljs-number"> 19 </span>07:45 /dev/sda2<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 16 </span>Jun<span class="hljs-number"> 19 </span>07:45 /dev/sdb<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 32 </span>Jun<span class="hljs-number"> 20 </span>10:16 /dev/sdc<br>[root@node1 test]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm  /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm  [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>disk <br>sdc               8:32  <span class="hljs-number"> 0 </span>  18G <span class="hljs-number"> 0 </span>disk <br>sr0              11:0   <span class="hljs-number"> 1 </span> 4.4G <span class="hljs-number"> 0 </span>rom<br></code></pre></td></tr></table></figure>

<p>（3）创建PV</p>
<figure class="highlight irpf90"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs irpf90">[root@node1 test]# pvcreate /dev/sdb <br>  Physical volume <span class="hljs-string">&quot;/dev/sdb&quot;</span> successfully created.<br>   <br>[root@node1 test]# pvcreate /dev/sdc <br>  Physical volume <span class="hljs-string">&quot;/dev/sdc&quot;</span> successfully created.<br>  <br>[root@node1 test]# pvdisplay<br>  --- Physical volume ---<br>  PV <span class="hljs-keyword">Name</span>               /dev/sda2<br>  VG <span class="hljs-keyword">Name</span>               centos<br>  PV <span class="hljs-built_in">Size</span>               &lt;<span class="hljs-number">19.00</span> GiB / not usable <span class="hljs-number">3.00</span> MiB<br>  <span class="hljs-keyword">Allocatable</span>           yes (but full)<br>  PE <span class="hljs-built_in">Size</span>               <span class="hljs-number">4.00</span> MiB<br>  Total PE              <span class="hljs-number">4863</span><br>  <span class="hljs-keyword">Free</span> PE               <span class="hljs-number">0</span><br>  <span class="hljs-built_in">Allocated</span> PE          <span class="hljs-number">4863</span><br>  PV UUID               Pcy8Mo-duHv-KVJI-NGLy-CCln-pDEl-zUOaPV<br>   <br>  <span class="hljs-string">&quot;/dev/sdb&quot;</span> is a new physical volume of <span class="hljs-string">&quot;2.00 GiB&quot;</span><br>  --- NEW Physical volume ---<br>  PV <span class="hljs-keyword">Name</span>               /dev/sdb<br>  VG <span class="hljs-keyword">Name</span>               <br>  PV <span class="hljs-built_in">Size</span>               <span class="hljs-number">2.00</span> GiB<br>  <span class="hljs-keyword">Allocatable</span>           NO<br>  PE <span class="hljs-built_in">Size</span>               <span class="hljs-number">0</span>   <br>  Total PE              <span class="hljs-number">0</span><br>  <span class="hljs-keyword">Free</span> PE               <span class="hljs-number">0</span><br>  <span class="hljs-built_in">Allocated</span> PE          <span class="hljs-number">0</span><br>  PV UUID               sCiC1O-wM9v-ecWQ-Knx3-JCEx-jX4E-rLTmQ1<br>   <br>  <span class="hljs-string">&quot;/dev/sdc&quot;</span> is a new physical volume of <span class="hljs-string">&quot;18.00 GiB&quot;</span><br>  --- NEW Physical volume ---<br>  PV <span class="hljs-keyword">Name</span>               /dev/sdc<br>  VG <span class="hljs-keyword">Name</span>               <br>  PV <span class="hljs-built_in">Size</span>               <span class="hljs-number">18.00</span> GiB<br>  <span class="hljs-keyword">Allocatable</span>           NO<br>  PE <span class="hljs-built_in">Size</span>               <span class="hljs-number">0</span>   <br>  Total PE              <span class="hljs-number">0</span><br>  <span class="hljs-keyword">Free</span> PE               <span class="hljs-number">0</span><br>  <span class="hljs-built_in">Allocated</span> PE          <span class="hljs-number">0</span><br>  PV UUID               dsIn9M-LD1O-jD8R-<span class="hljs-number">6</span>S9b-i7ts-sJmG-GOz45s<br>  <br>  [root@node1 test]# pvs<br>  PV         VG     <span class="hljs-keyword">Fmt</span>  Attr PSize   PFree <br>  /dev/sda2  centos lvm2 a--  &lt;<span class="hljs-number">19.00</span>g     <span class="hljs-number">0</span> <br>  /dev/sdb          lvm2 ---    <span class="hljs-number">2.00</span>g  <span class="hljs-number">2.00</span>g<br>  /dev/sdc          lvm2 ---   <span class="hljs-number">18.00</span>g <span class="hljs-number">18.00</span>g<br></code></pre></td></tr></table></figure>

<p>（4）创建VG</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@node1 test]# vgcreate -s <span class="hljs-number">16</span>M testvg /dev/sdb /dev/sdc<br>  Volume <span class="hljs-keyword">group</span> &quot;testvg&quot; successfully created<br>  <br>[root@node1 test]# vgs<br>  VG     #PV #LV #SN Attr   VSize   VFree  <br>  centos   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">0</span> wz<span class="hljs-comment">--n- &lt;19.00g      0 </span><br>  testvg   <span class="hljs-number">2</span>   <span class="hljs-number">0</span>   <span class="hljs-number">0</span> wz<span class="hljs-comment">--n- &lt;19.97g &lt;19.97g</span><br>  <br>[root@node1 test]# vgdisplay<br>  <span class="hljs-comment">--- Volume group ---</span><br>  VG <span class="hljs-type">Name</span>               centos<br>  <span class="hljs-keyword">System</span> ID             <br>  <span class="hljs-keyword">Format</span>                lvm2<br>  Metadata Areas        <span class="hljs-number">1</span><br>  Metadata <span class="hljs-keyword">Sequence</span> <span class="hljs-keyword">No</span>  <span class="hljs-number">3</span><br>  VG <span class="hljs-keyword">Access</span>             <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  VG Status             resizable<br>  MAX LV                <span class="hljs-number">0</span><br>  Cur LV                <span class="hljs-number">2</span><br>  <span class="hljs-keyword">Open</span> LV               <span class="hljs-number">2</span><br>  Max PV                <span class="hljs-number">0</span><br>  Cur PV                <span class="hljs-number">1</span><br>  Act PV                <span class="hljs-number">1</span><br>  VG Size               &lt;<span class="hljs-number">19.00</span> GiB<br>  PE Size               <span class="hljs-number">4.00</span> MiB<br>  Total PE              <span class="hljs-number">4863</span><br>  Alloc PE / Size       <span class="hljs-number">4863</span> / &lt;<span class="hljs-number">19.00</span> GiB<br>  Free  PE / Size       <span class="hljs-number">0</span> / <span class="hljs-number">0</span>   <br>  VG <span class="hljs-type">UUID</span>               <span class="hljs-number">9</span>KnTtD<span class="hljs-number">-88</span>ve-B3cy-Ftc7-TplO-oVwc<span class="hljs-number">-5</span>SfeZh<br>   <br>  <span class="hljs-comment">--- Volume group ---</span><br>  VG <span class="hljs-type">Name</span>               testvg<br>  <span class="hljs-keyword">System</span> ID             <br>  <span class="hljs-keyword">Format</span>                lvm2<br>  Metadata Areas        <span class="hljs-number">2</span><br>  Metadata <span class="hljs-keyword">Sequence</span> <span class="hljs-keyword">No</span>  <span class="hljs-number">1</span><br>  VG <span class="hljs-keyword">Access</span>             <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  VG Status             resizable<br>  MAX LV                <span class="hljs-number">0</span><br>  Cur LV                <span class="hljs-number">0</span><br>  <span class="hljs-keyword">Open</span> LV               <span class="hljs-number">0</span><br>  Max PV                <span class="hljs-number">0</span><br>  Cur PV                <span class="hljs-number">2</span><br>  Act PV                <span class="hljs-number">2</span><br>  VG Size               &lt;<span class="hljs-number">19.97</span> GiB<br>  PE Size               <span class="hljs-number">16.00</span> MiB<br>  Total PE              <span class="hljs-number">1278</span><br>  Alloc PE / Size       <span class="hljs-number">0</span> / <span class="hljs-number">0</span>   <br>  Free  PE / Size       <span class="hljs-number">1278</span> / &lt;<span class="hljs-number">19.97</span> GiB<br>  VG <span class="hljs-type">UUID</span>               Jp1YqS-l0O0-vboZ-eLyu<span class="hljs-number">-4</span>w4M-pAGj-USbKEU<br></code></pre></td></tr></table></figure>

<p>（5）创建LV</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@node1 test]# lvcreate -L <span class="hljs-number">5</span>G -n testlv testvg<br>  Logical volume &quot;testlv&quot; created.<br>  <br>[root@node1 test]# lvs<br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  <span class="hljs-keyword">Move</span> <span class="hljs-keyword">Log</span> Cpy%Sync Convert<br>  root   centos -wi-ao<span class="hljs-comment">---- &lt;17.00g                                                    </span><br>  swap   centos -wi-ao<span class="hljs-comment">----   2.00g                                                    </span><br>  testlv testvg -wi-a<span class="hljs-comment">-----   5.00g     </span><br>  <br>[root@node1 test]# lvdisplay<br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/centos/swap<br>  LV <span class="hljs-type">Name</span>                swap<br>  VG <span class="hljs-type">Name</span>                centos<br>  LV <span class="hljs-type">UUID</span>                <span class="hljs-number">4</span>mNwDD-vOdz-y4WI<span class="hljs-number">-9</span>FlR-FufL-bt5c-Kh6gOq<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  LV Creation host, <span class="hljs-type">time</span> localhost, <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-08</span> <span class="hljs-number">15</span>:<span class="hljs-number">12</span>:<span class="hljs-number">57</span> <span class="hljs-number">-0400</span><br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">2</span><br>  LV Size                <span class="hljs-number">2.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">512</span><br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">1</span><br>   <br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/centos/root<br>  LV <span class="hljs-type">Name</span>                root<br>  VG <span class="hljs-type">Name</span>                centos<br>  LV <span class="hljs-type">UUID</span>                <span class="hljs-number">8</span>O7iWh-vgrE-dDPW<span class="hljs-number">-3</span>f6S-ofbX-pZPK-Eed0tV<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  LV Creation host, <span class="hljs-type">time</span> localhost, <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-08</span> <span class="hljs-number">15</span>:<span class="hljs-number">12</span>:<span class="hljs-number">57</span> <span class="hljs-number">-0400</span><br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">1</span><br>  LV Size                &lt;<span class="hljs-number">17.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">4351</span><br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">0</span><br>   <br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/testvg/testlv<br>  LV <span class="hljs-type">Name</span>                testlv<br>  VG <span class="hljs-type">Name</span>                testvg<br>  LV <span class="hljs-type">UUID</span>                xXdpZU-KAj3<span class="hljs-number">-1</span>MGn-HVeO-lVWh<span class="hljs-number">-3</span>wTQ<span class="hljs-number">-10</span>x2b1<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  LV Creation host, <span class="hljs-type">time</span> node1, <span class="hljs-number">2022</span><span class="hljs-number">-06</span><span class="hljs-number">-20</span> <span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">33</span> <span class="hljs-number">-0400</span><br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">0</span><br>  LV Size                <span class="hljs-number">5.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">320</span><br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>

<p>（6）格式化并挂载文件系统</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 test]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm  /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm  [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>disk <br>sdc               8:32  <span class="hljs-number"> 0 </span>  18G <span class="hljs-number"> 0 </span>disk <br>└─testvg-testlv 253:2   <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>lvm  <br>sr0              11:0   <span class="hljs-number"> 1 </span> 4.4G <span class="hljs-number"> 0 </span>rom  <br>[root@node1 test]<span class="hljs-comment"># df -h</span><br>Filesystem               Size  Used Avail Use% Mounted on<br>devtmpfs                 475M    <span class="hljs-number"> 0 </span> 475M   0% /dev<br>tmpfs                    487M    <span class="hljs-number"> 0 </span> 487M   0% /dev/shm<br>tmpfs                    487M  7.8M  479M   2% /run<br>tmpfs                    487M    <span class="hljs-number"> 0 </span> 487M   0% /sys/fs/cgroup<br>/dev/mapper/centos-root   17G  1.3G   16G   8% /<br>/dev/sda1               1014M  138M  877M  14% /boot<br>tmpfs                     98M    <span class="hljs-number"> 0 </span>  98M   0% /run/user/0<br><br>[root@node1 test]<span class="hljs-comment"># ll /dev/testvg/testlv</span><br>lrwxrwxrwx<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 7 </span>Jun<span class="hljs-number"> 20 </span>10:30 /dev/testvg/testlv -&gt; ../dm-2<br><br>[root@node1 test]<span class="hljs-comment"># mkfs.ext4 /dev/testvg/testlv </span><br>mke2fs 1.42.9 (28-Dec-2013)<br>Filesystem label=<br>OS type: Linux<br>Block size=4096 (log=2)<br>Fragment size=4096 (log=2)<br>Stride=0 blocks, Stripe width=0 blocks<br>327680 inodes,<span class="hljs-number"> 1310720 </span>blocks<br>65536 blocks (5.00%) reserved for the super user<br>First data block=0<br>Maximum filesystem blocks=1342177280<br>40 block groups<br>32768 blocks per group,<span class="hljs-number"> 32768 </span>fragments per group<br>8192 inodes per group<br>Superblock backups stored on blocks: <br>	32768, 98304, 163840, 229376, 294912, 819200, 884736<br><br>Allocating group tables: done                            <br>Writing inode tables: done                            <br>Creating journal (32768 blocks): done<br>Writing superblocks and filesystem accounting information: done <br><br>[root@node1 test]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm  /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm  [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>disk <br>sdc               8:32  <span class="hljs-number"> 0 </span>  18G <span class="hljs-number"> 0 </span>disk <br>└─testvg-testlv 253:2   <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>lvm  <br>sr0              11:0   <span class="hljs-number"> 1 </span> 4.4G <span class="hljs-number"> 0 </span>rom <br><br>[root@node1 test]<span class="hljs-comment"># mkdir /users</span><br>[root@node1 test]<span class="hljs-comment"># mount /dev/testvg/testlv /users/</span><br>[root@node1 test]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   475M    <span class="hljs-number"> 0 </span> 475M   0% /dev<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /dev/shm<br>tmpfs                      487M  7.8M  479M   2% /run<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /sys/fs/cgroup<br>/dev/mapper/centos-root     17G  1.3G   16G   8% /<br>/dev/sda1                 1014M  138M  877M  14% /boot<br>tmpfs                       98M    <span class="hljs-number"> 0 </span>  98M   0% /run/user/0<br>/dev/mapper/testvg-testlv  4.8G   20M  4.6G   1% /users<br></code></pre></td></tr></table></figure>





<h2 id="3、新建用户archlinux-要求其家目录为-users-archlinux，而后su切换至archlinux用户，复制-etc-pam-d-目录至自己的家目录。"><a href="#3、新建用户archlinux-要求其家目录为-users-archlinux，而后su切换至archlinux用户，复制-etc-pam-d-目录至自己的家目录。" class="headerlink" title="3、新建用户archlinux,要求其家目录为/users/archlinux，而后su切换至archlinux用户，复制/etc/pam.d/目录至自己的家目录。"></a>3、新建用户archlinux,要求其家目录为/users/archlinux，而后su切换至archlinux用户，复制/etc/pam.d/目录至自己的家目录。</h2><p>（1）新建用户</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ruby">[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># useradd -d /users/archlinux archlinux</span><br>[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># id archlinux</span><br>uid=<span class="hljs-number">1000</span>(archlinux) gid=<span class="hljs-number">1000</span>(archlinux) groups=<span class="hljs-number">1000</span>(archlinux)<br>[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># grep archlinux /etc/passwd</span><br><span class="hljs-symbol">archlinux:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/users/archlinux</span><span class="hljs-symbol">:/bin/bash</span><br>[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># ls /users/archlinux/</span><br>[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># ll -d /users/archlinux/</span><br>drwx------ <span class="hljs-number">2</span> archlinux archlinux <span class="hljs-number">4096</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span><span class="hljs-symbol">:</span><span class="hljs-number">41</span> /users/archlinux/<br></code></pre></td></tr></table></figure>

<p>（2）复制/etc/pam.d/目录至自己的家目录。</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs tap">[archlinux@node1 ~]$ echo $HOME<br>/users/archlinux<br>[archlinux@node1 ~]$ cp -rp /etc/pam.d/ $HOME<br>[archlinux@node1 ~]$ ll $HOME<br>total 4<br>drwxr-xr-x<span class="hljs-number"> 2 </span>archlinux archlinux<span class="hljs-number"> 4096 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>pam.d<br>[archlinux@node1 ~]$ ll $HOME/pam.d <br>total 100<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 192 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>chfn<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 192 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>chsh<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 232 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>config-util<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 287 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2019 </span>crond<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 19 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>fingerprint-auth -&gt; fingerprint-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 702 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>fingerprint-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 796 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>login<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 154 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>other<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 188 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>passwd<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 16 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>password-auth -&gt; password-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux<span class="hljs-number"> 1033 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>password-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 155 </span>Apr <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>polkit-1<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 12 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>postlogin -&gt; postlogin-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 330 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>postlogin-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 681 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>remote<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 143 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>runuser<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 138 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>runuser-l<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 17 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smartcard-auth -&gt; smartcard-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 752 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smartcard-auth-ac<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 25 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smtp -&gt; /etc/alternatives/mta-pam<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 76 </span>Apr <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>smtp.postfix<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 904 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2019 </span>sshd<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 540 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>su<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 200 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>sudo<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 178 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>sudo-i<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 137 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>su-l<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 14 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>system-auth -&gt; system-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux<span class="hljs-number"> 1031 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>system-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 129 </span>Oct <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>systemd-user<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 84 </span>Oct<span class="hljs-number"> 30 </span><span class="hljs-number"> 2018 </span>vlock<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 278 </span>Oct <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>vmtoolsd<br></code></pre></td></tr></table></figure>

<h2 id="4、扩展testlv至7G，要求archlinux用户的文件不能丢失"><a href="#4、扩展testlv至7G，要求archlinux用户的文件不能丢失" class="headerlink" title="4、扩展testlv至7G，要求archlinux用户的文件不能丢失"></a>4、扩展testlv至7G，要求archlinux用户的文件不能丢失</h2><p>（1）在线扩展逻辑卷至7G</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 ~]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;17.00g                                                    <br>  swap   centos -wi-ao----   2.00g                                                    <br>  testlv testvg -wi-ao----   5.00g  <br><br>[root@node1 ~]<span class="hljs-comment"># lvextend -L 7G /dev/testvg/testlv </span><br>  Size of logical volume testvg/testlv changed from 5.00 GiB (320 extents) to 7.00 GiB (448 extents).<br>  Logical volume testvg/testlv successfully resized.<br>[root@node1 ~]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm  /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm  [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>disk <br>sdc               8:32  <span class="hljs-number"> 0 </span>  18G <span class="hljs-number"> 0 </span>disk <br>└─testvg-testlv 253:2   <span class="hljs-number"> 0 </span>   7G <span class="hljs-number"> 0 </span>lvm  /users<br>sr0              11:0   <span class="hljs-number"> 1 </span> 4.4G <span class="hljs-number"> 0 </span>rom  <br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   475M    <span class="hljs-number"> 0 </span> 475M   0% /dev<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /dev/shm<br>tmpfs                      487M  7.8M  479M   2% /run<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /sys/fs/cgroup<br>/dev/mapper/centos-root     17G  1.3G   16G   8% /<br>/dev/sda1                 1014M  138M  877M  14% /boot<br>tmpfs                       98M    <span class="hljs-number"> 0 </span>  98M   0% /run/user/0<br>/dev/mapper/testvg-testlv  4.8G   21M  4.6G   1% /users<br><br>[root@node1 ~]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;17.00g                                                    <br>  swap   centos -wi-ao----   2.00g                                                    <br>  testlv testvg -wi-ao----   7.00g  <br></code></pre></td></tr></table></figure>

<p>（2）扩展文件系统</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 ~]<span class="hljs-comment"># resize2fs /dev/testvg/testlv </span><br>resize2fs 1.42.9 (28-Dec-2013)<br>Filesystem at /dev/testvg/testlv is mounted on /users; on-line resizing required<br>old_desc_blocks = 1, new_desc_blocks = 1<br>The filesystem on /dev/testvg/testlv is now<span class="hljs-number"> 1835008 </span>blocks long.<br><br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   475M    <span class="hljs-number"> 0 </span> 475M   0% /dev<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /dev/shm<br>tmpfs                      487M  7.8M  479M   2% /run<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /sys/fs/cgroup<br>/dev/mapper/centos-root     17G  1.3G   16G   8% /<br>/dev/sda1                 1014M  138M  877M  14% /boot<br>tmpfs                       98M    <span class="hljs-number"> 0 </span>  98M   0% /run/user/0<br>/dev/mapper/testvg-testlv  6.8G   23M  6.4G   1% /users<br><br>[root@node1 ~]<span class="hljs-comment"># ll /users/archlinux/pam.d/</span><br>total 100<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 192 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>chfn<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 192 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>chsh<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 232 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>config-util<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 287 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2019 </span>crond<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 19 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>fingerprint-auth -&gt; fingerprint-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 702 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>fingerprint-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 796 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>login<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 154 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>other<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 188 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>passwd<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 16 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>password-auth -&gt; password-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux<span class="hljs-number"> 1033 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>password-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 155 </span>Apr <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>polkit-1<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 12 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>postlogin -&gt; postlogin-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 330 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>postlogin-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 681 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>remote<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 143 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>runuser<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 138 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>runuser-l<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 17 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smartcard-auth -&gt; smartcard-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 752 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smartcard-auth-ac<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 25 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smtp -&gt; /etc/alternatives/mta-pam<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 76 </span>Apr <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>smtp.postfix<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 904 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2019 </span>sshd<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 540 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>su<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 200 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>sudo<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 178 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>sudo-i<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 137 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>su-l<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 14 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>system-auth -&gt; system-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux<span class="hljs-number"> 1031 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>system-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 129 </span>Oct <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>systemd-user<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 84 </span>Oct<span class="hljs-number"> 30 </span><span class="hljs-number"> 2018 </span>vlock<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 278 </span>Oct <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>vmtoolsd<br></code></pre></td></tr></table></figure>

<h2 id="5、收缩testlv至3G，要求archlinux用户的文件不能丢失"><a href="#5、收缩testlv至3G，要求archlinux用户的文件不能丢失" class="headerlink" title="5、收缩testlv至3G，要求archlinux用户的文件不能丢失"></a>5、收缩testlv至3G，要求archlinux用户的文件不能丢失</h2><p>注意：缩减有数据损坏的风险，建议先备份再缩减，xfs文件系统不支持缩减 </p>
<p>（1）备份数据</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">[root@node1 ~]<span class="hljs-comment"># tar -cf /tmp/user.tar /users/</span><br>tar: Removing leading `/&#x27; from member names<br><br>[root@node1 ~]<span class="hljs-comment"># ll /tmp/user.tar </span><br>-rw-r<span class="hljs-params">--r--</span> 1 root root 40960 Jun 20 11<span class="hljs-function">:14</span> <span class="hljs-string">/tmp/user.tar</span><br><br>[root@node1 ~]<span class="hljs-comment"># tar -tf /tmp/user.tar </span><br>users/<br>users/lost+found/<br>users/archlinux/<br>users/archlinux/<span class="hljs-string">.bashrc</span><br>users/archlinux/pam.d/<br>users/archlinux/pam.d/login<br>users/archlinux/pam.d/config-util<br>users/archlinux/pam.d/crond<br>users/archlinux/pam.d/sudo-i<br>users/archlinux/pam.d/chsh<br>users/archlinux/pam.d/postlogin-ac<br>users/archlinux/pam.d/system-auth<br>users/archlinux/pam.d/su-l<br>users/archlinux/pam.d/vmtoolsd<br>users/archlinux/pam.d/runuser-l<br>users/archlinux/pam.d/other<br>users/archlinux/pam.d/password-auth-ac<br>users/archlinux/pam.d/postlogin<br>users/archlinux/pam.d/smartcard-auth-ac<br>users/archlinux/pam.d/su<br>users/archlinux/pam.d/fingerprint-auth-ac<br>users/archlinux/pam.d/fingerprint-auth<br>users/archlinux/pam.d/smtp<br>users/archlinux/pam.d/remote<br>users/archlinux/pam.d/systemd-user<br>users/archlinux/pam.d/passwd<br>users/archlinux/pam.d/sudo<br>users/archlinux/pam.d/runuser<br>users/archlinux/pam.d/smtp.postfix<br>users/archlinux/pam.d/sshd<br>users/archlinux/pam.d/smartcard-auth<br>users/archlinux/pam.d/vlock<br>users/archlinux/pam.d/polkit-1<br>users/archlinux/pam.d/system-auth-ac<br>users/archlinux/pam.d/chfn<br>users/archlinux/pam.d/password-auth<br>users/archlinux/<span class="hljs-string">.bash_logout</span><br>users/archlinux/<span class="hljs-string">.bash_profile</span><br></code></pre></td></tr></table></figure>

<p>（2）卸载要缩容的逻辑卷上的文件系统</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                      <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root     17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                 <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                       <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv  6.8G   23M  6.4G   1% /u</span>sers<br><br>[root@node1 ~]<span class="hljs-comment"># umount /users</span><br>umount: /users: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(<span class="hljs-number">8</span>) or fuser(<span class="hljs-number">1</span>))<br>         <br>         [root@node1 ~]<span class="hljs-comment"># umount /dev/testvg/testlv              卸载失败了怎么办？重启系统后，自动卸载掉了</span><br>umount: /users: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(<span class="hljs-number">8</span>) or fuser(<span class="hljs-number">1</span>))<br>         <br></code></pre></td></tr></table></figure>

<p>（3）</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@node1 ~]# umount <span class="hljs-regexp">/users/</span><br>[root@node1 ~]# df -h<br>Filesystem               <span class="hljs-keyword">Size</span>  Used Avail Use% Mounted on<br>devtmpfs                 <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                    <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root   17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1               <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                     <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br>[root@node1 ~]# resize2fs <span class="hljs-regexp">/dev/</span>testvg/testlv <span class="hljs-number">3</span>G<br>resize2fs <span class="hljs-number">1.42</span>.<span class="hljs-number">9</span> (<span class="hljs-number">28</span>-Dec-<span class="hljs-number">2013</span>)<br>Please run <span class="hljs-string">&#x27;e2fsck -f /dev/testvg/testlv&#x27;</span> first.<br></code></pre></td></tr></table></figure>

<p>（4）</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 ~]<span class="hljs-comment"># fsck -f /dev/testvg/testlv </span><br>fsck from util-linux <span class="hljs-number">2.23</span>.<span class="hljs-number">2</span><br>e2fsck <span class="hljs-number">1.42</span>.<span class="hljs-number">9</span> (<span class="hljs-number">28</span>-Dec-<span class="hljs-number">2013</span>)<br>Pass <span class="hljs-number">1</span>: Checking inodes, blocks, and sizes<br>Pass <span class="hljs-number">2</span>: Checking directory structure<br>Pass <span class="hljs-number">3</span>: Checking directory connectivity<br>Pass <span class="hljs-number">4</span>: Checking reference counts<br>Pass <span class="hljs-number">5</span>: Checking group summary information<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv: 47/</span><span class="hljs-number">458752</span> files (<span class="hljs-number">0.0</span>% non-contiguous), <span class="hljs-number">67357</span>/<span class="hljs-number">1835008</span> blocks<br>[root@node1 ~]<span class="hljs-comment"># resize2fs /dev/testvg/testlv 3G</span><br>resize2fs <span class="hljs-number">1.42</span>.<span class="hljs-number">9</span> (<span class="hljs-number">28</span>-Dec-<span class="hljs-number">2013</span>)<br>Resizing the filesystem on <span class="hljs-regexp">/dev/</span>testvg/testlv to <span class="hljs-number">786432</span> (<span class="hljs-number">4</span>k) blocks.<br>The filesystem on <span class="hljs-regexp">/dev/</span>testvg/testlv is now <span class="hljs-number">786432</span> blocks long.<br><br>[root@node1 ~]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;<span class="hljs-number">17.00</span>g                                                    <br>  swap   centos -wi-ao----   <span class="hljs-number">2.00</span>g                                                    <br>  testlv testvg -wi-a-----   <span class="hljs-number">7.00</span>g                                                    <br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem               Size  Used Avail Use% Mounted on<br>devtmpfs                 <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                    <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root   17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1               <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                     <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br>[root@node1 ~]<span class="hljs-comment"># cat /etc/fstab </span><br><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># /etc/fstab</span><br><span class="hljs-comment"># Created by anaconda on Sun Aug  8 15:12:58 2021</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><br><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><br><span class="hljs-comment">#</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root /</span>                       xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>UUID=f7d6f590-<span class="hljs-number">611</span>d-<span class="hljs-number">44</span>bb-<span class="hljs-number">8228</span>-bcd7e1a43333 /boot                   xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper/centos-swap swap                    swap    defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>[root@node1 ~]<span class="hljs-comment"># vim /etc/fstab </span><br>-bash: vim: command not found<br>[root@node1 ~]<span class="hljs-comment"># vi /etc/fstab </span><br>[root@node1 ~]<span class="hljs-comment"># cat /etc/fstab </span><br><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># /etc/fstab</span><br><span class="hljs-comment"># Created by anaconda on Sun Aug  8 15:12:58 2021</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><br><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><br><span class="hljs-comment">#</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root /</span>                       xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>UUID=f7d6f590-<span class="hljs-number">611</span>d-<span class="hljs-number">44</span>bb-<span class="hljs-number">8228</span>-bcd7e1a43333 /boot                   xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper/centos-swap swap                    swap    defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/</span>testvg<span class="hljs-regexp">/testlv /u</span>sers/			ext4	defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>[root@node1 ~]<span class="hljs-comment"># mount -a</span><br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                      <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root     17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                 <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                       <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv  2.9G   16M  2.7G   1% /u</span>sers<br></code></pre></td></tr></table></figure>

<p>（5）</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs crystal">[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># umount /users/</span><br>[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># lvreduce -L 3G /dev/testvg/testlv </span><br>  <span class="hljs-symbol">WARNING:</span> Reducing active logical volume to <span class="hljs-number">3.00</span> GiB.<br>  THIS MAY DESTROY YOUR DATA (filesystem etc.)<br>Do you really want to reduce testvg/testlv? [y/n]: y<br>  Size <span class="hljs-keyword">of</span> logical volume testvg/testlv changed from <span class="hljs-number">7.00</span> GiB (<span class="hljs-number">448</span> extents) to <span class="hljs-number">3.00</span> GiB (<span class="hljs-number">192</span> extents).<br>  Logical volume testvg/testlv successfully resized.<br>[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;<span class="hljs-number">17.00</span>g                                                    <br>  swap   centos -wi-ao----   <span class="hljs-number">2.00</span>g                                                    <br>  testlv testvg -wi-a-----   <span class="hljs-number">3.00</span>g                                                    <br>[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># mount -a</span><br>[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev</span><br><span class="hljs-regexp">tmpfs                      487M     0  487M   0% /dev</span><span class="hljs-regexp">/shm</span><br><span class="hljs-regexp">tmpfs                      487M  7.8M  479M   2% /run</span><br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/fs</span><span class="hljs-regexp">/cgroup</span><br><span class="hljs-regexp">/dev</span><span class="hljs-regexp">/mapper/centos</span>-root     <span class="hljs-number">17</span>G  <span class="hljs-number">1.3</span>G   <span class="hljs-number">16</span>G   <span class="hljs-number">8</span>% <span class="hljs-regexp">/</span><br><span class="hljs-regexp">/dev</span><span class="hljs-regexp">/sda1                 1014M  138M  877M  14% /boot</span><br>tmpfs                       <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/user</span><span class="hljs-regexp">/0</span><br><span class="hljs-regexp">/dev</span><span class="hljs-regexp">/mapper/testvg</span>-testlv  <span class="hljs-number">2.9</span>G   <span class="hljs-number">16</span>M  <span class="hljs-number">2.7</span>G   <span class="hljs-number">1</span>% <span class="hljs-regexp">/users</span><br></code></pre></td></tr></table></figure>



<h2 id="6、对testlv创建快照，并尝试基于快照备份数据，验正快照的功能"><a href="#6、对testlv创建快照，并尝试基于快照备份数据，验正快照的功能" class="headerlink" title="6、对testlv创建快照，并尝试基于快照备份数据，验正快照的功能"></a>6、对testlv创建快照，并尝试基于快照备份数据，验正快照的功能</h2><p>（1）为现有逻辑卷/dev/testvg/testlv 创建快照<br>ext4必须使用-p r 实现只读 （否则快照是可以被别人篡改的，那样的话备份就没有意义了）</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@node1 ~]# lvcreate -l <span class="hljs-number">64</span> -s -n <span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span> -p r /dev/testvg/testlv <br>  Logical volume &quot;user-snapshot&quot; created.<br>[root@node1 ~]# lvs<br>  LV            VG     Attr       LSize   Pool Origin Data%  Meta%  <span class="hljs-keyword">Move</span> <span class="hljs-keyword">Log</span> Cpy%Sync Convert<br>  root          centos -wi-ao<span class="hljs-comment">---- &lt;17.00g                                                    </span><br>  swap          centos -wi-ao<span class="hljs-comment">----   2.00g                                                    </span><br>  testlv        testvg owi-aos<span class="hljs-comment">---   3.00g                                                    </span><br>  <span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span> testvg sri-a-s<span class="hljs-comment">---   1.00g      testlv 0.01    //创建快照后会多一个逻辑卷</span><br>  <br>[root@node1 ~]# blkid<br>/dev/mapper/testvg-testlv: <span class="hljs-type">UUID</span>=&quot;1db19aff-18f0-42d5-88d2-0f4ea074d33f&quot; <span class="hljs-keyword">TYPE</span>=&quot;ext4&quot; <br>/dev/sda1: <span class="hljs-type">UUID</span>=&quot;f7d6f590-611d-44bb-8228-bcd7e1a43333&quot; <span class="hljs-keyword">TYPE</span>=&quot;xfs&quot; <br>/dev/sda2: <span class="hljs-type">UUID</span>=&quot;Pcy8Mo-duHv-KVJI-NGLy-CCln-pDEl-zUOaPV&quot; <span class="hljs-keyword">TYPE</span>=&quot;LVM2_member&quot; <br>/dev/sdb: <span class="hljs-type">UUID</span>=&quot;sCiC1O-wM9v-ecWQ-Knx3-JCEx-jX4E-rLTmQ1&quot; <span class="hljs-keyword">TYPE</span>=&quot;LVM2_member&quot; <br>/dev/sr0: <span class="hljs-type">UUID</span>=&quot;2020-11-04-11-36-43-00&quot; LABEL=&quot;CentOS 7 x86_64&quot; <span class="hljs-keyword">TYPE</span>=&quot;iso9660&quot; PTTYPE=&quot;dos&quot; <br>/dev/sdc: <span class="hljs-type">UUID</span>=&quot;dsIn9M-LD1O-jD8R-6S9b-i7ts-sJmG-GOz45s&quot; <span class="hljs-keyword">TYPE</span>=&quot;LVM2_member&quot; <br>/dev/mapper/centos-root: <span class="hljs-type">UUID</span>=&quot;21bd96c2-bd2c-4649-b5b0-fbb11870671c&quot; <span class="hljs-keyword">TYPE</span>=&quot;xfs&quot; <br>/dev/mapper/centos-swap: <span class="hljs-type">UUID</span>=&quot;f0fb2d3e-4915-4353-8ef4-decf20ea52a3&quot; <span class="hljs-keyword">TYPE</span>=&quot;swap&quot; <br>/dev/mapper/testvg-<span class="hljs-keyword">user</span><span class="hljs-comment">--snapshot: UUID=&quot;1db19aff-18f0-42d5-88d2-0f4ea074d33f&quot; TYPE=&quot;ext4&quot;   //uuid是一样的</span><br>  <br></code></pre></td></tr></table></figure>

<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@node1 ~]# lvdisplay<br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/testvg/testlv<br>  LV <span class="hljs-type">Name</span>                testlv<br>  VG <span class="hljs-type">Name</span>                testvg<br>  LV <span class="hljs-type">UUID</span>                xXdpZU-KAj3<span class="hljs-number">-1</span>MGn-HVeO-lVWh<span class="hljs-number">-3</span>wTQ<span class="hljs-number">-10</span>x2b1<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  LV Creation host, <span class="hljs-type">time</span> node1, <span class="hljs-number">2022</span><span class="hljs-number">-06</span><span class="hljs-number">-20</span> <span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">33</span> <span class="hljs-number">-0400</span><br>  LV <span class="hljs-keyword">snapshot</span> status     source <span class="hljs-keyword">of</span><br>                         <span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span> [active]<br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">1</span><br>  LV Size                <span class="hljs-number">3.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">192</span><br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">2</span><br>   <br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/testvg/<span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span><br>  LV <span class="hljs-type">Name</span>                <span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span><br>  VG <span class="hljs-type">Name</span>                testvg<br>  LV <span class="hljs-type">UUID</span>                DZzugm-ieN6-yNca-eigO-NSFF-uu6O-L09uqf<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span> <span class="hljs-keyword">only</span><br>  LV Creation host, <span class="hljs-type">time</span> node1, <span class="hljs-number">2022</span><span class="hljs-number">-06</span><span class="hljs-number">-21</span> <span class="hljs-number">10</span>:<span class="hljs-number">39</span>:<span class="hljs-number">26</span> <span class="hljs-number">-0400</span><br>  LV <span class="hljs-keyword">snapshot</span> status     active destination <span class="hljs-keyword">for</span> testlv<br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">0</span><br>  LV Size                <span class="hljs-number">3.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">192</span><br>  COW-<span class="hljs-keyword">table</span> size         <span class="hljs-number">1.00</span> GiB<br>  COW-<span class="hljs-keyword">table</span> LE           <span class="hljs-number">64</span><br>  Allocated <span class="hljs-keyword">to</span> <span class="hljs-keyword">snapshot</span>  <span class="hljs-number">0.01</span>%<br>  <span class="hljs-keyword">Snapshot</span> chunk size    <span class="hljs-number">4.00</span> KiB<br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">5</span><br>  <br>[root@node1 snap]# ll<br>total <span class="hljs-number">20</span><br>drwx<span class="hljs-comment">------ 3 archlinux archlinux  4096 Jun 20 10:45 archlinux</span><br>drwx<span class="hljs-comment">------ 2 root      root      16384 Jun 20 10:35 lost+found</span><br><br>快照不能被修改，说明达到了备份的效果<br>[root@node1 snap]# touch <span class="hljs-number">1.</span>txt<br>touch: cannot touch ‘<span class="hljs-number">1.</span>txt’: <span class="hljs-keyword">Read</span>-<span class="hljs-keyword">only</span> file <span class="hljs-keyword">system</span><br></code></pre></td></tr></table></figure>

<p>（2）挂载快照</p>
<p>xfs注意要使用-o ro实现只读,访止快照被修改</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 ~]<span class="hljs-comment"># mkdir /mnt/snap</span><br>[root@node1 ~]<span class="hljs-comment"># mount /dev/testvg/user-snapshot /mnt/snap/</span><br>mount: <span class="hljs-regexp">/dev/m</span>apper/testvg-user--snapshot is write-protected, mounting read-only<br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                         Size  Used Avail Use% Mounted on<br>devtmpfs                           <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                              <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root             17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                         <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                               <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv          2.9G   16M  2.7G   1% /u</span>sers<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-user--snapshot  2.9G   16M  2.7G   1% /m</span>nt/snap<br>[root@node1 ~]<span class="hljs-comment"># ll /mnt/snap/       //这里看到的文件都是虚的</span><br>total <span class="hljs-number">20</span><br>drwx------ <span class="hljs-number">3</span> archlinux archlinux  <span class="hljs-number">4096</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span>:<span class="hljs-number">45</span> archlinux<br>drwx------ <span class="hljs-number">2</span> root      root      <span class="hljs-number">16384</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span>:<span class="hljs-number">35</span> lost+found<br><br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                         Size  Used Avail Use% Mounted on<br>devtmpfs                           <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                              <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root             17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                         <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                               <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv          2.9G   16M  2.7G   1% /u</span>sers<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-user--snapshot  2.9G   16M  2.7G   1% /m</span>nt/snap   快照显示的文件大小跟<br></code></pre></td></tr></table></figure>

<p>（3）验证快照的功能</p>
<p>对原来的逻辑卷进行修改</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 ~]<span class="hljs-comment"># cd /users/archlinux/</span><br>[root@node1 archlinux]<span class="hljs-comment"># ll</span><br>total 4<br>drwxr-xr-x<span class="hljs-number"> 2 </span>archlinux archlinux<span class="hljs-number"> 4096 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>pam.d<br>[root@node1 archlinux]<span class="hljs-comment"># mv pam.d/ pum.d</span><br>[root@node1 archlinux]<span class="hljs-comment"># touch file1.txt</span><br>[root@node1 archlinux]<span class="hljs-comment"># ll                           1、新建了一个文件file1.txt 2、给目录pam.d重命名为pum.d</span><br>total 4<br>-rw-r--r--<span class="hljs-number"> 1 </span>root      root        <span class="hljs-number"> 0 </span>Jun<span class="hljs-number"> 21 </span>22:36 file1.txt<br>drwxr-xr-x<span class="hljs-number"> 2 </span>archlinux archlinux<span class="hljs-number"> 4096 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>pum.d<br>[root@node1 archlinux]<span class="hljs-comment"># pwd</span><br>/users/archlinux<br><br>[root@node1 archlinux]<span class="hljs-comment"># cd /mnt/snap/               //快照里还是原来的东西，说明备份效果体现出来了</span><br>[root@node1 snap]<span class="hljs-comment"># ll archlinux/</span><br>total 4<br>drwxr-xr-x<span class="hljs-number"> 2 </span>archlinux archlinux<span class="hljs-number"> 4096 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>pam.d<br></code></pre></td></tr></table></figure>

<p>利用快照还原原来的逻辑卷</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 snap]<span class="hljs-comment"># df -h</span><br>Filesystem                         Size  Used Avail Use% Mounted on<br>devtmpfs                           <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                              <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root             17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                         <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                               <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv          2.9G   16M  2.7G   1% /u</span>sers<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-user--snapshot  2.9G   16M  2.7G   1% /m</span>nt/snap<br>[root@node1 snap]<span class="hljs-comment"># umount /users/</span><br>umount: /users: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(<span class="hljs-number">8</span>) or fuser(<span class="hljs-number">1</span>))<br>[root@node1 snap]<span class="hljs-comment"># umount /users/</span><br>[root@node1 snap]<span class="hljs-comment"># umount /mnt/snap/                  // 卸载时，应退出访问文件系统的进程</span><br>umount: <span class="hljs-regexp">/mnt/</span>snap: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(<span class="hljs-number">8</span>) or fuser(<span class="hljs-number">1</span>))<br>[root@node1 snap]<span class="hljs-comment"># cd /                         </span><br>[root@node1 <span class="hljs-regexp">/]# umount /m</span>nt<span class="hljs-regexp">/snap/</span><br>[root@node1 /]<span class="hljs-comment"># df -h</span><br>Filesystem               Size  Used Avail Use% Mounted on<br>devtmpfs                 <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                    <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root   17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1               <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                     <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 <span class="hljs-regexp">/]# lvconvert --merge /</span>dev<span class="hljs-regexp">/testvg/u</span>ser-snapshot <br>  Merging of volume testvg/user-snapshot started.<br>  testvg/testlv: Merged: <span class="hljs-number">100.00</span>%<br> <br> 在使用快照还原后，快照的逻辑卷就消失了，是一次性的。<br>[root@node1 /]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;<span class="hljs-number">17.00</span>g                                                    <br>  swap   centos -wi-ao----   <span class="hljs-number">2.00</span>g                                                    <br>  testlv testvg -wi-a-----   <span class="hljs-number">3.00</span>g       <br>  <br>[root@node1 <span class="hljs-regexp">/]# mount /</span>dev<span class="hljs-regexp">/testvg/</span>testlv <span class="hljs-regexp">/users/</span><br>[root@node1 <span class="hljs-regexp">/]# ll /u</span>sers/<br>total <span class="hljs-number">20</span><br>drwx------ <span class="hljs-number">3</span> archlinux archlinux  <span class="hljs-number">4096</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span>:<span class="hljs-number">45</span> archlinux<br>drwx------ <span class="hljs-number">2</span> root      root      <span class="hljs-number">16384</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span>:<span class="hljs-number">35</span> lost+found<br>[root@node1 <span class="hljs-regexp">/]# ll /u</span>sers<span class="hljs-regexp">/archlinux/</span>                   <span class="hljs-regexp">//</span> 已还原到原来的样子<br>total <span class="hljs-number">4</span><br>drwxr-xr-x <span class="hljs-number">2</span> archlinux archlinux <span class="hljs-number">4096</span> Aug  <span class="hljs-number">8</span>  <span class="hljs-number">2021</span> pam.d<br></code></pre></td></tr></table></figure>







<h2 id="7、创建10G的RAID1，要求CHUNK为128K，文件系统为ext4，有一个空闲盘，开机可自动挂载至-backup目录"><a href="#7、创建10G的RAID1，要求CHUNK为128K，文件系统为ext4，有一个空闲盘，开机可自动挂载至-backup目录" class="headerlink" title="7、创建10G的RAID1，要求CHUNK为128K，文件系统为ext4，有一个空闲盘，开机可自动挂载至/backup目录"></a>7、创建10G的RAID1，要求CHUNK为128K，文件系统为ext4，有一个空闲盘，开机可自动挂载至/backup目录</h2><p>（1）、使用VMware添加两块大小均为10G的硬盘，然后在linux使用命令扫描新添加的硬盘。</p>
<p>（2）、创建RAID1，</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">mdadm -C <span class="hljs-regexp">/dev/m</span>d0 -a yes -l <span class="hljs-number">1</span> -n <span class="hljs-number">2</span> -x <span class="hljs-number">1</span> -c <span class="hljs-number">128</span>K <span class="hljs-regexp">/dev/</span>sdb  <span class="hljs-regexp">/dev/</span>sdc<br></code></pre></td></tr></table></figure>

<p>（3）、格式化磁盘，并挂载文件系统</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@localhost ~]mkfs.ext4 <span class="hljs-regexp">/dev/m</span>d0<br>[root@localhost ~]mkdir /backup<br>[root@localhost ~]<span class="hljs-comment"># vim /etc/fstab </span><br>[root@localhost ~]<span class="hljs-comment"># cat /etc/fstab </span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># /etc/fstab</span><br><span class="hljs-comment"># Created by anaconda on Tue Jun 28 17:51:01 2022</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><br><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><br><span class="hljs-comment">#</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root /</span>                       xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>UUID=<span class="hljs-number">47</span>e57ec3-dc25-<span class="hljs-number">40</span>b5-a567-<span class="hljs-number">619</span>b8697712f /boot                   xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>d0                    /backup    defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>





<h2 id="8、创建一个可用空间为10G的RAID10设备，要求CHUNK为256K，文件系统为ext4，开机可自动挂载至-mydata目录"><a href="#8、创建一个可用空间为10G的RAID10设备，要求CHUNK为256K，文件系统为ext4，开机可自动挂载至-mydata目录" class="headerlink" title="8、创建一个可用空间为10G的RAID10设备，要求CHUNK为256K，文件系统为ext4，开机可自动挂载至/mydata目录"></a>8、创建一个可用空间为10G的RAID10设备，要求CHUNK为256K，文件系统为ext4，开机可自动挂载至/mydata目录</h2><p>（1）、使用VMware添加四块大小均为5G的硬盘，然后在linux使用命令扫描新添加的硬盘。</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@localhost ~]<span class="hljs-comment"># echo &#x27;- - -&#x27;&gt;/sys/class/scsi_host/host0/scan</span><br>[root@localhost ~]<span class="hljs-comment"># ll /dev/sd*</span><br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 0 </span>Jun<span class="hljs-number"> 28 </span>12:38 /dev/sda<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 1 </span>Jun<span class="hljs-number"> 28 </span>12:38 /dev/sda1<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 2 </span>Jun<span class="hljs-number"> 28 </span>12:38 /dev/sda2<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 16 </span>Jun<span class="hljs-number"> 28 </span>13:03 /dev/sdb<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 32 </span>Jun<span class="hljs-number"> 28 </span>13:03 /dev/sdc<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 48 </span>Jun<span class="hljs-number"> 28 </span>13:03 /dev/sdd<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 64 </span>Jun<span class="hljs-number"> 28 </span>13:03 /dev/sde<br></code></pre></td></tr></table></figure>



<p>（2）、创建raid10</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@localhost ~]<span class="hljs-comment"># mdadm -C /dev/md1 -a yes -l 10 -n4 -c 256K /dev/sd&#123;b,c,d,e&#125; </span><br>mdadm: Defaulting to version 1.2 metadata<br>mdadm: array /dev/md1 started.<br>[root@localhost ~]<span class="hljs-comment"># mdadm -D /dev/md1</span><br>/dev/md1:<br>           Version : 1.2<br>     Creation Time : Tue Jun<span class="hljs-number"> 28 </span>13:07:56 2022<br>        Raid Level : raid10<br>        Array Size :<span class="hljs-number"> 10475520 </span>(9.99 GiB 10.73 GB)<br>     Used Dev Size :<span class="hljs-number"> 5237760 </span>(5.00 GiB 5.36 GB)<br>      Raid Devices : 4<br>     Total Devices : 4<br>       Persistence : Superblock is persistent<br><br>       Update Time : Tue Jun<span class="hljs-number"> 28 </span>13:08:10 2022<br>             State : clean, resyncing <br>    Active Devices : 4<br>   Working Devices : 4<br>    Failed Devices : 0<br>     Spare Devices : 0<br><br>            Layout : near=2<br>        Chunk Size : 256K<br><br>Consistency Policy : resync<br><br>     Resync Status : 76% complete<br><br>              Name : localhost.localdomain:1  (local to host localhost.localdomain)<br>              UUID : 81d26fe9:0c024b84:134ca616:d307d1be<br>            Events : 12<br><br>    Number   Major   Minor   RaidDevice State<br>      <span class="hljs-number"> 0 </span>     <span class="hljs-number"> 8 </span>     <span class="hljs-number"> 16 </span>      <span class="hljs-number"> 0 </span>     active sync set-A   /dev/sdb<br>      <span class="hljs-number"> 1 </span>     <span class="hljs-number"> 8 </span>     <span class="hljs-number"> 32 </span>      <span class="hljs-number"> 1 </span>     active sync set-B   /dev/sdc<br>      <span class="hljs-number"> 2 </span>     <span class="hljs-number"> 8 </span>     <span class="hljs-number"> 48 </span>      <span class="hljs-number"> 2 </span>     active sync set-A   /dev/sdd<br>      <span class="hljs-number"> 3 </span>     <span class="hljs-number"> 8 </span>     <span class="hljs-number"> 64 </span>      <span class="hljs-number"> 3 </span>     active sync set-B   /dev/sde<br>       <br>[root@localhost ~]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE   MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk   <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part   /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part   <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm    /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm    [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>disk   <br>└─md1             9:1   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>raid10 <br>sdc               8:32  <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>disk   <br>└─md1             9:1   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>raid10 <br>sdd               8:48  <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>disk   <br>└─md1             9:1   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>raid10 <br>sde               8:64  <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>disk   <br>└─md1             9:1   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>raid10 <br>sr0              11:0   <span class="hljs-number"> 1 </span>1024M <span class="hljs-number"> 0 </span>rom    <br></code></pre></td></tr></table></figure>



<p>（3）、格式化磁盘，并挂载文件系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># mkfs.ext4 /dev/md1</span><br>mke2fs 1.42.9 (28-Dec-2013)<br>Filesystem label=<br>OS <span class="hljs-built_in">type</span>: Linux<br>Block size=4096 (<span class="hljs-built_in">log</span>=2)<br>Fragment size=4096 (<span class="hljs-built_in">log</span>=2)<br>Stride=64 blocks, Stripe width=128 blocks<br>655360 inodes, 2618880 blocks<br>130944 blocks (5.00%) reserved <span class="hljs-keyword">for</span> the super user<br>First data block=0<br>Maximum filesystem blocks=2151677952<br>80 block <span class="hljs-built_in">groups</span><br>32768 blocks per group, 32768 fragments per group<br>8192 inodes per group<br>Superblock backups stored on blocks: <br>	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632<br><br>Allocating group tables: <span class="hljs-keyword">done</span>                            <br>Writing inode tables: <span class="hljs-keyword">done</span>                            <br>Creating journal (32768 blocks): <span class="hljs-keyword">done</span><br>Writing superblocks and filesystem accounting information: <span class="hljs-keyword">done</span> <br><br>[root@localhost ~]<span class="hljs-comment"># vim /etc/fstab </span><br>[root@localhost ~]<span class="hljs-comment"># cat /etc/fstab </span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># /etc/fstab</span><br><span class="hljs-comment"># Created by anaconda on Tue Jun 28 17:51:01 2022</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><br><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><br><span class="hljs-comment">#</span><br>/dev/mapper/centos-root /                       xfs     defaults        0 0<br>UUID=47e57ec3-dc25-40b5-a567-619b8697712f /boot                   xfs     defaults        0 0<br>/dev/md1                    /mydata    defaults        0 0<br><br><br>[root@localhost ~]<span class="hljs-comment"># mkdir /mydata</span><br><br>[root@localhost ~]<span class="hljs-comment"># mount -a</span><br>[root@localhost ~]<span class="hljs-comment"># df -hT</span><br>Filesystem              Type      Size  Used Avail Use% Mounted on<br>/dev/mapper/centos-root xfs        17G  1.4G   16G   9% /<br>devtmpfs                devtmpfs  475M     0  475M   0% /dev<br>tmpfs                   tmpfs     487M     0  487M   0% /dev/shm<br>tmpfs                   tmpfs     487M  7.7M  479M   2% /run<br>tmpfs                   tmpfs     487M     0  487M   0% /sys/fs/cgroup<br>/dev/sda1               xfs      1014M  133M  882M  14% /boot<br>tmpfs                   tmpfs      98M     0   98M   0% /run/user/0<br>/dev/md1                ext4      9.8G   37M  9.2G   1% /mydata<br></code></pre></td></tr></table></figure>





<h2 id="9、静态配置网卡IP，centos-ubuntu实现"><a href="#9、静态配置网卡IP，centos-ubuntu实现" class="headerlink" title="9、静态配置网卡IP，centos/ubuntu实现"></a>9、静态配置网卡IP，centos/ubuntu实现</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs routeros">[root@localhost network-scripts]# cat /etc/sysconfig/network-scripts/ifcfg-ens37<br><span class="hljs-attribute">TYPE</span>=Ethernet<br><span class="hljs-attribute">BOOTPROTO</span>=static<br><span class="hljs-attribute">NAME</span>=ens37<br><span class="hljs-attribute">DEVICE</span>=ens37<br><span class="hljs-attribute">ONBOOT</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPADDR</span>=192.168.23.101<br><span class="hljs-attribute">NETMASK</span>=255.255.255.0<br><span class="hljs-attribute">GATEWAY</span>=192.168.23.254<br><br>tyh@tyh-virtual-machine:/etc/netplan$ vi 01-network-manager-all.yaml<br>network:<br> version: 2<br> renderer: networkd<br> ethernets:<br>   eth0:<br>     addresses: [192.168.23.201/24]  #或者用下面两行,两种格式不能混用<br>     gateway4:192.168.23.254<br></code></pre></td></tr></table></figure>



<h2 id="10、图文并茂解释TCP-IP-3次握手4次断开。"><a href="#10、图文并茂解释TCP-IP-3次握手4次断开。" class="headerlink" title="10、图文并茂解释TCP/IP 3次握手4次断开。"></a>10、图文并茂解释TCP/IP 3次握手4次断开。</h2><p>(1) TCP/IP的三次握手：<br>①首先 Client 端发送连接请求报文<br>②Server 段接受连接后回复 ACK 报文，并为这次连接分配资源。<br>③Client 端接收到 ACK 报文后也向 Server 段发生 ACK 报文，并分配资源，这样 TCP 连接就建立了。</p>
<p><img src="1656237530645.png" srcset="/img/loading.gif" lazyload alt="1656238302242"></p>
<p><strong>用川航举例子</strong></p>
<p>①四川8633请求建立连接(SYN)，并且发送出序号。<br>②服务端接受到信号，即有确认号（ACK）,此时并同样返回请求序号Seq<br>③客户端接受到信号，即有确认号（ACK），连接已经建立。<br><img src="20200319134530223.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p><strong>小结</strong>：<code>三次握手的关键是要确认对方收到了自己的数据包</code>，这个目标就是通过“确认号（Ack）”字段实现的。计算机会记录下自己发送的数据包序号Seq，待收到对方的数据包后，检测“确认号（Ack）”字段，<code>看Ack = Seq + 1是否成立，如果成立说明对方正确收到了自己的数据包</code>。 </p>
<p><strong>如果只有两次握手</strong> <code>这个时候客户端没有回应，这样会浪费服务端的资源</code></p>
<p><img src="20200319135158648.png" srcset="/img/loading.gif" lazyload alt="在这里插入图片描述"></p>
<p>为什么需要第三次通信 ？</p>
<p>1、在第一次通信过程中，A向B发送信息之后，B收到信息后可以确认自己的收信能力和A的发信能力没有问题。<br>2、在第二次通信中，B向A发送信息之后，A可以确认自己的发信能力和B的收信能力没有问题，但是B不知道自己的发信能力到底如何，所以就需要第三次通信。<br>3、在第三次通信中，A向B发送信息之后，B就可以确认自己的发信能力没有问题。<br>4、 小结：3次握手完成两个重要的功能，既要双方做好发送数据的准备工作(双方都知道彼此已准备好)，也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。</p>
<p>————————————————<br>版权声明：本文为CSDN博主「辰兮要努力」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45393094/article/details/104965561">https://blog.csdn.net/weixin_45393094/article/details/104965561</a></p>
<p>(2) TCP/IP的四次挥手：</p>
<p>建立连接非常重要，它是数据正确传输的前提；断开连接同样重要，它让计算机释放不再使用的资源。如果连接不能正常断开，不仅会造成数据传输错误，还会导致套接字不能关闭，持续占用资源，如果并发量高，服务器压力堪忧。 </p>
<p>第一次挥手：Clien发送一个FIN，用来关闭Client到Server的数据传送，Client进入FIN_WAIT_1状态。<br>第二次挥手：Server收到FIN后，发送一个ACK给Client,Server进入CLOSE_WAIT状态。<br>第三次挥手： Server发送一个FIN，用来关闭Server到Client的数据传送，Server进入LAST_ACK状态。<br>第四次挥手：Client收到FIN后，Client进入TIME_WAIT状态，发送ACK给Server，Server进入CLOSED状态，完成四次握手。</p>
<p><img src="1656239495710.png" srcset="/img/loading.gif" lazyload alt="1656239495710"></p>
<p>川航图举例</p>
<p>①客户端申请断开连接即FIN （我这边准备断开连接了）<br>②服务端接收信息返回，表示我已经接收到 （收到，请稍等，我这边准备一下）<br>③服务端发送信息表示可以断开连接 (我准备好了，你可以断开连接了）<br>④客户端接受信息，同时返回信息通知服务端自己收到信息，开始断开 连接(好的，拜拜！）</p>
<p><img src="1656239640058.png" srcset="/img/loading.gif" lazyload alt="1656239640058"></p>
<p>数据传输完毕后，双方都可释放连接。最开始的时候，客户端和服务器都是处于ESTABLISHED状态，然后客户端主动关闭，服务器被动关闭。</p>
<p>为什么连接的时候是三次握手，关闭的时候却是四次握手？</p>
<p>①因为当Server端收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文是用来应答的，SYN报文是用来同步的。<br>②但是关闭连接时，当Server端收到FIN报文时，很可能并不会立即关闭SOCKET，所以只能先回复一个ACK报文，告诉Client端，“你发的FIN报文我收到了”。<br>③只有等到我Server端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送。故需要四步握手。</p>
<p><strong>补充问题</strong></p>
<ul>
<li><strong>📝TCP的三次握手一定能保证传输可靠吗？</strong><code>不能</code></li>
<li>三次握手比两次更可靠，但也不是完全可靠，而追加更多次握手也不能使连接更可靠了。因此选择了三次握手。</li>
<li>世界上不存在完全可靠的通信协议。从通信时间成本空间成本以及可靠度来讲，选择了“三次握手”作为点对点通信的一般规则</li>
</ul>
<p>————————————————<br>版权声明：本文为CSDN博主「辰兮要努力」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45393094/article/details/104965561">https://blog.csdn.net/weixin_45393094/article/details/104965561</a></p>
<h2 id="11、网卡绑定bond0的实现"><a href="#11、网卡绑定bond0的实现" class="headerlink" title="11、网卡绑定bond0的实现"></a>11、网卡绑定bond0的实现</h2><p>bond聚合链路模式共7种模式：0-6 Mode </p>
<p>mod=0 ，即：(balance-rr) Round-robin policy（轮询）聚合口数据报文按包轮询从物理接口转 发。<br>mod=1，即： (active-backup) Active-backup policy（主-备份策略）只有Active状态的物理接口 才转发数据报文。<br>mod=2，即：(balance-xor) XOR policy（平衡策略）聚合口数据报文按源目MAC、源目IP、源目 端口进行异或HASH运算得到一个值，根据该值查找接口转发数据报文 。<br>mod=3，即：broadcast（广播策略）这种模式的特点是一个报文会复制两份往bond下的两个接 口分别发送出去，<br>mod=4，即：(802.3ad) IEEE 802.3ad Dynamic link aggregation（IEEE 802.3ad 动态链接聚 合）<br>mod=5，即：(balance-tlb) Adaptive transmit load balancing（适配器传输负载均衡）<br>mod=6，即：(balance-alb) Adaptive load balancing（适配器适应性负载均衡）   </p>
<p>说明：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dns">常用的模式为 <span class="hljs-number">0,1,3,6</span><br>mode <span class="hljs-number">1</span>、<span class="hljs-number">5</span>、<span class="hljs-number">6</span> 不需要交换机设置<br>mode <span class="hljs-number">0、2、3、4</span>需要交换机设置<br>active-backup、balance-tlb 和 balance-alb 模式不需要交换机的任何特殊配置。其他绑定模式需<br>要配置交换机以便整合链接。如：Cisco 交换机需要在模式 <span class="hljs-number">0</span>、<span class="hljs-number">2</span> 和 <span class="hljs-number">3</span> 中使用 EtherChannel，但在模<br>式<span class="hljs-number">4</span>中需要 LACP和 EtherChannel<br></code></pre></td></tr></table></figure>



<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs routeros">[root@localhost network-scripts]# nmcli conne<br>NAME   UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33  4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>ens37  4a5516a4-dfa4-24af-b1c4-e843e312e2fd <span class="hljs-built_in"> ethernet </span> ens37  <br>[root@localhost network-scripts]# nmcli conn<br>NAME   UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33  4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>ens37  4a5516a4-dfa4-24af-b1c4-e843e312e2fd <span class="hljs-built_in"> ethernet </span> ens37  <br><br>[root@localhost network-scripts]# nmcli<span class="hljs-built_in"> connection </span><span class="hljs-built_in">add</span> con-name mybond0 ifname bond0<span class="hljs-built_in"> type </span>bond mode active-backup ipv4.method<span class="hljs-built_in"> manual </span>ipv4.address 192.168.23.101/24<span class="hljs-built_in"></span><br><span class="hljs-built_in">Connection </span><span class="hljs-string">&#x27;mybond0&#x27;</span> (69f8a919-2ef4-4c69-816d-9c401cc67425) successfully added.<br><br>[root@localhost network-scripts]# ls<br>ifcfg-ens33    ifdown-bnep  ifdown-post    ifdown-TeamPort  ifup-eth   ifup-plusb   ifup-Team         network-functions<br>ifcfg-ens37    ifdown-eth   ifdown-ppp     ifdown-tunnel    ifup-ippp  ifup-post    ifup-TeamPort     network-functions-ipv6<br>ifcfg-lo       ifdown-ippp  ifdown-routes  ifup             ifup-ipv6  ifup-ppp     ifup-tunnel<br>ifcfg-mybond0  ifdown-ipv6  ifdown-sit     ifup-aliases     ifup-isdn  ifup-routes  ifup-wireless<br>ifdown         ifdown-isdn  ifdown-Team    ifup-bnep        ifup-plip  ifup-sit     init.ipv6-global<br>[root@localhost network-scripts]# cat ifcfg-mybond0 <br><span class="hljs-attribute">BONDING_OPTS</span>=mode=active-backup<br><span class="hljs-attribute">TYPE</span>=Bond<br><span class="hljs-attribute">BONDING_MASTER</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">PROXY_METHOD</span>=none<br><span class="hljs-attribute">BROWSER_ONLY</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">BOOTPROTO</span>=none<br><span class="hljs-attribute">IPADDR</span>=192.168.23.101<br><span class="hljs-attribute">PREFIX</span>=24<br><span class="hljs-attribute">DEFROUTE</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPV4_FAILURE_FATAL</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">IPV6INIT</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPV6_AUTOCONF</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPV6_DEFROUTE</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPV6_FAILURE_FATAL</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">IPV6_ADDR_GEN_MODE</span>=stable-privacy<br><span class="hljs-attribute">NAME</span>=mybond0<br><span class="hljs-attribute">UUID</span>=69f8a919-2ef4-4c69-816d-9c401cc67425<br><span class="hljs-attribute">DEVICE</span>=bond0<br><span class="hljs-attribute">ONBOOT</span>=<span class="hljs-literal">yes</span><br>[root@localhost network-scripts]# nmcli conn<br>NAME     UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33    4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>ens37    4a5516a4-dfa4-24af-b1c4-e843e312e2fd <span class="hljs-built_in"> ethernet </span> ens37  <br>mybond0  69f8a919-2ef4-4c69-816d-9c401cc67425  bond      bond0  <br><br>[root@localhost network-scripts]# nmcli con <span class="hljs-built_in">add</span><span class="hljs-built_in"> type </span>bond-slave ifname ens33 master bond0<span class="hljs-built_in"></span><br><span class="hljs-built_in">Connection </span><span class="hljs-string">&#x27;bond-slave-ens33&#x27;</span> (c700dceb-866f-4ec2-9d3d-192e60208555) successfully added.<br>[root@localhost network-scripts]# nmcli con <span class="hljs-built_in">add</span><span class="hljs-built_in"> type </span>bond-slave ifname ens37 master bond0<span class="hljs-built_in"></span><br><span class="hljs-built_in">Connection </span><span class="hljs-string">&#x27;bond-slave-ens37&#x27;</span> (a92a8c76-fd96-4647-844c-28941760fee6) successfully added.<br>[root@localhost network-scripts]# nmcli conn<br>NAME              UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33             4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>ens37             4a5516a4-dfa4-24af-b1c4-e843e312e2fd <span class="hljs-built_in"> ethernet </span> ens37  <br>mybond0           69f8a919-2ef4-4c69-816d-9c401cc67425  bond      bond0  <br>bond-slave-ens33  c700dceb-866f-4ec2-9d3d-192e60208555 <span class="hljs-built_in"> ethernet </span> --     <br>bond-slave-ens37  a92a8c76-fd96-4647-844c-28941760fee6 <span class="hljs-built_in"> ethernet </span> --  <br><br>[root@localhost network-scripts]# nmcli conn up bond-slave-ens33<span class="hljs-built_in"></span><br><span class="hljs-built_in">Connection </span>successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/5)<br>[root@localhost network-scripts]# nmcli conn<br>NAME              UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33             4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>mybond0           69f8a919-2ef4-4c69-816d-9c401cc67425  bond      bond0  <br>bond-slave-ens37  a92a8c76-fd96-4647-844c-28941760fee6 <span class="hljs-built_in"> ethernet </span> ens37  <br>bond-slave-ens33  c700dceb-866f-4ec2-9d3d-192e60208555 <span class="hljs-built_in"> ethernet </span> --     <br>bond-slave-eth1   5e9bf4b1-c300-4432-8184-4a94dd47d65e <span class="hljs-built_in"> ethernet </span> --     <br>ethernet-ens37    429edf31-7af6-4375-8b8a-9060d6a9d755 <span class="hljs-built_in"> ethernet </span> --    <br></code></pre></td></tr></table></figure>



<p>查看两块网卡的主从：</p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs tcl">[root@localhost network-scripts]# cat /<span class="hljs-keyword">proc</span>/net/bonding/bond0<span class="hljs-title"> </span><br><span class="hljs-title">Ethernet</span> Channel<span class="hljs-title"> Bonding</span> Driver:<span class="hljs-title"> v3.7.1</span> (April 27, 2011)<span class="hljs-title"></span><br><span class="hljs-title"></span><br><span class="hljs-title">Bonding</span> Mode:<span class="hljs-title"> fault-tolerance</span> (active-backup)           // 使用的模式，主-备份策略<span class="hljs-title"></span><br><span class="hljs-title">Primary</span> Slave:<span class="hljs-title"> None</span><br>Currently<span class="hljs-title"> Active</span> Slave:<span class="hljs-title"> ens37</span>                           //<span class="hljs-title"> ens37现在是干活的，ens33为备用</span><br>MII<span class="hljs-title"> Status:</span> up<span class="hljs-title"></span><br><span class="hljs-title">MII</span> Polling<span class="hljs-title"> Interval</span> (ms): 100<span class="hljs-title"></span><br><span class="hljs-title">Up</span> Delay (ms): 0<span class="hljs-title"></span><br><span class="hljs-title">Down</span> Delay (ms): 0<span class="hljs-title"></span><br><span class="hljs-title"></span><br><span class="hljs-title">Slave</span> Interface:<span class="hljs-title"> ens37</span><br>MII<span class="hljs-title"> Status:</span> up<span class="hljs-title"></span><br><span class="hljs-title">Speed:</span> 1000<span class="hljs-title"> Mbps</span><br>Duplex:<span class="hljs-title"> full</span><br>Link<span class="hljs-title"> Failure</span> Count: 0<span class="hljs-title"></span><br><span class="hljs-title">Permanent</span> HW<span class="hljs-title"> addr:</span> 00:0c:29:32:65:0e<span class="hljs-title"></span><br><span class="hljs-title">Slave</span> queue<span class="hljs-title"> ID:</span> 0<span class="hljs-title"></span><br><span class="hljs-title"></span><br><span class="hljs-title">Slave</span> Interface:<span class="hljs-title"> ens33</span><br>MII<span class="hljs-title"> Status:</span> up<span class="hljs-title"></span><br><span class="hljs-title">Speed:</span> 1000<span class="hljs-title"> Mbps</span><br>Duplex:<span class="hljs-title"> full</span><br>Link<span class="hljs-title"> Failure</span> Count: 0<span class="hljs-title"></span><br><span class="hljs-title">Permanent</span> HW<span class="hljs-title"> addr:</span> 00:0c:29:32:65:04<span class="hljs-title"></span><br><span class="hljs-title">Slave</span> queue<span class="hljs-title"> ID:</span> 0<br></code></pre></td></tr></table></figure>



<p>12、实现免密登陆脚本, expect登陆远程主机，将生成的密钥写入到目标主机, expect测试远程登陆。<br>     1）通过shift读取脚本参数<br>     2）通过select来选择功能.例如功能有</p>
<ul>
<li>安装mysql</li>
<li>安装apache</li>
<li>免密钥登陆主机<br>当前我们只实现免密钥登陆主机<br>3）通过函数封装每个功能<br>4）将免密钥登陆的过程可以重复进行, while 循环实现重复，需要有退出过程。当用户输入exit时，退出免密钥功能。<br>5）支持输入一批主机免密钥，使用数组 实现</li>
</ul>
<p>[root@localhost ~]# vim ssh.sh<br>[root@localhost ~]# cat ssh.sh<br>#!/bin/bash</p>
<p>read -p “Which IP address you want to connect to?:” ip<br>read -s -p “and password:” pwd     #-s要在前面表示静默输出，保护密码</p>
<p>yum -y install openssh expect</p>
<p>expect &lt;&lt; EOF     #表示里面的内容均由expect命令去执行</p>
<p>set timeout 30     #设置超时时间为30秒，下面的代码需在30秒钟内完成，如果超过，则退出。用来防止ssh远程主机网络不可达时卡住及在远程主机执行命令宕住</p>
<p>spawn   ssh-keygen  #激活一个交互式会话，在系统中创建一个进程</p>
<p>expect     {<br>        “.ssh/id_rsa)”       { send    “\r”;  exp_continue } #捕捉关键字，然后回车<br>        “Overwrite (y/n)?”   { send    “y\r”; exp_continue } #捕捉关键字后输入y然后回车<br>        “no passphrase):”    { send    “\r”;  exp_continue }<br>        “again:”             { send    “\r”;  exp_continue }<br>}</p>
<p>spawn ssh-copy-id root@$ip</p>
<p>expect {<br>     “yes/no”   { send “yes\r”;  exp_continue }<br>     “password” { send “$pwd\r”; exp_continue }<br>}<br>EOF</p>
<p>[root@localhost ~]# ./ssh.sh<br>Which IP address you want to connect to?:192.168.216.200<br>and password:1<br>spawn ssh-keygen<br>Generating public/private rsa key pair.<br>Enter file in which to save the key (/root/.ssh/id_rsa):<br>/root/.ssh/id_rsa already exists.<br>Overwrite (y/n)? y<br>Enter passphrase (empty for no passphrase):<br>Enter same passphrase again:<br>Your identification has been saved in /root/.ssh/id_rsa.<br>Your public key has been saved in /root/.ssh/id_rsa.pub.<br>The key fingerprint is:<br>SHA256:xaplvcpVheYg5sR/JU6QBlg+jMy9hYqxR1k7AiqK9Bk <a href="mailto:&#x72;&#x6f;&#111;&#x74;&#64;&#x6c;&#111;&#99;&#x61;&#x6c;&#x68;&#x6f;&#x73;&#116;&#46;&#x6c;&#111;&#99;&#97;&#108;&#100;&#x6f;&#109;&#97;&#105;&#x6e;">&#x72;&#x6f;&#111;&#x74;&#64;&#x6c;&#111;&#99;&#x61;&#x6c;&#x68;&#x6f;&#x73;&#116;&#46;&#x6c;&#111;&#99;&#97;&#108;&#100;&#x6f;&#109;&#97;&#105;&#x6e;</a><br>The key’s randomart image is:<br>+—[RSA 2048]—-+<br>|    .  o+…     |<br>|   . +.O +o. .   |<br>|…E. B &amp;.= = o  |<br>|+.. o= * @ * +   |<br>|o  oo o S o =    |<br>|     . +   +     |<br>|      .   o      |<br>|       . o       |<br>|        o        |<br>+—-[SHA256]—–+<br>spawn ssh-copy-id <a href="mailto:&#x72;&#111;&#111;&#116;&#x40;&#x31;&#57;&#x32;&#46;&#x31;&#54;&#x38;&#x2e;&#50;&#x31;&#x36;&#46;&#50;&#48;&#x30;">&#x72;&#111;&#111;&#116;&#x40;&#x31;&#57;&#x32;&#46;&#x31;&#54;&#x38;&#x2e;&#50;&#x31;&#x36;&#46;&#50;&#48;&#x30;</a><br>/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: “/root/.ssh/id_rsa.pub”<br>/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed<br>/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed – if you are prompted now it is to install the new keys<br><a href="mailto:&#x72;&#x6f;&#111;&#x74;&#x40;&#49;&#57;&#50;&#46;&#x31;&#x36;&#x38;&#x2e;&#50;&#x31;&#54;&#x2e;&#x32;&#48;&#x30;">&#x72;&#x6f;&#111;&#x74;&#x40;&#49;&#57;&#50;&#46;&#x31;&#x36;&#x38;&#x2e;&#50;&#x31;&#54;&#x2e;&#x32;&#48;&#x30;</a>‘s password: </p>
<p>Number of key(s) added: 1</p>
<p>Now try logging into the machine, with:   “ssh ‘<a href="mailto:&#114;&#111;&#111;&#x74;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#54;&#x38;&#46;&#50;&#49;&#x36;&#46;&#x32;&#x30;&#48;">&#114;&#111;&#111;&#x74;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#54;&#x38;&#46;&#50;&#49;&#x36;&#46;&#x32;&#x30;&#48;</a>‘“<br>and check to make sure that only the key(s) you wanted were added.</p>
<h2 id="12、免交互实例（免密登陆）"><a href="#12、免交互实例（免密登陆）" class="headerlink" title="12、免交互实例（免密登陆）"></a>12、免交互实例（免密登陆）</h2><p>#!/bin/bash<br>yum -y install expect<br>ip=$1<br>passwd=$2<br>/usr/bin/expect&lt;&lt;EOF<br>spawn ssh-keygen -t rsa<br>expect {<br>        “(/root/.ssh/id_rsa)”<br>        {send “\r”;exp_continue}<br>        “(empty for no passphrase)”<br>        {send “\r”;exp_continue}<br>        “passphrase again”<br>        {send “\r”}<br>}<br>expect eof<br>EOF<br>/usr/bin/expect&lt;&lt;EOF<br>spawn ssh-copy-id $1<br>expect {<br>        “(yes/no)”<br>        {send “yes\r”;exp_continue}<br>        “password”<br>        {send “$2\r”}<br>}<br>expect eof<br>EOF<br>ssh root@$1 </p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E4%BD%9C%E4%B8%9A/">作业</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/linux/">linux</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/06/26/%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">初始化系统环境</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/06/18/1%E3%80%81%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%92%8Clinux%E5%AE%89%E8%A3%85/">
                        <span class="hidden-mobile">1、计算机基础和linux安装</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
