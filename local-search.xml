<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>平台包升级自动化脚本</title>
    <link href="/2022/08/06/%E5%B9%B3%E5%8F%B0%E5%8C%85%E5%8D%87%E7%BA%A7%E8%87%AA%E5%8A%A8%E5%8C%96%E8%84%9A%E6%9C%AC/"/>
    <url>/2022/08/06/%E5%B9%B3%E5%8F%B0%E5%8C%85%E5%8D%87%E7%BA%A7%E8%87%AA%E5%8A%A8%E5%8C%96%E8%84%9A%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><span id="more"></span><figure class="highlight routeros"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><pre><code class="hljs routeros">[root@node1 shell]# cat update_pkg_test.sh<br><span class="hljs-comment">#!/bin/bash</span><br>read -p <span class="hljs-string">&quot;Please input your packageName: &quot;</span> TarName<br>echo <span class="hljs-variable">$TarName</span> &gt;&gt; TarName.txt &amp;&amp; docker load -i <span class="hljs-variable">$TarName</span><br><span class="hljs-attribute">version</span>=`echo <span class="hljs-variable">$TarName</span>|awk -F <span class="hljs-string">&quot;_&quot;</span> <span class="hljs-string">&#x27;&#123;print$2&#125;&#x27;</span>|awk -v <span class="hljs-attribute">FS</span>=<span class="hljs-string">&#x27;.&#x27;</span> <span class="hljs-string">&#x27;&#123;print$1FS$2FS$3FS$4&#125;&#x27;</span>`<br>echo <span class="hljs-variable">$version</span> &gt;&gt; version.txt<br><span class="hljs-attribute">ServiceName</span>=`echo <span class="hljs-variable">$TarName</span>|awk -F <span class="hljs-string">&quot;_&quot;</span> <span class="hljs-string">&#x27;&#123;print$1&#125;&#x27;</span>`<br>echo <span class="hljs-variable">$ServiceName</span> &gt;&gt; ServiceName.txt<br><span class="hljs-attribute">ImagesId</span>=`docker images|grep <span class="hljs-variable">$ServiceName</span>|awk -F <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-string">&#x27;&#123;print $3&#125;&#x27;</span>`<br>echo <span class="hljs-variable">$ImagesId</span> &gt;&gt; ImagesId.txt<br><span class="hljs-attribute">sgmc</span>=cr.registry.res.sgmc.sgcc.com.cn/i6000/<br><span class="hljs-attribute">registry_Address</span>=<span class="hljs-variable">$sgmc</span><span class="hljs-variable">$ServiceName</span>:$version<br>echo <span class="hljs-variable">$registry_Address</span> &gt;&gt; registry_Address.txt<br>docker tag <span class="hljs-variable">$ImagesId</span> <span class="hljs-variable">$registry_Address</span><br>docker images |grep <span class="hljs-variable">$ServiceName</span><br></code></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">root@node1</span> <span class="hljs-string">shell</span>]<span class="hljs-comment"># ./update_pkg_test.sh </span><br><span class="hljs-attr">Please input your packageName:</span> <span class="hljs-string">i6000-angular-front_2.0.26.20220424163738.tar</span><br><span class="hljs-attr">2edcec3590a4:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">83.86</span> <span class="hljs-string">MB/83.86</span> <span class="hljs-string">MB</span><br><span class="hljs-attr">e379e8aedd4d:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>]    <span class="hljs-number">62</span> <span class="hljs-string">MB/62</span> <span class="hljs-string">MB</span><br><span class="hljs-attr">b8d6e692a25e:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">3.072</span> <span class="hljs-string">kB/3.072</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">f1db227348d0:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">4.096</span> <span class="hljs-string">kB/4.096</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">32ce5f6a5106:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">3.584</span> <span class="hljs-string">kB/3.584</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">d874fd2bc83b:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">7.168</span> <span class="hljs-string">kB/7.168</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">6bde2ade907f:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">157.9</span> <span class="hljs-string">MB/157.9</span> <span class="hljs-string">MB</span><br><span class="hljs-attr">2239ae925798:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>]  <span class="hljs-number">5.12</span> <span class="hljs-string">kB/5.12</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">9d31d3f13b68:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">4.096</span> <span class="hljs-string">kB/4.096</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">9a26e8d4441e:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">5.632</span> <span class="hljs-string">kB/5.632</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">716842aa424f:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">5.632</span> <span class="hljs-string">kB/5.632</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">93a1ee32972b:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">5.632</span> <span class="hljs-string">kB/5.632</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">a48958a8796b:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">5.632</span> <span class="hljs-string">kB/5.632</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">52516cae62cd:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">5.632</span> <span class="hljs-string">kB/5.632</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">39f1b624a342:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">4.608</span> <span class="hljs-string">kB/4.608</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">b79772e475a9:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">3.072</span> <span class="hljs-string">kB/3.072</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">4df452a05af3:</span> <span class="hljs-string">Loading</span> <span class="hljs-string">layer</span> [<span class="hljs-string">==================================================&gt;</span>] <span class="hljs-number">4.608</span> <span class="hljs-string">kB/4.608</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Loaded image:</span> <span class="hljs-string">registry.nrxt.com/i6000/i6000-public/i6000-angular-front:2.0.26.20220424163738</span><br><span class="hljs-string">cr.registry.res.sgmc.sgcc.com.cn/i6000/i6000-angular-front</span>   <span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220424163738</span>   <span class="hljs-string">5c178accd6df</span>        <span class="hljs-number">3</span> <span class="hljs-string">months</span> <span class="hljs-string">ago</span>        <span class="hljs-number">294</span> <span class="hljs-string">MB</span><br><span class="hljs-string">registry.nrxt.com/i6000/i6000-public/i6000-angular-front</span>     <span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220424163738</span>   <span class="hljs-string">5c178accd6df</span>        <span class="hljs-number">3</span> <span class="hljs-string">months</span> <span class="hljs-string">ago</span>        <span class="hljs-number">294</span> <span class="hljs-string">MB</span><br></code></pre></td></tr></table></figure><p>加注释：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs markdown">[root@node1 shell]# cat update<span class="hljs-emphasis">_pkg_</span>test.sh<br><span class="hljs-section">#!/bin/bash</span><br><span class="hljs-section">#</span><br><span class="hljs-section">#<span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span></span><br><span class="hljs-section">#Author: tianyonghui</span><br><span class="hljs-section">#Date: 2022-07-22</span><br><span class="hljs-section">#Description： 单个平台包的升级</span><br><span class="hljs-section">#<span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span></span><br><span class="hljs-section"># 根据提示，手动输入要升级的tar包名称，使用read从标准输入中读取值</span><br>read -p &quot;Please input your packageName: &quot; TarName<br><br><span class="hljs-section"># 加载tar包，并定义相关的变量</span><br>echo $TarName &gt;&gt; TarName.txt &amp;&amp; docker load -i $TarName<br>version=<span class="hljs-code">`echo $TarName|awk -F &quot;_&quot; &#x27;&#123;print$2&#125;&#x27;|awk -v FS=&#x27;.&#x27; &#x27;&#123;print$1FS$2FS$3FS$4&#125;&#x27;`</span><br>echo $version &gt;&gt; version.txt<br>ServiceName=<span class="hljs-code">`echo $TarName|awk -F &quot;_&quot; &#x27;&#123;print$1&#125;&#x27;`</span><br>echo $ServiceName &gt;&gt; ServiceName.txt<br>ImagesId=<span class="hljs-code">`docker images|grep $ServiceName|awk -F &#x27; &#x27; &#x27;&#123;print $3&#125;&#x27;`</span>    #生产环境有多行信息，需要优化只取第一行信息<br>echo $ImagesId &gt;&gt; ImagesId.txt<br>sgmc=cr.registry.res.sgmc.sgcc.com.cn/i6000/<br>registry<span class="hljs-emphasis">_Address=$sgmc$ServiceName:$version</span><br><span class="hljs-emphasis">echo $registry_</span>Address &gt;&gt; registry<span class="hljs-emphasis">_Address.txt</span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"># 打标签</span><br><span class="hljs-emphasis">docker tag $ImagesId $registry_</span>Address<br>docker images |grep $ServiceName<br><br><span class="hljs-section">#推送镜像到仓库</span><br>docker push $registry<span class="hljs-emphasis">_Address</span><br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs vim">[root@node1 <span class="hljs-keyword">shell</span>]# <span class="hljs-keyword">sh</span> update_pkg_test.<span class="hljs-keyword">sh</span><br>Please <span class="hljs-built_in">input</span> your packageName: i6000-angular-front_2.<span class="hljs-number">0.26</span>.<span class="hljs-number">20220424163738</span>.tar<br><span class="hljs-number">2</span>edcec3590a4: Loading layer [==================================================&gt;] <span class="hljs-number">83.86</span> MB/<span class="hljs-number">83.86</span> MB<br>e379e8aedd4d: Loading layer [==================================================&gt;]    <span class="hljs-number">62</span> MB/<span class="hljs-number">62</span> MB<br>b8d6e692a25e: Loading layer [==================================================&gt;] <span class="hljs-number">3.072</span> kB/<span class="hljs-number">3.072</span> kB<br>f1db227348d0: Loading layer [==================================================&gt;] <span class="hljs-number">4.096</span> kB/<span class="hljs-number">4.096</span> kB<br><span class="hljs-number">32</span>ce5f6a5106: Loading layer [==================================================&gt;] <span class="hljs-number">3.584</span> kB/<span class="hljs-number">3.584</span> kB<br>d874fd2bc83b: Loading layer [==================================================&gt;] <span class="hljs-number">7.168</span> kB/<span class="hljs-number">7.168</span> kB<br><span class="hljs-number">6</span>bde2ade907f: Loading layer [==================================================&gt;] <span class="hljs-number">157.9</span> MB/<span class="hljs-number">157.9</span> MB<br><span class="hljs-number">2239</span>ae925798: Loading layer [==================================================&gt;]  <span class="hljs-number">5.12</span> kB/<span class="hljs-number">5.12</span> kB<br><span class="hljs-number">9</span>d31d3f13b68: Loading layer [==================================================&gt;] <span class="hljs-number">4.096</span> kB/<span class="hljs-number">4.096</span> kB<br><span class="hljs-number">9</span>a26e8d4441e: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br><span class="hljs-number">716842</span>aa424f: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br><span class="hljs-number">93</span>a1ee32972b: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br>a48958a8796b: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br><span class="hljs-number">52516</span>cae62cd: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br><span class="hljs-number">39</span>f1b624a342: Loading layer [==================================================&gt;] <span class="hljs-number">4.608</span> kB/<span class="hljs-number">4.608</span> kB<br>b79772e475a9: Loading layer [==================================================&gt;] <span class="hljs-number">3.072</span> kB/<span class="hljs-number">3.072</span> kB<br><span class="hljs-number">4</span>df452a05af3: Loading layer [==================================================&gt;] <span class="hljs-number">4.608</span> kB/<span class="hljs-number">4.608</span> kB<br>Loaded image: registry.nrxt.<span class="hljs-keyword">com</span>/i6000/i6000-public/i6000-angular-fron<span class="hljs-variable">t:2</span>.<span class="hljs-number">0.26</span>.<span class="hljs-number">20220424163738</span><br><span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/i6000/i6000-angular-front   <span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220424163738</span>   <span class="hljs-number">5</span>c178accd6df        <span class="hljs-number">3</span> months ago        <span class="hljs-number">294</span> MB<br>registry.nrxt.<span class="hljs-keyword">com</span>/i6000/i6000-public/i6000-angular-front     <span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220424163738</span>   <span class="hljs-number">5</span>c178accd6df        <span class="hljs-number">3</span> months ago        <span class="hljs-number">294</span> MB<br>The push refers <span class="hljs-keyword">to</span> <span class="hljs-keyword">a</span> repository [<span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/i6000/i6000-angular-front]<br>Get https://<span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/v1/_ping: dial tcp: lookup <span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span> <span class="hljs-keyword">on</span> <span class="hljs-number">10.0</span>.<span class="hljs-number">21.254</span>:<span class="hljs-number">53</span>: <span class="hljs-keyword">no</span> such host<br></code></pre></td></tr></table></figure><p>================================</p><p>初步完善</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node1 shell]<span class="hljs-comment"># cat update_pkg_test.sh</span><br><span class="hljs-comment">#!/bin/bash</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#********************************************************************</span><br><span class="hljs-comment">#Author: tianyonghui</span><br><span class="hljs-comment">#Date: 2022-07-22</span><br><span class="hljs-comment">#Description： 单个平台包的升级</span><br><span class="hljs-comment">#********************************************************************</span><br><span class="hljs-comment"># 根据提示，手动输入要升级的tar包名称，使用read从标准输入中读取值</span><br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;Please input your packageName: &quot;</span> TarName<br><br><span class="hljs-comment"># 根据tar包元素，定义相关变量</span><br>ServiceName=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$TarName</span>|awk -F <span class="hljs-string">&quot;_&quot;</span> <span class="hljs-string">&#x27;&#123;print$1&#125;&#x27;</span>`<br><span class="hljs-built_in">mkdir</span> <span class="hljs-string">&quot;`date +%F`_<span class="hljs-variable">$ServiceName</span>&quot;</span><br><span class="hljs-built_in">dir</span>=$<span class="hljs-string">&quot;`date +%F`_<span class="hljs-variable">$ServiceName</span>&quot;</span><br>version=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$TarName</span>|awk -F <span class="hljs-string">&quot;_&quot;</span> <span class="hljs-string">&#x27;&#123;print$2&#125;&#x27;</span>|awk -v FS=<span class="hljs-string">&#x27;.&#x27;</span> <span class="hljs-string">&#x27;&#123;print$1FS$2FS$3FS$4&#125;&#x27;</span>`<br><br><span class="hljs-comment"># 加载tar包、定义相关的变量，并将变量记录到文件中</span><br>docker load -i <span class="hljs-variable">$TarName</span><br>docker images |grep <span class="hljs-variable">$ServiceName</span> &gt; <span class="hljs-variable">$dir</span>/images.txt<br>ImagesId=`<span class="hljs-built_in">cat</span> <span class="hljs-variable">$dir</span>/images.txt|<span class="hljs-built_in">head</span> -1|awk -F <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-string">&#x27;&#123;print $3&#125;&#x27;</span>`<br>sgmc=cr.registry.res.sgmc.sgcc.com.cn/i6000/<br>registry_Address=$sgmc<span class="hljs-variable">$ServiceName</span>:<span class="hljs-variable">$version</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$TarName</span> &gt;&gt; <span class="hljs-variable">$dir</span>/TarName.txt &amp;&amp; <br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$version</span> &gt;&gt; <span class="hljs-variable">$dir</span>/version.txt<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$ServiceName</span> &gt;&gt; <span class="hljs-variable">$dir</span>/ServiceName.txt<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$ImagesId</span> &gt;&gt; <span class="hljs-variable">$dir</span>/ImagesId.txt<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$registry_Address</span> &gt;&gt; <span class="hljs-variable">$dir</span>/registry_Address.txt<br><br><span class="hljs-comment"># 打标签</span><br>docker tag <span class="hljs-variable">$ImagesId</span> <span class="hljs-variable">$registry_Address</span><br>docker images |grep <span class="hljs-variable">$ServiceName</span><br><br><span class="hljs-comment">#推送镜像到仓库</span><br>docker push <span class="hljs-variable">$registry_Address</span><br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs vim">[root@node1 <span class="hljs-keyword">shell</span>]# <span class="hljs-keyword">sh</span> update_pkg_test.<span class="hljs-keyword">sh</span><br>Please <span class="hljs-built_in">input</span> your packageName: i6000-angular-front_2.<span class="hljs-number">0.26</span>.<span class="hljs-number">20220424163738</span>.tar<br><span class="hljs-number">2</span>edcec3590a4: Loading layer [==================================================&gt;] <span class="hljs-number">83.86</span> MB/<span class="hljs-number">83.86</span> MB<br>e379e8aedd4d: Loading layer [==================================================&gt;]    <span class="hljs-number">62</span> MB/<span class="hljs-number">62</span> MB<br>b8d6e692a25e: Loading layer [==================================================&gt;] <span class="hljs-number">3.072</span> kB/<span class="hljs-number">3.072</span> kB<br>f1db227348d0: Loading layer [==================================================&gt;] <span class="hljs-number">4.096</span> kB/<span class="hljs-number">4.096</span> kB<br><span class="hljs-number">32</span>ce5f6a5106: Loading layer [==================================================&gt;] <span class="hljs-number">3.584</span> kB/<span class="hljs-number">3.584</span> kB<br>d874fd2bc83b: Loading layer [==================================================&gt;] <span class="hljs-number">7.168</span> kB/<span class="hljs-number">7.168</span> kB<br><span class="hljs-number">6</span>bde2ade907f: Loading layer [==================================================&gt;] <span class="hljs-number">157.9</span> MB/<span class="hljs-number">157.9</span> MB<br><span class="hljs-number">2239</span>ae925798: Loading layer [==================================================&gt;]  <span class="hljs-number">5.12</span> kB/<span class="hljs-number">5.12</span> kB<br><span class="hljs-number">9</span>d31d3f13b68: Loading layer [==================================================&gt;] <span class="hljs-number">4.096</span> kB/<span class="hljs-number">4.096</span> kB<br><span class="hljs-number">9</span>a26e8d4441e: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br><span class="hljs-number">716842</span>aa424f: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br><span class="hljs-number">93</span>a1ee32972b: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br>a48958a8796b: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br><span class="hljs-number">52516</span>cae62cd: Loading layer [==================================================&gt;] <span class="hljs-number">5.632</span> kB/<span class="hljs-number">5.632</span> kB<br><span class="hljs-number">39</span>f1b624a342: Loading layer [==================================================&gt;] <span class="hljs-number">4.608</span> kB/<span class="hljs-number">4.608</span> kB<br>b79772e475a9: Loading layer [==================================================&gt;] <span class="hljs-number">3.072</span> kB/<span class="hljs-number">3.072</span> kB<br><span class="hljs-number">4</span>df452a05af3: Loading layer [==================================================&gt;] <span class="hljs-number">4.608</span> kB/<span class="hljs-number">4.608</span> kB<br>Loaded image: registry.nrxt.<span class="hljs-keyword">com</span>/i6000/i6000-public/i6000-angular-fron<span class="hljs-variable">t:2</span>.<span class="hljs-number">0.26</span>.<span class="hljs-number">20220424163738</span><br><span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/i6000/i6000-angular-front   <span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220424163738</span>   <span class="hljs-number">5</span>c178accd6df        <span class="hljs-number">3</span> months ago        <span class="hljs-number">294</span> MB<br>registry.nrxt.<span class="hljs-keyword">com</span>/i6000/i6000-public/i6000-angular-front     <span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220424163738</span>   <span class="hljs-number">5</span>c178accd6df        <span class="hljs-number">3</span> months ago        <span class="hljs-number">294</span> MB<br>The push refers <span class="hljs-keyword">to</span> <span class="hljs-keyword">a</span> repository [<span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/i6000/i6000-angular-front]<br>Get https://<span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/v1/_ping: dial tcp: lookup <span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span> <span class="hljs-keyword">on</span> <span class="hljs-number">10.0</span>.<span class="hljs-number">21.254</span>:<span class="hljs-number">53</span>: <span class="hljs-keyword">no</span> such host<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>docker镜像推送</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/08/05/hello-world/"/>
    <url>/2022/08/05/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a><br>1111</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>多节点之间免密登录</title>
    <link href="/2022/07/09/%E5%A4%9A%E8%8A%82%E7%82%B9%E4%B9%8B%E9%97%B4%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/"/>
    <url>/2022/07/09/%E5%A4%9A%E8%8A%82%E7%82%B9%E4%B9%8B%E9%97%B4%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><span id="more"></span><p>需求：</p><p>1、多个节点之间，互相ssh，都不需要输入对方的系统账号密码，以提高管理、部署的效率；<br>2、避免因为泄露了一台服务器的密码，而导致其它所有服务器都被暴漏的危险，以保证一定的安全性；</p><p>多个节点公用一个密钥对，可以实现互相免密登录；<br>对私钥进行加密，并且启动代理，在登录后、登出之前，只输入一次私钥密码，即可满足操作的方便、以及账号的安全；</p><p><img src="image-20220710003251923.png" alt="image-20220710003251923"></p><figure class="highlight applescript"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><pre><code class="hljs applescript">[root@node1 ~]<span class="hljs-comment"># ssh-keygen</span><br>[root@node1 ~]<span class="hljs-comment"># ssh-copy-id 127.0.0.1</span><br>/usr/bin/ssh-<span class="hljs-keyword">copy</span>-<span class="hljs-built_in">id</span>: INFO: Source <span class="hljs-keyword">of</span> key(s) <span class="hljs-keyword">to</span> be installed: <span class="hljs-string">&quot;/root/.ssh/id_rsa.pub&quot;</span><br>The authenticity <span class="hljs-keyword">of</span> host &#x27;<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> (<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>)&#x27; can&#x27;t be established.<br>ECDSA key fingerprint <span class="hljs-keyword">is</span> SHA256:/AaL9QiN7JWUr8LZsqaGeKWO+DfRswsVJVakIyoOHLM.<br>ECDSA key fingerprint <span class="hljs-keyword">is</span> MD5:<span class="hljs-number">29</span>:<span class="hljs-number">79</span>:<span class="hljs-number">27</span>:f9:a6:f0:<span class="hljs-number">08</span>:ff:<span class="hljs-number">37</span>:fa:<span class="hljs-number">59</span>:<span class="hljs-number">0</span>a:<span class="hljs-number">0</span>f:a1:ff:<span class="hljs-number">0</span>d.<br>Are you sure you want <span class="hljs-keyword">to</span> <span class="hljs-keyword">continue</span> connecting (yes/no)? yes<br>/usr/bin/ssh-<span class="hljs-keyword">copy</span>-<span class="hljs-built_in">id</span>: INFO: attempting <span class="hljs-keyword">to</span> <span class="hljs-built_in">log</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> new key(s), <span class="hljs-keyword">to</span> filter out any <span class="hljs-keyword">that</span> are already installed<br>/usr/bin/ssh-<span class="hljs-keyword">copy</span>-<span class="hljs-built_in">id</span>: INFO: <span class="hljs-number">1</span> key(s) remain <span class="hljs-keyword">to</span> be installed <span class="hljs-comment">-- if you are prompted now it is to install the new keys</span><br>root@<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>&#x27;s password: <br>Permission denied, please <span class="hljs-keyword">try</span> again.<br>root@<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>&#x27;s password: <br><br>Number <span class="hljs-keyword">of</span> key(s) added: <span class="hljs-number">1</span><br><br>Now <span class="hljs-keyword">try</span> logging <span class="hljs-keyword">into</span> <span class="hljs-keyword">the</span> machine, <span class="hljs-keyword">with</span>:   <span class="hljs-string">&quot;ssh &#x27;127.0.0.1&#x27;&quot;</span><br><span class="hljs-keyword">and</span> check <span class="hljs-keyword">to</span> make sure <span class="hljs-keyword">that</span> only <span class="hljs-keyword">the</span> key(s) you wanted were added.<br></code></pre></td></tr></table></figure><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs livescript">[root@node1 ~]<span class="hljs-comment"># for i in `cat /test/hosts.txt`;do scp -rp .ssh $i:/root;done</span><br>[root@node2 ~]<span class="hljs-comment"># ssh 192.168.23.105</span><br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">09</span>:<span class="hljs-number">13</span>:<span class="hljs-number">32</span> <span class="hljs-number">2022</span> <span class="hljs-keyword">from</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">23.101</span><br>[root@node5 ~]<span class="hljs-comment"># ssh 192.168.23.106</span><br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">09</span>:<span class="hljs-number">13</span>:<span class="hljs-number">37</span> <span class="hljs-number">2022</span> <span class="hljs-keyword">from</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">23.101</span><br>[root@node6 ~]<span class="hljs-comment"># exit</span><br>logout<br>Connection <span class="hljs-keyword">to</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">23.106</span> closed.<br>[root@node5 ~]<span class="hljs-comment"># exit</span><br>logout<br>Connection <span class="hljs-keyword">to</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">23.105</span> closed.<br></code></pre></td></tr></table></figure><p>对私钥进行加密</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">[root@node1 ~]<span class="hljs-comment"># ssh-keygen -p</span><br>Enter file <span class="hljs-keyword">in</span> which the key <span class="hljs-keyword">is</span> (<span class="hljs-regexp">/root/</span>.ssh/id_rsa): <span class="hljs-number">123456</span><br><span class="hljs-number">123456</span>: No such file <span class="hljs-keyword">or</span> directory<br>[root@node1 ~]<span class="hljs-comment"># cd .ssh/</span><br>[root@node1 .ssh]<span class="hljs-comment"># ll</span><br>total <span class="hljs-number">16</span><br>-rw------- <span class="hljs-number">1</span> root root  <span class="hljs-number">392</span> Jul <span class="hljs-number">10</span> <span class="hljs-number">00</span>:<span class="hljs-number">17</span> authorized_keys<br>-rw------- <span class="hljs-number">1</span> root root <span class="hljs-number">1675</span> Jul  <span class="hljs-number">9</span> <span class="hljs-number">20</span>:<span class="hljs-number">54</span> id_rsa<br>-rw-r--r-- <span class="hljs-number">1</span> root root  <span class="hljs-number">392</span> Jul  <span class="hljs-number">9</span> <span class="hljs-number">20</span>:<span class="hljs-number">54</span> id_rsa.pub<br>-rw-r--r-- <span class="hljs-number">1</span> root root <span class="hljs-number">1051</span> Jul <span class="hljs-number">10</span> <span class="hljs-number">00</span>:<span class="hljs-number">16</span> known_hosts<br><br>[root@node1 .ssh]<span class="hljs-comment"># ssh-keygen -p</span><br>Enter file <span class="hljs-keyword">in</span> which the key <span class="hljs-keyword">is</span> (<span class="hljs-regexp">/root/</span>.ssh/id_rsa): <br>Enter <span class="hljs-keyword">new</span> passphrase (empty <span class="hljs-keyword">for</span> <span class="hljs-literal">no</span> passphrase):                   <span class="hljs-regexp">//</span>输入要设置的私钥密码<br>Enter same passphrase again: <br>Your identification has been saved <span class="hljs-keyword">with</span> the <span class="hljs-keyword">new</span> passphrase.<br></code></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">root@node1 .ssh</span>]<span class="hljs-meta"># ssh 192.168.23.102</span><br>Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">&#x27;/root/.ssh/id_rsa&#x27;</span>: <br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">09</span>:<span class="hljs-number">12</span>:<span class="hljs-number">46</span> <span class="hljs-number">2022</span> <span class="hljs-keyword">from</span> <span class="hljs-number">192.168</span><span class="hljs-number">.23</span><span class="hljs-number">.101</span><br>[<span class="hljs-meta">root@node2 ~</span>]<span class="hljs-meta"># ssh 192.168.23.104</span><br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">12</span>:<span class="hljs-number">28</span>:<span class="hljs-number">17</span> <span class="hljs-number">2022</span> <span class="hljs-keyword">from</span> <span class="hljs-number">192.168</span><span class="hljs-number">.23</span><span class="hljs-number">.102</span><br>[<span class="hljs-meta">root@node4 ~</span>]<span class="hljs-meta"># exit</span><br>logout<br>Connection to <span class="hljs-number">192.168</span><span class="hljs-number">.23</span><span class="hljs-number">.104</span> closed.<br>[<span class="hljs-meta">root@node2 ~</span>]<span class="hljs-meta"># ssh 192.168.23.106</span><br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">12</span>:<span class="hljs-number">28</span>:<span class="hljs-number">38</span> <span class="hljs-number">2022</span> <span class="hljs-keyword">from</span> <span class="hljs-number">192.168</span><span class="hljs-number">.23</span><span class="hljs-number">.105</span><br>[<span class="hljs-meta">root@node6 ~</span>]<span class="hljs-meta"># exit</span><br>logout<br>Connection to <span class="hljs-number">192.168</span><span class="hljs-number">.23</span><span class="hljs-number">.106</span> closed.<br>[<span class="hljs-meta">root@node2 ~</span>]<span class="hljs-meta"># exit</span><br>logout<br>Connection to <span class="hljs-number">192.168</span><span class="hljs-number">.23</span><span class="hljs-number">.102</span> closed.<br>You have <span class="hljs-keyword">new</span> mail <span class="hljs-keyword">in</span> /<span class="hljs-keyword">var</span>/spool/mail/root<br>[<span class="hljs-meta">root@node1 .ssh</span>]<span class="hljs-meta"># ssh 192.168.23.105</span><br>Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">&#x27;/root/.ssh/id_rsa&#x27;</span>:                <span class="hljs-comment">//此时，仍需要输入私钥密码</span><br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">12</span>:<span class="hljs-number">28</span>:<span class="hljs-number">22</span> <span class="hljs-number">2022</span> <span class="hljs-keyword">from</span> <span class="hljs-number">192.168</span><span class="hljs-number">.23</span><span class="hljs-number">.102</span><br>[<span class="hljs-meta">root@node5 ~</span>]<span class="hljs-meta"># </span><br></code></pre></td></tr></table></figure><p>是每个节点上都要做私钥加密吗？目前测试，只在node1上做了私钥加密，其它节点间还是免密登录。</p><p>代理：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 ~]<span class="hljs-comment"># ssh-agent bash</span><br>[root@node1 ~]<span class="hljs-comment"># ssh-add</span><br>Enter passphrase <span class="hljs-keyword">for</span> <span class="hljs-regexp">/root/</span>.ssh/id_rsa: <br>Identity added: <span class="hljs-regexp">/root/</span>.ssh<span class="hljs-regexp">/id_rsa (/</span>root<span class="hljs-regexp">/.ssh/i</span>d_rsa)<br></code></pre></td></tr></table></figure><p>启动代理之后的使用</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 ~]<span class="hljs-comment"># ssh 192.168.23.102</span><br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">12</span>:<span class="hljs-number">37</span>:<span class="hljs-number">33</span> <span class="hljs-number">2022</span> from <span class="hljs-number">192.168</span>.<span class="hljs-number">23.101</span><br>[root@node2 ~]<span class="hljs-comment"># exit</span><br>logout<br>Connection to <span class="hljs-number">192.168</span>.<span class="hljs-number">23.102</span> closed.<br>You have new mail <span class="hljs-keyword">in</span> <span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/mail/</span>root<br>[root@node1 ~]<span class="hljs-comment"># ssh 192.168.23.104</span><br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">12</span>:<span class="hljs-number">44</span>:<span class="hljs-number">41</span> <span class="hljs-number">2022</span> from <span class="hljs-number">192.168</span>.<span class="hljs-number">23.103</span><br>[root@node4 ~]<span class="hljs-comment"># exit</span><br>logout<br>Connection to <span class="hljs-number">192.168</span>.<span class="hljs-number">23.104</span> closed.<br>[root@node1 ~]<span class="hljs-comment"># ssh 192.168.23.106</span><br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">12</span>:<span class="hljs-number">44</span>:<span class="hljs-number">08</span> <span class="hljs-number">2022</span> from <span class="hljs-number">192.168</span>.<span class="hljs-number">23.104</span><br>[root@node6 ~]<span class="hljs-comment"># exit</span><br>logout<br>Connection to <span class="hljs-number">192.168</span>.<span class="hljs-number">23.106</span> closed.<br>[root@node1 ~]<span class="hljs-comment"># exit</span><br><span class="hljs-keyword">exit</span><br>You have new mail <span class="hljs-keyword">in</span> <span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/mail/</span>root<br>[root@node1 ~]<span class="hljs-comment"># ssh 192.168.23.102                   </span><br>Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">&#x27;/root/.ssh/id_rsa&#x27;</span>:                   <span class="hljs-regexp">//</span>登出之后，再次ssh时，需要输入私钥<br>Last login: Sat Jul  <span class="hljs-number">9</span> <span class="hljs-number">12</span>:<span class="hljs-number">48</span>:<span class="hljs-number">55</span> <span class="hljs-number">2022</span> from <span class="hljs-number">192.168</span>.<span class="hljs-number">23.101</span><br>[root@node2 ~]<span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>批量管理服务器</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>i6000</title>
    <link href="/2022/07/09/i6000/"/>
    <url>/2022/07/09/i6000/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><span id="more"></span><h2 id="批量部署平台包—-gt-逐渐形成一键部署的脚本"><a href="#批量部署平台包—-gt-逐渐形成一键部署的脚本" class="headerlink" title="批量部署平台包—&gt;逐渐形成一键部署的脚本"></a>批量部署平台包—&gt;逐渐形成一键部署的脚本</h2><h3 id="获取当前目录下的tar包列表文件："><a href="#获取当前目录下的tar包列表文件：" class="headerlink" title="获取当前目录下的tar包列表文件："></a>获取当前目录下的tar包列表文件：</h3><figure class="highlight tap"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><pre><code class="hljs tap">[root@mysql test]<span class="hljs-comment"># ll *.tar|awk -F &quot; &quot; &#x27;&#123;print$9&#125;&#x27; &gt; tar_name.txt</span><br>[root@mysql test]<span class="hljs-comment"># ll</span><br>total 296756<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root       <span class="hljs-number"> 22 </span>Apr<span class="hljs-number"> 21 </span>14:39 backup<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root        <span class="hljs-number"> 5 </span>Apr<span class="hljs-number"> 21 </span>14:41 file1<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root        <span class="hljs-number"> 0 </span>Apr<span class="hljs-number"> 21 </span>14:37 file12<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root        <span class="hljs-number"> 5 </span>Apr<span class="hljs-number"> 21 </span>14:39 file1.orig<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root       <span class="hljs-number"> 44 </span>Apr<span class="hljs-number"> 21 </span>16:27 file2<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 303847936 </span>Jul <span class="hljs-number"> 8 </span>17:44 i6000-angular-front_2.0.26.20220424163738.tar<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root      <span class="hljs-number"> 233 </span>Jul <span class="hljs-number"> 8 </span>17:36 i6000-angular-front-svc.yml<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root     <span class="hljs-number"> 1285 </span>Jul <span class="hljs-number"> 8 </span>17:36 i6000-angular-front.yml<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root       <span class="hljs-number"> 46 </span>Jul<span class="hljs-number"> 21 </span>13:02 tar_name.txt<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root        <span class="hljs-number"> 0 </span>Jun<span class="hljs-number"> 16 </span>09:50 test1.sh<br>[root@mysql test]<span class="hljs-comment"># cat tar_name.txt </span><br>i6000-angular-front_2.0.26.20220424163738.tar<br></code></pre></td></tr></table></figure><p>dir /b /s  *.tar &gt;&gt; tar.txt</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@mysql</span> test]# cat pkg_name-all.txt <br><span class="hljs-type">i6000</span>-api-manage_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609092606</span>.tar<br><span class="hljs-type">i6000</span>-cmdb-access_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220616105828</span>.tar<br><span class="hljs-type">i6000</span>-cmdb-automatic_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609100048</span>.tar<br><span class="hljs-type">i6000</span>-cmdb-column-pair-config_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609100554</span>.tar<br><span class="hljs-type">i6000</span>-cmdb-data-access_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220613105949</span>.tar<br><span class="hljs-type">i6000</span>-cmdb-front_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220616111529</span>.tar<br><span class="hljs-type">i6000</span>-cmdb-model_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220616111200</span>.tar<br><span class="hljs-type">i6000</span>-cmdb-read_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220615152514</span>.tar<br><span class="hljs-type">i6000</span>-cmdb-write_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609095537</span>.tar<br><span class="hljs-type">i6000</span>-cmdb-sync-task_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220616090831</span>.tar<br>nms-agent-ms_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220608092333</span>.tar<br>nms-agent-ui_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220602102110</span>.tar<br><span class="hljs-type">i6000</span>-cicd_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609164721</span>.tar<br><span class="hljs-type">i6000</span>-flow-api_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.202206161508</span>.tar<br><span class="hljs-type">i6000</span>-flow-main_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.202206091705</span>.tar<br>pi<span class="hljs-number">6000</span>-audit-web_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.202206101605</span>.tar<br>pi<span class="hljs-number">6000</span>-bpm-web_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.202206101410</span>.tar<br>pi<span class="hljs-number">6000</span>-mdl-web_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.202206101605</span>.tar<br>pi<span class="hljs-number">6000</span>-ua-sso_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.202206101410</span>.tar<br>pi<span class="hljs-number">6000</span>-ua-web_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.202206101410</span>.tar<br>pi<span class="hljs-number">6000</span>-uds-web_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.202206101410</span>.tar<br><span class="hljs-type">i6000</span>-job-main_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609084723</span>.tar<br><span class="hljs-type">i6000</span>-log-backend_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220616145050</span>.tar<br><span class="hljs-type">i6000</span>-log-reverse_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220525105559</span>.tar<br><span class="hljs-type">i6000</span>-mobile-app_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220610155408</span>.tar<br>mip-admin_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220607195315</span>.tar<br>mip-analyse_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220607195439</span>.tar<br>mip-gateway_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220620193300</span>.tar<br>mip-manage-user_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220607195442</span>.tar<br>mip-publish_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220607195559</span>.tar<br><span class="hljs-type">i6000</span>-alert-ms_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220608141351</span>.tar<br><span class="hljs-type">i6000</span>-alert-ui_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220516105029</span>.tar<br><span class="hljs-type">i6000</span>-collect-ms_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220608142456</span>.tar<br><span class="hljs-type">i6000</span>-collect-ui_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220428191517</span>.tar<br><span class="hljs-type">i6000</span>-kpi-search_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609092512</span>.tar<br><span class="hljs-type">i6000</span>-kpicalc_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609091447</span>.tar<br><span class="hljs-type">i6000</span>-monitor-public-ms_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220620085758</span>.tar<br><span class="hljs-type">i6000</span>-angular-front_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220424163738</span>.tar<br><span class="hljs-type">i6000</span>-cascade_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220608143922</span>.tar<br><span class="hljs-type">i6000</span>-public-config_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220606143439</span>.tar<br><span class="hljs-type">i6000</span>-public-portal_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220614153752</span>.tar<br><span class="hljs-type">i6000</span>-task-admin_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220606101313</span>.tar<br>pi<span class="hljs-number">6000</span>-gateway<span class="hljs-number">2</span>_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220608141200</span>.tar<br><span class="hljs-type">i6000</span>-safe-access_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220621135612</span>.tar<br><span class="hljs-type">i6000</span>-scene-main_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609084708</span>.tar<br><span class="hljs-type">i6000</span>-show-graphic_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220606</span>.tar<br><span class="hljs-type">i6000</span>-store_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609091608</span>.tar<br><span class="hljs-type">i6000</span>-tool-main_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609085928</span>.tar<br><span class="hljs-type">i6000</span>-tool-monitor_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609085958</span>.tar<br><span class="hljs-type">i6000</span>-tool-operator_<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220609090028</span>.tar<br></code></pre></td></tr></table></figure><h3 id="定义部署包相关的变量："><a href="#定义部署包相关的变量：" class="headerlink" title="定义部署包相关的变量："></a>定义部署包相关的变量：</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dart">变量<span class="hljs-number">1</span>、pkg_version（部署包版本）<br>[root<span class="hljs-meta">@mysql</span> test]# pkg_version=`cat tar_name.txt |awk -F <span class="hljs-string">&quot;_&quot;</span> <span class="hljs-string">&#x27;&#123;print<span class="hljs-subst">$2</span>&#125;&#x27;</span>|awk -v FS=<span class="hljs-string">&#x27;.&#x27;</span>  <span class="hljs-string">&#x27;&#123;print<span class="hljs-subst">$1FS</span><span class="hljs-subst">$2FS</span><span class="hljs-subst">$3FS</span><span class="hljs-subst">$4</span>&#125;&#x27;</span>`<br>[root<span class="hljs-meta">@mysql</span> test]# echo $pkg_version<br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220424163738</span><br><br>[root<span class="hljs-meta">@mysql</span> test]# echo $pkg_version &gt; pkg_version.txt<br>[root<span class="hljs-meta">@mysql</span> test]# cat pkg_version.txt <br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220424163738</span><br></code></pre></td></tr></table></figure><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs dart">[root<span class="hljs-meta">@mysql</span> test]# cat pkg_name-all.txt |awk -F <span class="hljs-string">&quot;_&quot;</span> <span class="hljs-string">&#x27;&#123;print<span class="hljs-subst">$2</span>&#125;&#x27;</span>|awk -v FS=<span class="hljs-string">&#x27;.&#x27;</span>  <span class="hljs-string">&#x27;&#123;print<span class="hljs-subst">$1FS</span><span class="hljs-subst">$2FS</span><span class="hljs-subst">$3FS</span><span class="hljs-subst">$4</span>&#125;&#x27;</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609092606</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220616105828</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609100048</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609100554</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220613105949</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220616111529</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220616111200</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220615152514</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609095537</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220616090831</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220608092333</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220602102110</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609164721</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.202206161508</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.202206091705</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.202206101605</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.202206101410</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.202206101605</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.202206101410</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.202206101410</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.202206101410</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609084723</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220616145050</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220525105559</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220610155408</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220607195315</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220607195439</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220620193300</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220607195442</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220607195559</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220608141351</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220516105029</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220608142456</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220428191517</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609092512</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609091447</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220620085758</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220424163738</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220608143922</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220606143439</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220614153752</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220606101313</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220608141200</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220621135612</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609084708</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220606</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609091608</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609085928</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609085958</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220609090028</span><br><br></code></pre></td></tr></table></figure><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs autoit">变量<span class="hljs-number">2</span>、pkg_name（部署包名称）：<br>[root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># pkg_name=`cat tar_name.txt|awk -F <span class="hljs-string">&quot;_&quot;</span> <span class="hljs-string">&#x27;&#123;print$1&#125;&#x27;</span>`</span><br>[root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># echo $pkg_name</span><br>i6000-angular-front<br><br>[root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># echo $pkg_name &gt; pkg_name.txt</span><br>[root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># cat pkg_name.txt </span><br>i6000-angular-front<br></code></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@mysql</span> test]# cat pkg_name-all.txt|awk -F <span class="hljs-string">&quot;_&quot;</span> &#x27;&#123;print$<span class="hljs-number">1</span>&#125;&#x27;<br><span class="hljs-type">i6000</span>-api-manage<br><span class="hljs-type">i6000</span>-cmdb-access<br><span class="hljs-type">i6000</span>-cmdb-automatic<br><span class="hljs-type">i6000</span>-cmdb-column-pair-config<br><span class="hljs-type">i6000</span>-cmdb-data-access<br><span class="hljs-type">i6000</span>-cmdb-front<br><span class="hljs-type">i6000</span>-cmdb-model<br><span class="hljs-type">i6000</span>-cmdb-read<br><span class="hljs-type">i6000</span>-cmdb-write<br><span class="hljs-type">i6000</span>-cmdb-sync-task<br>nms-agent-ms<br>nms-agent-ui<br><span class="hljs-type">i6000</span>-cicd<br><span class="hljs-type">i6000</span>-flow-api<br><span class="hljs-type">i6000</span>-flow-main<br>pi<span class="hljs-number">6000</span>-audit-web<br>pi<span class="hljs-number">6000</span>-bpm-web<br>pi<span class="hljs-number">6000</span>-mdl-web<br>pi<span class="hljs-number">6000</span>-ua-sso<br>pi<span class="hljs-number">6000</span>-ua-web<br>pi<span class="hljs-number">6000</span>-uds-web<br><span class="hljs-type">i6000</span>-job-main<br><span class="hljs-type">i6000</span>-log-backend<br><span class="hljs-type">i6000</span>-log-reverse<br><span class="hljs-type">i6000</span>-mobile-app<br>mip-admin<br>mip-analyse<br>mip-gateway<br>mip-manage-user<br>mip-publish<br><span class="hljs-type">i6000</span>-alert-ms<br><span class="hljs-type">i6000</span>-alert-ui<br><span class="hljs-type">i6000</span>-collect-ms<br><span class="hljs-type">i6000</span>-collect-ui<br><span class="hljs-type">i6000</span>-kpi-search<br><span class="hljs-type">i6000</span>-kpicalc<br><span class="hljs-type">i6000</span>-monitor-public-ms<br><span class="hljs-type">i6000</span>-angular-front<br><span class="hljs-type">i6000</span>-cascade<br><span class="hljs-type">i6000</span>-public-config<br><span class="hljs-type">i6000</span>-public-portal<br><span class="hljs-type">i6000</span>-task-admin<br>pi<span class="hljs-number">6000</span>-gateway<span class="hljs-number">2</span><br><span class="hljs-type">i6000</span>-safe-access<br><span class="hljs-type">i6000</span>-scene-main<br><span class="hljs-type">i6000</span>-show-graphic<br><span class="hljs-type">i6000</span>-<span class="hljs-keyword">store</span><br><span class="hljs-type">i6000</span>-tool-main<br><span class="hljs-type">i6000</span>-tool-monitor<br><span class="hljs-type">i6000</span>-tool-operator<br></code></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@mysql</span> test]# pkg_name<span class="hljs-operator">=</span>`cat pkg_name-all.txt|awk -F <span class="hljs-string">&quot;_&quot;</span> &#x27;&#123;print$<span class="hljs-number">1</span>&#125;&#x27;`<br>[root<span class="hljs-title">@mysql</span> test]# echo $pkg_name<br><span class="hljs-type">i6000</span>-api-manage <span class="hljs-type">i6000</span>-cmdb-access <span class="hljs-type">i6000</span>-cmdb-automatic <span class="hljs-type">i6000</span>-cmdb-column-pair-config <span class="hljs-type">i6000</span>-cmdb-data-access <span class="hljs-type">i6000</span>-cmdb-front <span class="hljs-type">i6000</span>-cmdb-model <span class="hljs-type">i6000</span>-cmdb-read <span class="hljs-type">i6000</span>-cmdb-write <span class="hljs-type">i6000</span>-cmdb-sync-task nms-agent-ms nms-agent-ui <span class="hljs-type">i6000</span>-cicd <span class="hljs-type">i6000</span>-flow-api <span class="hljs-type">i6000</span>-flow-main pi<span class="hljs-number">6000</span>-audit-web pi<span class="hljs-number">6000</span>-bpm-web pi<span class="hljs-number">6000</span>-mdl-web pi<span class="hljs-number">6000</span>-ua-sso pi<span class="hljs-number">6000</span>-ua-web pi<span class="hljs-number">6000</span>-uds-web <span class="hljs-type">i6000</span>-job-main <span class="hljs-type">i6000</span>-log-backend <span class="hljs-type">i6000</span>-log-reverse <span class="hljs-type">i6000</span>-mobile-app mip-admin mip-analyse mip-gateway mip-manage-user mip-publish <span class="hljs-type">i6000</span>-alert-ms <span class="hljs-type">i6000</span>-alert-ui <span class="hljs-type">i6000</span>-collect-ms <span class="hljs-type">i6000</span>-collect-ui <span class="hljs-type">i6000</span>-kpi-search <span class="hljs-type">i6000</span>-kpicalc <span class="hljs-type">i6000</span>-monitor-public-ms <span class="hljs-type">i6000</span>-angular-front <span class="hljs-type">i6000</span>-cascade <span class="hljs-type">i6000</span>-public-config <span class="hljs-type">i6000</span>-public-portal <span class="hljs-type">i6000</span>-task-admin pi<span class="hljs-number">6000</span>-gateway<span class="hljs-number">2</span> <span class="hljs-type">i6000</span>-safe-access <span class="hljs-type">i6000</span>-scene-main <span class="hljs-type">i6000</span>-show-graphic <span class="hljs-type">i6000</span>-<span class="hljs-keyword">store</span> <span class="hljs-type">i6000</span>-tool-main <span class="hljs-type">i6000</span>-tool-monitor <span class="hljs-type">i6000</span>-tool-operator<br><br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css">待整理命令：<br>docker load -<span class="hljs-selector-tag">i</span>  将tar_name<span class="hljs-selector-class">.txt</span>中的内容作为数组变量一一输出；<br><br><br></code></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@mysql</span> test]# docker images|grep $pkg_name<br>registry.nrxt.com/<span class="hljs-type">i6000</span>/<span class="hljs-type">i6000</span>-public/<span class="hljs-type">i6000</span>-angular-front     <span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220424163738</span>   <span class="hljs-number">5</span><span class="hljs-keyword">c</span><span class="hljs-number">178</span>accd<span class="hljs-number">6</span>df   <span class="hljs-number">2</span> months ago   <span class="hljs-number">294</span>MB<br>cr.registry.res.sgmc.sgcc.com.cn/<span class="hljs-type">i6000</span>/<span class="hljs-type">i6000</span>-angular-front   <span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220424163738</span>   <span class="hljs-number">5</span><span class="hljs-keyword">c</span><span class="hljs-number">178</span>accd<span class="hljs-number">6</span>df   <span class="hljs-number">2</span> months ago   <span class="hljs-number">294</span>MB<br></code></pre></td></tr></table></figure><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs autoit">变量<span class="hljs-number">3</span>、images_ID（镜像ID）：<br>root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># docker images|grep $pkg_name</span><br>registry.nrxt.com/i6000/i6000-public/i6000-angular-front   <span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220424163738</span>   <span class="hljs-number">5</span>c178accd6df   <span class="hljs-number">2</span> months ago   <span class="hljs-number">294</span>MB<br><br>[root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># docker images|grep $pkg_name|awk -F <span class="hljs-string">&quot; &quot;</span> <span class="hljs-string">&#x27;&#123;print$2&#125;&#x27;</span></span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220424163738</span><br><br>[root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># images_ID=`docker images|grep $pkg_name|awk -F <span class="hljs-string">&quot; &quot;</span> <span class="hljs-string">&#x27;&#123;print$2&#125;&#x27;</span>`</span><br>[root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># echo $images_ID</span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220424163738</span><br><br>[root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># echo $images_ID &gt;images_ID.txt</span><br>[root<span class="hljs-symbol">@mysql</span> test]<span class="hljs-meta"># cat images_ID.txt </span><br><span class="hljs-number">2.0</span><span class="hljs-number">.26</span><span class="hljs-number">.20220424163738</span><br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs vim">变量<span class="hljs-number">4</span>、registry_Address（镜像仓库地址）：<br>[root@mysql test]# sgmc=<span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/i6000/<br>[root@mysql test]# registry_Address=$sgmc:kg_name:$pkg_version<br>[root@mysql test]# <span class="hljs-keyword">echo</span> $registry_Address<br><span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/i6000/:kg_name:<span class="hljs-number">2.0</span>.<span class="hljs-number">26.20220424163738</span><br>[root@mysql test]# registry_Address=$sgmc$pkg_name:$pkg_version<br>[root@mysql test]# <span class="hljs-keyword">echo</span> $registry_Address<br><span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/i6000/i6000-angular-fron<span class="hljs-variable">t:2</span>.<span class="hljs-number">0.26</span>.<span class="hljs-number">20220424163738</span><br><br>[root@mysql test]# <span class="hljs-keyword">echo</span> $registry_Address &gt; registry_Address.txt<br>[root@mysql test]# <span class="hljs-keyword">cat</span> registry_Address.txt<br><span class="hljs-keyword">cr</span>.registry.<span class="hljs-keyword">res</span>.sgmc.sgcc.<span class="hljs-keyword">com</span>.<span class="hljs-keyword">cn</span>/i6000/i6000-angular-fron<span class="hljs-variable">t:2</span>.<span class="hljs-number">0.26</span>.<span class="hljs-number">20220424163738</span><br><br></code></pre></td></tr></table></figure><p>打标签：</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@mysql test]# docker tag $images_ID $registry_Address<br><span class="hljs-keyword">Error </span>response from daemon: No such image: 2.0.26.20220424163738:latest<br><br>暂未成功，可利用之前生成的images_ID.txt和registry_Address.txt，手工批量整理成打标签和推送镜像的命令。<br></code></pre></td></tr></table></figure><p>docker push $registry_Address</p><p>===================================================</p><h2 id="利用expect实现ssh-key的批量部署"><a href="#利用expect实现ssh-key的批量部署" class="headerlink" title="利用expect实现ssh key的批量部署"></a>利用expect实现ssh key的批量部署</h2><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs perl">[root@node1 test]<span class="hljs-comment"># cat ssh_push_kye_expect.sh </span><br><span class="hljs-comment">#!/bin/bash</span><br>COLOR=<span class="hljs-string">&quot;echo -e \E[1;32m&quot;</span><br>END=<span class="hljs-string">&quot;\E[0m&quot;</span><br>PASSWORD=<span class="hljs-string">&quot;New_4&amp;5*oA&quot;</span><br>IPLIST=<span class="hljs-string">&quot;</span><br><span class="hljs-string">192.168.23.102</span><br><span class="hljs-string">192.168.23.103</span><br><span class="hljs-string">192.168.23.104</span><br><span class="hljs-string">192.168.23.105</span><br><span class="hljs-string">192.168.23.106</span><br><span class="hljs-string">&quot;</span><br><br>[ ! -f ~<span class="hljs-regexp">/.ssh/id</span>_rsa ] &amp;&amp; ssh-keygen -P <span class="hljs-string">&quot;&quot;</span> -f ~<span class="hljs-regexp">/.ssh/id</span>_rsa &amp;&gt;<span class="hljs-regexp">/dev/null</span><br>rpm -<span class="hljs-keyword">q</span> expect &amp;&gt; <span class="hljs-regexp">/dev/null</span> || yum -<span class="hljs-keyword">y</span> -<span class="hljs-keyword">q</span> install expect &amp;&gt;<span class="hljs-regexp">/dev/null</span><br><span class="hljs-keyword">for</span> ip in $IPLIST ;<span class="hljs-keyword">do</span><br>&#123;    <br>expect &lt;&lt;EOF<br>set timeout <span class="hljs-number">60</span><br>spawn ssh-copy-id $ip<br>expect &#123;<br>        <span class="hljs-string">&quot;yes/no&quot;</span> &#123; <span class="hljs-keyword">send</span> <span class="hljs-string">&quot;yes\r&quot;</span>;exp_continue &#125;<br>        <span class="hljs-string">&quot;password:&quot;</span> &#123; <span class="hljs-keyword">send</span> <span class="hljs-string">&quot;$PASSWORD\r&quot;</span> &#125;<br>&#125;<br>expect <span class="hljs-keyword">eof</span><br>EOF<br>$COLOR<span class="hljs-string">&quot;$ip is ready&quot;</span>$END<br>&#125;&amp;<br>done<br><span class="hljs-keyword">wait</span><br>$COLOR<span class="hljs-string">&quot;Push ssh key is finished!&quot;</span>$END<br></code></pre></td></tr></table></figure><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[root@node1 test]</span># cat hosts.txt <br><span class="hljs-number">192.168.23.102</span><br><span class="hljs-number">192.168.23.103</span><br><span class="hljs-number">192.168.23.104</span><br><span class="hljs-number">192.168.23.105</span><br><span class="hljs-number">192.168.23.106</span><br></code></pre></td></tr></table></figure><p>远程批量执行某一条命令：</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[root@node1 test]</span># for i in `cat hosts.txt`;do ssh $i hostname -I;done<br><span class="hljs-number">192.168.23.102</span> <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">23</span>.<span class="hljs-number">4</span> <br><span class="hljs-number">192.168.23.103</span> <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">23</span>.<span class="hljs-number">5</span> <br><span class="hljs-number">192.168.23.104</span> <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">23</span>.<span class="hljs-number">6</span> <br><span class="hljs-number">192.168.23.105</span> <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">23</span>.<span class="hljs-number">7</span> <br><span class="hljs-number">192.168.23.106</span> <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">23</span>.<span class="hljs-number">8</span> <br></code></pre></td></tr></table></figure><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 test]<span class="hljs-comment"># for i in `cat hosts.txt`;do ssh $i free -m;done</span><br>              total        used        free      shared  buff/cache   available<br>Mem:           <span class="hljs-number"> 972 </span>       <span class="hljs-number"> 104 </span>       <span class="hljs-number"> 693 </span>         <span class="hljs-number"> 7 </span>       <span class="hljs-number"> 174 </span>        693<br>Swap:         <span class="hljs-number"> 2047 </span>         <span class="hljs-number"> 0 </span>       2047<br>              total        used        free      shared  buff/cache   available<br>Mem:           <span class="hljs-number"> 972 </span>        <span class="hljs-number"> 88 </span>       <span class="hljs-number"> 765 </span>         <span class="hljs-number"> 7 </span>       <span class="hljs-number"> 118 </span>        739<br>Swap:         <span class="hljs-number"> 2047 </span>         <span class="hljs-number"> 0 </span>       2047<br>              total        used        free      shared  buff/cache   available<br>Mem:           <span class="hljs-number"> 972 </span>        <span class="hljs-number"> 86 </span>       <span class="hljs-number"> 766 </span>         <span class="hljs-number"> 7 </span>       <span class="hljs-number"> 119 </span>        740<br>Swap:         <span class="hljs-number"> 2047 </span>         <span class="hljs-number"> 0 </span>       2047<br>              total        used        free      shared  buff/cache   available<br>Mem:           <span class="hljs-number"> 972 </span>        <span class="hljs-number"> 93 </span>       <span class="hljs-number"> 759 </span>         <span class="hljs-number"> 7 </span>       <span class="hljs-number"> 119 </span>        734<br>Swap:         <span class="hljs-number"> 2047 </span>         <span class="hljs-number"> 0 </span>       2047<br>              total        used        free      shared  buff/cache   available<br>Mem:           <span class="hljs-number"> 972 </span>        <span class="hljs-number"> 93 </span>       <span class="hljs-number"> 760 </span>         <span class="hljs-number"> 7 </span>       <span class="hljs-number"> 118 </span>        734<br>Swap:         <span class="hljs-number"> 2047 </span>         <span class="hljs-number"> 0 </span>       2047<br></code></pre></td></tr></table></figure><p>拷贝部署包到其它采集服务器：</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@node1 <span class="hljs-keyword">test</span>]# <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `<span class="hljs-keyword">cat</span> hosts.txt`;<span class="hljs-keyword">do</span> scp ssh_push_kye_expect.<span class="hljs-keyword">sh</span> <span class="hljs-variable">$i</span>:/<span class="hljs-keyword">test</span>;done<br>ssh_push_kye_expect.<span class="hljs-keyword">sh</span>                                                            100%  567   105.2KB/s   00:00    <br>ssh_push_kye_expect.<span class="hljs-keyword">sh</span>                                                            100%  567   192.7KB/s   00:00    <br>ssh_push_kye_expect.<span class="hljs-keyword">sh</span>                                                            100%  567   106.2KB/s   00:00    <br>ssh_push_kye_expect.<span class="hljs-keyword">sh</span>                                                            100%  567    91.9KB/s   00:00    <br>ssh_push_kye_expect.<span class="hljs-keyword">sh</span>                                                            100%  567    93.1KB/s   00:00    <br></code></pre></td></tr></table></figure><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[root@node1 test]</span># for i in `cat hosts.txt`;do scp ssh_push_kye_expect.sh $i:/test &amp;&amp; echo $i is copyed！;done<br>ssh_push_kye_expect.sh                                                                                                                       <span class="hljs-number">100</span>%  <span class="hljs-number">567</span>   <span class="hljs-number">185</span>.1KB/s   <span class="hljs-number">00</span>:<span class="hljs-number">00</span>    <br><span class="hljs-number">192.168.23.102</span> is copyed！<br>ssh_push_kye_expect.sh                                                                                                                       <span class="hljs-number">100</span>%  <span class="hljs-number">567</span>   <span class="hljs-number">164</span>.8KB/s   <span class="hljs-number">00</span>:<span class="hljs-number">00</span>    <br><span class="hljs-number">192.168.23.103</span> is copyed！<br>ssh_push_kye_expect.sh                                                                                                                       <span class="hljs-number">100</span>%  <span class="hljs-number">567</span>   <span class="hljs-number">291</span>.8KB/s   <span class="hljs-number">00</span>:<span class="hljs-number">00</span>    <br><span class="hljs-number">192.168.23.104</span> is copyed！<br>ssh_push_kye_expect.sh                                                                                                                       <span class="hljs-number">100</span>%  <span class="hljs-number">567</span>   <span class="hljs-number">239</span>.9KB/s   <span class="hljs-number">00</span>:<span class="hljs-number">00</span>    <br><span class="hljs-number">192.168.23.105</span> is copyed！<br>ssh_push_kye_expect.sh                                                                                                                       <span class="hljs-number">100</span>%  <span class="hljs-number">567</span>   <span class="hljs-number">154</span>.7KB/s   <span class="hljs-number">00</span>:<span class="hljs-number">00</span>    <br><span class="hljs-number">192.168.23.106</span> is copyed！<br></code></pre></td></tr></table></figure><h2 id="批量部署采集服务器："><a href="#批量部署采集服务器：" class="headerlink" title="批量部署采集服务器："></a>批量部署采集服务器：</h2><p> 利用expect实现ssh key的批量部署</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs perl">[root@node1 test]<span class="hljs-comment"># cat ssh_push_kye_expect.sh </span><br><span class="hljs-comment">#!/bin/bash</span><br>COLOR=<span class="hljs-string">&quot;echo -e \E[1;32m&quot;</span><br>END=<span class="hljs-string">&quot;\E[0m&quot;</span><br>PASSWORD=<span class="hljs-string">&quot;New_4&amp;5*oA&quot;</span><br>IPLIST=<span class="hljs-string">&quot;</span><br><span class="hljs-string">20.2.85.192</span><br><span class="hljs-string">20.2.85.193</span><br><span class="hljs-string">20.2.85.194</span><br><span class="hljs-string">20.2.85.195</span><br><span class="hljs-string">20.2.85.196</span><br><span class="hljs-string">20.2.85.197</span><br><span class="hljs-string">20.2.85.198</span><br><span class="hljs-string">20.2.85.199</span><br><span class="hljs-string">20.2.85.200</span><br><span class="hljs-string">20.2.85.201</span><br><span class="hljs-string">20.2.85.202</span><br><span class="hljs-string">20.2.85.203</span><br><span class="hljs-string">&quot;</span><br><br>[ ! -f ~<span class="hljs-regexp">/.ssh/id</span>_rsa ] &amp;&amp; ssh-keygen -P <span class="hljs-string">&quot;&quot;</span> -f ~<span class="hljs-regexp">/.ssh/id</span>_rsa &amp;&gt;<span class="hljs-regexp">/dev/null</span><br>rpm -<span class="hljs-keyword">q</span> expect &amp;&gt; <span class="hljs-regexp">/dev/null</span> || yum -<span class="hljs-keyword">y</span> -<span class="hljs-keyword">q</span> install expect &amp;&gt;<span class="hljs-regexp">/dev/null</span><br><span class="hljs-keyword">for</span> ip in $IPLIST ;<span class="hljs-keyword">do</span><br>&#123;    <br>expect &lt;&lt;EOF<br>set timeout <span class="hljs-number">60</span><br>spawn ssh-copy-id $ip<br>expect &#123;<br>        <span class="hljs-string">&quot;yes/no&quot;</span> &#123; <span class="hljs-keyword">send</span> <span class="hljs-string">&quot;yes\r&quot;</span>;exp_continue &#125;<br>        <span class="hljs-string">&quot;password:&quot;</span> &#123; <span class="hljs-keyword">send</span> <span class="hljs-string">&quot;$PASSWORD\r&quot;</span> &#125;<br>&#125;<br>expect <span class="hljs-keyword">eof</span><br>EOF<br>$COLOR<span class="hljs-string">&quot;$ip is ready&quot;</span>$END<br>&#125;&amp;<br>done<br><span class="hljs-keyword">wait</span><br>$COLOR<span class="hljs-string">&quot;Push ssh key is finished!&quot;</span>$END<br></code></pre></td></tr></table></figure><p>1、添加要部署的服务器地址</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"> cat hosts.txt <br><span class="hljs-number">20.2.85.192</span><br><span class="hljs-number">20.2.85.193</span><br><span class="hljs-number">20.2.85.194</span><br><span class="hljs-number">20.2.85.195</span><br><span class="hljs-number">20.2.85.196</span><br><span class="hljs-number">20.2.85.197</span><br><span class="hljs-number">20.2.85.198</span><br><span class="hljs-number">20.2.85.199</span><br><span class="hljs-number">20.2.85.200</span><br><span class="hljs-number">20.2.85.201</span><br><span class="hljs-number">20.2.85.202</span><br><span class="hljs-number">20.2.85.203</span><br></code></pre></td></tr></table></figure><p>2、拷贝部署包到各服务器</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `<span class="hljs-built_in">cat</span> hosts.txt`;<span class="hljs-keyword">do</span> scp -rp /home/nms/NmsInsideCollectServer <span class="hljs-variable">$i</span>:/home/nms/ &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span> is copyed！;<span class="hljs-keyword">done</span></span><br></code></pre></td></tr></table></figure><p>3、修改start.sh文件中个性配置</p><p>使用wincp，修改start.sh文件中的采集集群和节点。</p><p>4、启动nms服务：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `<span class="hljs-built_in">cat</span> hosts.txt`;<span class="hljs-keyword">do</span> ssh <span class="hljs-variable">$i</span> /home/nms/NmsInsideCollectServer/stat.sh;<span class="hljs-keyword">done</span></span><br></code></pre></td></tr></table></figure><p>==============</p><p>为防止泄露一台服务器的密码，而导致其它服务器也被暴漏。可对私钥进行加密，并且可以设置代理，每次登录，输入一次私钥密码，后期在登出之前再操作就不用输入私钥的秘密了。</p><p>其他人再次登录时，仍然是需要输入私钥的密码，才可以免密登录其他服务器，这样就提升了安全性。</p>]]></content>
    
    
    <categories>
      
      <category>检修</category>
      
    </categories>
    
    
    <tags>
      
      <tag>批量部署</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第五周作业-2022-7-5</title>
    <link href="/2022/07/05/%E7%AC%AC%E4%BA%94%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-7-5/"/>
    <url>/2022/07/05/%E7%AC%AC%E4%BA%94%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-7-5/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>：报全程班和单就业的小伙伴，本周建议学习内容：第十九天、第十六天、第二十天 、第二十一天、第二十二天。</p><span id="more"></span><p>请同学们完成作业后，将博客作业提交到此链接：<a href="https://www.wjx.top/vj/POHTQOH.aspx">https://www.wjx.top/vj/POHTQOH.aspx</a></p><h1 id="章节内容"><a href="#章节内容" class="headerlink" title="章节内容"></a>章节内容</h1><p>“第十九天：<br>时间同步及自动化部署<br>1、pam实现资源限制和google的MFA验证<br>2、时间同步服务和SELinux安全管理<br>3、自动化运维和光盘启动文件<br>4、系统的自动化安装应答文件制作<br>5、dhcp和tftp服务管理<br>6、基于PXE实现自动化的系统安装<br>7、cobbler实现系统自动化部署”<br>“第二十天：<br>域名系统 DNS服务<br>1、名称解析服务和DNS服务实现原理<br>2、dns服务基础配置实现互联网访问<br>3、实现正向解析dns服务<br>4、实现反向dns解析和从dns服务器<br>5、实现子域委派和转发查询<br>6、GSLB和CDN服务工作原理”<br>“第二十一天：<br>Linux防火墙<br>1、Linux防火墙介绍<br>2、iptables的基本用法<br>3、iptables的扩展模块用法<br>4、iptables的扩展模块用法<br>5、iptables的规则保存和自定义链<br>6、iptables实现网络防火墙<br>7、iptables实现NAT原理和实战”<br>“第二十二天<br> VPN服务<br>1、firewalld和最新技术nft实现防火墙功能<br>2、open-v-p-n介绍和环境准备<br>3、open-v-p-n实现CA证书<br>4、open-v-p-n服务和客户端实现<br>5、open-v-p-n高级管理功能<br>6、阿里云释放资源<br>7、数据库基础原理<br>8、关系型数据库理论”</p><h1 id="作业："><a href="#作业：" class="headerlink" title="作业："></a>作业：</h1><ol><li><p>搭建chrony服务完成多个主机的时间同步。</p><figure class="highlight tap"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></div></td><td class="code"><pre><code class="hljs tap"><span class="hljs-comment">#服务器端配置：</span><br>[root@node1 ~]<span class="hljs-comment"># cat /etc/chrony.conf |grep -v ^#</span><br>server 0.centos.pool.ntp.org iburst<br>server 1.centos.pool.ntp.org iburst<br>server 2.centos.pool.ntp.org iburst<br>server 3.centos.pool.ntp.org iburst<br>Server ntp.aliyun.com iburst<br>Server ntp1.aliyun.com iburst<br>Server ntp2.aliyun.com iburst<br><br>driftfile /var/lib/chrony/drift<br><br>makestep 1.0 3<br><br>rtcsync<br><br>allow 192.168.23.0/24               // 指定允许同步的网段<br><br>logdir /var/log/chrony<br>[root@node1 ~]<span class="hljs-comment"># systemctl restart chronyd</span><br>[root@node1 ~]<span class="hljs-comment"># systemctl satus chronyd</span><br>Unknown operation &#x27;satus&#x27;.<br>[root@node1 ~]<span class="hljs-comment"># date</span><br>Tue Jul<span class="hljs-number"> 12 </span>20:59:14 CST 2022<br><br><span class="hljs-comment">#服务启动后会打开端口123/udp</span><br>[root@node1 ~]<span class="hljs-comment"># ss -ntlu</span><br>Netid  State      Recv-Q Send-Q          Local Address:Port                         Peer Address:Port              <br>udp    UNCONN    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>                          *:46551                                   *:*                  <br>udp    UNCONN    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>                          *:68                                      *:*                  <br>udp    UNCONN    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>                          *:123                                     *:*                  <br>udp    UNCONN    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>                  127.0.0.1:323                                     *:*                  <br>udp    UNCONN    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>                        ::1:323                                    :::*                  <br>tcp    LISTEN    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 128 </span>                        *:22                                      *:*                  <br>tcp    LISTEN    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 100 </span>                127.0.0.1:25                                      *:*                  <br>tcp    LISTEN    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 128 </span>                       :::22                                     :::*                  <br>tcp    LISTEN    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 100 </span>                      ::1:25                                     :::*            <br>[root@node1 ~]<span class="hljs-comment"># chronyc</span><br>chrony version 3.2<br>Copyright (C) 1997-2003, 2007, 2009-2017 Richard P. Curnow and others<br>chrony comes with ABSOLUTELY NO WARRANTY.  This is free software, and<br>you are welcome to redistribute it under certain conditions.  See the<br>GNU General Public License version<span class="hljs-number"> 2 </span>for details.<br><br>chronyc&gt; clients<br>Hostname                      NTP   Drop Int IntL Last     Cmd   Drop Int  Last<br>===============================================================================<br>192.168.23.103                <span class="hljs-number"> 10 </span>    <span class="hljs-number"> 0 </span> <span class="hljs-number"> 6 </span>  -   <span class="hljs-number"> 46 </span>     <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>  -     -<br>192.168.23.102                 <span class="hljs-number"> 7 </span>    <span class="hljs-number"> 0 </span> <span class="hljs-number"> 6 </span>  -   <span class="hljs-number"> 15 </span>     <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>  -     -<br><br><span class="hljs-comment">#客户端配置</span><br>[root@node2 ~]<span class="hljs-comment"># grep -v ^# /etc/chrony.conf </span><br>server 192.168.23.101 iburst <br>driftfile /var/lib/chrony/drift<br>makestep 1.0 3<br>rtcsync<br>logdir /var/log/chrony<br>[root@node2 ~]<span class="hljs-comment"># systemctl restart chronyd</span><br>[root@node2 ~]<span class="hljs-comment"># chronyc sources -v</span><br>210 Number of sources = 1<br><br>  .-- Source mode  &#x27;^&#x27; = server, &#x27;=&#x27; = peer, &#x27;<span class="hljs-comment">#&#x27; = local clock.</span><br> / .- Source state &#x27;*&#x27; = current synced, &#x27;+&#x27; = combined , &#x27;-&#x27; = not combined,<br>| /   &#x27;?&#x27; = unreachable, &#x27;x&#x27; = time may be in error, &#x27;~&#x27; = time too variable.<br>||                                                 .- xxxx [ yyyy ] +/- zzzz<br>||      Reachability register (octal) -.           |  xxxx = adjusted offset,<br>||      Log2(Polling interval) --.      |          |  yyyy = measured offset,<br>||                                \     |          |  zzzz = estimated error.<br>||                                 |    |           \<br>MS Name/IP address         Stratum Poll Reach LastRx Last sample               <br>===============================================================================<br>^* 192.168.23.101               <span class="hljs-number"> 3 </span> <span class="hljs-number"> 6 </span>  <span class="hljs-number"> 17 </span>  <span class="hljs-number"> 28 </span>   +14us[  +11us] +/-   21ms               //为* 号时，表示跟服务器同步了<br>[root@node2 ~]<span class="hljs-comment"># date</span><br>Tue Jul<span class="hljs-number"> 12 </span>09:02:15 EDT 2022<br></code></pre></td></tr></table></figure><p>此时客户端的时间，显示不是24小时制</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">root@node1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># timedatectl </span><br>      <span class="hljs-attr">Local time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 21:45:07 </span><span class="hljs-string">CST</span><br>  <span class="hljs-attr">Universal time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:45:07 </span><span class="hljs-string">UTC</span><br>        <span class="hljs-attr">RTC time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:45:07</span><br>       <span class="hljs-attr">Time zone:</span> <span class="hljs-string">America/New_York</span> <span class="hljs-string">(CST,</span> <span class="hljs-string">+0800)</span><br>     <span class="hljs-attr">NTP enabled:</span> <span class="hljs-literal">yes</span><br><span class="hljs-attr">NTP synchronized:</span> <span class="hljs-literal">yes</span><br> <span class="hljs-attr">RTC in local TZ:</span> <span class="hljs-literal">no</span><br>      <span class="hljs-attr">DST active:</span> <span class="hljs-string">n/a</span><br><span class="hljs-string">You</span> <span class="hljs-string">have</span> <span class="hljs-string">new</span> <span class="hljs-string">mail</span> <span class="hljs-string">in</span> <span class="hljs-string">/var/spool/mail/root</span><br>[<span class="hljs-string">root@node1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># timedatectl set-timezone Asia/Shanghai</span><br><span class="hljs-string">You</span> <span class="hljs-string">have</span> <span class="hljs-string">new</span> <span class="hljs-string">mail</span> <span class="hljs-string">in</span> <span class="hljs-string">/var/spool/mail/root</span><br>[<span class="hljs-string">root@node1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># timedatectl </span><br>      <span class="hljs-attr">Local time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 21:47:17 </span><span class="hljs-string">CST</span><br>  <span class="hljs-attr">Universal time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:47:17 </span><span class="hljs-string">UTC</span><br>        <span class="hljs-attr">RTC time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:47:18</span><br>       <span class="hljs-attr">Time zone:</span> <span class="hljs-string">Asia/Shanghai</span> <span class="hljs-string">(CST,</span> <span class="hljs-string">+0800)</span><br>     <span class="hljs-attr">NTP enabled:</span> <span class="hljs-literal">yes</span><br><span class="hljs-attr">NTP synchronized:</span> <span class="hljs-literal">yes</span><br> <span class="hljs-attr">RTC in local TZ:</span> <span class="hljs-literal">no</span><br>      <span class="hljs-attr">DST active:</span> <span class="hljs-string">n/a</span><br>[<span class="hljs-string">root@node1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># </span><br>[<span class="hljs-string">root@node1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># timedatectl </span><br>      <span class="hljs-attr">Local time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 21:47:29 </span><span class="hljs-string">CST</span><br>  <span class="hljs-attr">Universal time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:47:29 </span><span class="hljs-string">UTC</span><br>        <span class="hljs-attr">RTC time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:47:29</span><br>       <span class="hljs-attr">Time zone:</span> <span class="hljs-string">Asia/Shanghai</span> <span class="hljs-string">(CST,</span> <span class="hljs-string">+0800)</span><br>     <span class="hljs-attr">NTP enabled:</span> <span class="hljs-literal">yes</span><br><span class="hljs-attr">NTP synchronized:</span> <span class="hljs-literal">yes</span><br> <span class="hljs-attr">RTC in local TZ:</span> <span class="hljs-literal">no</span><br>      <span class="hljs-attr">DST active:</span> <span class="hljs-string">n/a</span><br>[<span class="hljs-string">root@node1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># date</span><br><span class="hljs-string">Tue</span> <span class="hljs-string">Jul</span> <span class="hljs-number">12</span> <span class="hljs-number">21</span><span class="hljs-string">:47:33</span> <span class="hljs-string">CST</span> <span class="hljs-number">2022</span><br><br>[<span class="hljs-string">root@node2</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># timedatectl </span><br>      <span class="hljs-attr">Local time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 09:45:07 </span><span class="hljs-string">EDT</span><br>  <span class="hljs-attr">Universal time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:45:07 </span><span class="hljs-string">UTC</span><br>        <span class="hljs-attr">RTC time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:45:07</span><br>       <span class="hljs-attr">Time zone:</span> <span class="hljs-string">America/New_York</span> <span class="hljs-string">(EDT,</span> <span class="hljs-number">-0400</span><span class="hljs-string">)</span><br>     <span class="hljs-attr">NTP enabled:</span> <span class="hljs-literal">yes</span><br><span class="hljs-attr">NTP synchronized:</span> <span class="hljs-literal">yes</span><br> <span class="hljs-attr">RTC in local TZ:</span> <span class="hljs-literal">no</span><br>      <span class="hljs-attr">DST active:</span> <span class="hljs-literal">yes</span><br> <span class="hljs-attr">Last DST change:</span> <span class="hljs-string">DST</span> <span class="hljs-string">began</span> <span class="hljs-string">at</span><br>                  <span class="hljs-string">Sun</span> <span class="hljs-number">2022-03-13 01:59:59 </span><span class="hljs-string">EST</span><br>                  <span class="hljs-string">Sun</span> <span class="hljs-number">2022-03-13 03:00:00 </span><span class="hljs-string">EDT</span><br> <span class="hljs-attr">Next DST change:</span> <span class="hljs-string">DST</span> <span class="hljs-string">ends</span> <span class="hljs-string">(the</span> <span class="hljs-string">clock</span> <span class="hljs-string">jumps</span> <span class="hljs-string">one</span> <span class="hljs-string">hour</span> <span class="hljs-string">backwards)</span> <span class="hljs-string">at</span><br>                  <span class="hljs-string">Sun</span> <span class="hljs-number">2022-11-06 01:59:59 </span><span class="hljs-string">EDT</span><br>                  <span class="hljs-string">Sun</span> <span class="hljs-number">2022-11-06 01:00:00 </span><span class="hljs-string">EST</span><br>[<span class="hljs-string">root@node2</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># timedatectl set-timezone Asia/Shanghai         // 修改时区</span><br>[<span class="hljs-string">root@node2</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># timedatectl </span><br>      <span class="hljs-attr">Local time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 21:47:17 </span><span class="hljs-string">CST</span><br>  <span class="hljs-attr">Universal time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:47:17 </span><span class="hljs-string">UTC</span><br>        <span class="hljs-attr">RTC time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:47:18</span><br>       <span class="hljs-attr">Time zone:</span> <span class="hljs-string">Asia/Shanghai</span> <span class="hljs-string">(CST,</span> <span class="hljs-string">+0800)</span><br>     <span class="hljs-attr">NTP enabled:</span> <span class="hljs-literal">yes</span><br><span class="hljs-attr">NTP synchronized:</span> <span class="hljs-literal">yes</span><br> <span class="hljs-attr">RTC in local TZ:</span> <span class="hljs-literal">no</span><br>      <span class="hljs-attr">DST active:</span> <span class="hljs-string">n/a</span><br>[<span class="hljs-string">root@node2</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># </span><br>[<span class="hljs-string">root@node2</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># timedatectl </span><br>      <span class="hljs-attr">Local time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 21:47:29 </span><span class="hljs-string">CST</span><br>  <span class="hljs-attr">Universal time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:47:29 </span><span class="hljs-string">UTC</span><br>        <span class="hljs-attr">RTC time:</span> <span class="hljs-string">Tue</span> <span class="hljs-number">2022-07-12 13:47:29</span><br>       <span class="hljs-attr">Time zone:</span> <span class="hljs-string">Asia/Shanghai</span> <span class="hljs-string">(CST,</span> <span class="hljs-string">+0800)</span><br>     <span class="hljs-attr">NTP enabled:</span> <span class="hljs-literal">yes</span><br><span class="hljs-attr">NTP synchronized:</span> <span class="hljs-literal">yes</span><br> <span class="hljs-attr">RTC in local TZ:</span> <span class="hljs-literal">no</span><br>      <span class="hljs-attr">DST active:</span> <span class="hljs-string">n/a</span><br>[<span class="hljs-string">root@node2</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># date                                         // 修改时区后，变成了正确时间</span><br><span class="hljs-string">Tue</span> <span class="hljs-string">Jul</span> <span class="hljs-number">12</span> <span class="hljs-number">21</span><span class="hljs-string">:47:33</span> <span class="hljs-string">CST</span> <span class="hljs-number">2022</span><br></code></pre></td></tr></table></figure></li></ol><p>2、自制光盘，PXE, Cobbler完成自动安装系统</p><p>3、搭建配置主从DNS服务器，实现区域传送，并实现智能DNS。</p><p>4、配置iptables 打开常用端口加固linux。使用iptables DNAT完成暴露内网端口，使用SNAT,让内网可以上网。并抓包分析过程。 可以尝试firewalld实现iptables的结果。</p><p>5、脚本实现openvpn的一键安装，日常管理：加用户，吊销用户等。</p><p>6、有能力的，可以完成日常阿里云操作，购买ECS, 做快照，重装系统，购买SLB，mysql. 在阿里上基于SLB, mysql,完成部署LAMP。</p><p>7、总结数据库原理。</p>]]></content>
    
    
    <categories>
      
      <category>作业</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>三、导入mysql库</title>
    <link href="/2022/07/04/%E4%B8%89%E3%80%81%E5%AF%BC%E5%85%A5mysql%E5%BA%93/"/>
    <url>/2022/07/04/%E4%B8%89%E3%80%81%E5%AF%BC%E5%85%A5mysql%E5%BA%93/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><span id="more"></span><p><img src="image-20220704170146762.png" alt="image-20220704170146762"></p><p>1、新建数据库</p><p>新建以上数据库，智慧客服系统—-&gt;右键—-&gt;新建数据库</p><p><img src="image-20220704181304061.png" alt="image-20220704181304061"></p><p>字符集、排序规则，不用选、默认即可。</p><p>2、导入sql文件</p><p>在需要导入数据的数据库，双击打开，点右键，选择“运行sql文件”，选择要导入的数据库sql文件</p><p><img src="image-20220704181711577.png" alt="image-20220704181711577"></p><p><img src="image-20220704181635827.png" alt="image-20220704181635827"></p><p>导入成功后，重新打开数据库，会发现新建了数据库表，并且有了数据。</p><p><img src="image-20220704181915989.png" alt="image-20220704181915989"></p>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>二、dolphinscheduler-2022-7-1</title>
    <link href="/2022/07/04/%E4%BA%8C%E3%80%81dolphinscheduler-2022-7-1/"/>
    <url>/2022/07/04/%E4%BA%8C%E3%80%81dolphinscheduler-2022-7-1/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><span id="more"></span><h3 id="1-装docker-compose环境"><a href="#1-装docker-compose环境" class="headerlink" title="1. 装docker-compose环境"></a>1. 装docker-compose环境</h3><p>k8sworker-k8s dolphinscheduler   20.2.56.135</p><figure class="highlight awk"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><pre><code class="hljs awk">将docker-compose-Linux-x86_64上传到服务器，将文件转移至<span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span><br>mv docker-compose-Linux-x86_64 <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose<br><br>chmod <span class="hljs-number">755</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose<br><br>docker-compose -v  检查是否可以<br><br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@iZ9ur01cg80efuvuzubh7kZ tmp]# cp docker-compose <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span><br>[root@iZ9ur01cg80efuvuzubh7kZ tmp]# docker-compose -v<br>-bash: <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose: Permission denied<br>[root@iZ9ur01cg80efuvuzubh7kZ tmp]# chmod <span class="hljs-number">755</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose <br>[root@iZ9ur01cg80efuvuzubh7kZ tmp]# docker-compose -v<br></code></pre></td></tr></table></figure><h3 id="2-装-dolphinscheduler"><a href="#2-装-dolphinscheduler" class="headerlink" title="2. 装 dolphinscheduler"></a>2. 装 dolphinscheduler</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs gradle">把 dolphinscheduler-nj.tgz  包解压到<span class="hljs-regexp">/home/g</span>w/software<br>[root@iZ9ur01cg80efuvuzubh7kZ home]# mkdir -p <span class="hljs-regexp">/home/g</span>w/software<br>[root@iZ9ur01cg80efuvuzubh7kZ home]# tar -xf <span class="hljs-regexp">/tmp/</span>dolphinscheduler-nj.tgz -C <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span><br>[root@iZ9ur01cg80efuvuzubh7kZ home]# cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>dolphinscheduler/<br><br>vim config.env.sh  修改：<br><span class="hljs-number">1</span>. 将mysql修改成现场的<br><br> DATABASE_HOST=<span class="hljs-number">20.2</span>.<span class="hljs-number">56.145</span><br> DATABASE_PORT=<span class="hljs-number">13306</span><br> DATABASE_USERNAME=admin186<br> DATABASE_PASSWORD=NewMysql20220701<br><br><span class="hljs-number">2</span>. zk修改成现场的地址<br>ZOOKEEPER_QUORUM=<span class="hljs-number">20.2</span>.<span class="hljs-number">56.143</span>:<span class="hljs-number">2186</span>,<span class="hljs-number">20.2</span>.<span class="hljs-number">56.144</span>:<span class="hljs-number">2186</span>,<span class="hljs-number">20.2</span>.<span class="hljs-number">56.140</span>:<span class="hljs-number">2186</span><br><br>启动服务：<br> cd  <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>dolphinscheduler<br>docker-compose -f docker-compose.yml up  -d<br><br>检查：docker-compose ps -a 命令：<br>[root@host-<span class="hljs-number">192</span>-<span class="hljs-number">168</span>-<span class="hljs-number">21</span>-<span class="hljs-number">8</span> dolphinscheduler]# docker-compose ps -a<br>NAME                                         COMMAND                  SERVICE                   STATUS              PORTS<br>dolphinscheduler-dolphinscheduler-alert-<span class="hljs-number">1</span>    <span class="hljs-string">&quot;/usr/bin/tini -- /r…&quot;</span>   dolphinscheduler-alert    running (healthy)   <span class="hljs-number">50051</span>/tcp<br>dolphinscheduler-dolphinscheduler-api-<span class="hljs-number">1</span>      <span class="hljs-string">&quot;/usr/bin/tini -- /r…&quot;</span>   dolphinscheduler-api      running (healthy)   <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">12345</span>-&gt;<span class="hljs-number">12345</span>/tcp<br>dolphinscheduler-dolphinscheduler-master-<span class="hljs-number">1</span>   <span class="hljs-string">&quot;/usr/bin/tini -- /r…&quot;</span>   dolphinscheduler-master   running (healthy)   <span class="hljs-number">50051</span>/tcp<br>dolphinscheduler-dolphinscheduler-worker-<span class="hljs-number">1</span>   <span class="hljs-string">&quot;/usr/bin/tini -- /r…&quot;</span>   dolphinscheduler-worker   running (healthy)   <span class="hljs-number">50051</span>/tcp<br><br></code></pre></td></tr></table></figure><p>================================</p><p>第一次启动服务报错：</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZ9ur01cg80efuvuzubh7kZ dolphinscheduler]# docker-compose -f docker-compose.yml up -d<br>[+] Running 0/4<br> ⠿ dolphinscheduler-api Error                                                                                                          12.0s<br> ⠿ dolphinscheduler-alert Error                                                                                                        12.0s<br> ⠿ dolphinscheduler-worker Error                                                                                                       12.0s<br> ⠿ dolphinscheduler-master Error                                                                                                       12.0s<br><span class="hljs-keyword">Error </span>response from daemon: Get https://registry<span class="hljs-string">-1</span>.docker.io/v2/: dial tcp: lookup registry<span class="hljs-string">-1</span>.docker.io: no such host<br><br></code></pre></td></tr></table></figure><p>在阿里云控制台页面新建仓库gw_dolphinscheduler，然后再次启动服务</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">[root@iZ9ur01cg80efuvuzubh7kZ dolphinscheduler]<span class="hljs-comment"># docker-compose -f docker-compose.yml up -d</span><br>[+] Running <span class="hljs-number">9</span>/<span class="hljs-number">9</span><br> ? Network dolphinscheduler_dolphinscheduler                  Created                                                                   <span class="hljs-number">0.0s</span><br> ? Volume <span class="hljs-string">&quot;dolphinscheduler_dolphinscheduler-worker-data&quot;</span>     Created                                                                   <span class="hljs-number">0.0s</span><br> ? Volume <span class="hljs-string">&quot;dolphinscheduler_dolphinscheduler-resource-local&quot;</span>  Created                                                                   <span class="hljs-number">0.0s</span><br> ? Volume <span class="hljs-string">&quot;dolphinscheduler_dolphinscheduler-logs&quot;</span>            Created                                                                   <span class="hljs-number">0.0s</span><br> ? Volume <span class="hljs-string">&quot;dolphinscheduler_dolphinscheduler-shared-local&quot;</span>    Created                                                                   <span class="hljs-number">0.0s</span><br> ? Container dolphinscheduler-dolphinscheduler-worker-<span class="hljs-number">1</span>       <span class="hljs-literal">Started</span>                                                                   <span class="hljs-number">0.9s</span><br> ? Container dolphinscheduler-dolphinscheduler-alert-<span class="hljs-number">1</span>        <span class="hljs-literal">Started</span>                                                                   <span class="hljs-number">1.0s</span><br> ? Container dolphinscheduler-dolphinscheduler-api-<span class="hljs-number">1</span>          <span class="hljs-literal">Started</span>                                                                   <span class="hljs-number">1.0s</span><br> ? Container dolphinscheduler-dolphinscheduler-<span class="hljs-literal">master</span>-<span class="hljs-number">1</span>       <span class="hljs-literal">Started</span>                                                                   <span class="hljs-number">1.1s</span><br></code></pre></td></tr></table></figure><p>检查</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@iZ9ur01cg80efuvuzubh7kZ dolphinscheduler]<span class="hljs-comment"># docker-compose ps -a</span><br>NAME                                         COMMAND                  SERVICE                   STATUS              PORTS<br>dolphinscheduler-dolphinscheduler-alert-<span class="hljs-number">1</span>    <span class="hljs-string">&quot;/usr/bin/tini -- /r…&quot;</span>   dolphinscheduler-alert    running (healthy)   <span class="hljs-number">50051</span>/tcp<br>dolphinscheduler-dolphinscheduler-api-<span class="hljs-number">1</span>      <span class="hljs-string">&quot;/usr/bin/tini -- /r…&quot;</span>   dolphinscheduler-api      running (healthy)   <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">12345</span>-&gt;<span class="hljs-number">12345</span>/tcp<br>dolphinscheduler-dolphinscheduler-master-<span class="hljs-number">1</span>   <span class="hljs-string">&quot;/usr/bin/tini -- /r…&quot;</span>   dolphinscheduler-master   running (healthy)   <span class="hljs-number">50051</span>/tcp<br>dolphinscheduler-dolphinscheduler-worker-<span class="hljs-number">1</span>   <span class="hljs-string">&quot;/usr/bin/tini -- /r…&quot;</span>   dolphinscheduler-worker   running (healthy)   <span class="hljs-number">50051</span>/tcp<br><br>[root@iZ9ur01cg80efuvuzubh7kZ dolphinscheduler]<span class="hljs-comment"># docker ps -a|grep dolphin</span><br><span class="hljs-number">4</span>e0862b3a8f2        apache<span class="hljs-regexp">/dolphinscheduler:mysql-driver-v6                  &quot;/u</span>sr<span class="hljs-regexp">/bin/</span>tini -- <span class="hljs-regexp">/r…&quot;   5 minutes ago       Up 5 minutes (healthy)   1234/</span>tcp, <span class="hljs-number">5678</span><span class="hljs-regexp">/tcp, 12345/</span>tcp, <span class="hljs-number">50051</span>/tcp                  dolphinscheduler-dolphinscheduler-worker-<span class="hljs-number">1</span><br>dd2700ae9548        apache<span class="hljs-regexp">/dolphinscheduler:mysql-driver-v6                  &quot;/u</span>sr<span class="hljs-regexp">/bin/</span>tini -- <span class="hljs-regexp">/r…&quot;   5 minutes ago       Up 5 minutes (healthy)   1234/</span>tcp, <span class="hljs-number">5678</span><span class="hljs-regexp">/tcp, 12345/</span>tcp, <span class="hljs-number">50051</span>/tcp                  dolphinscheduler-dolphinscheduler-master-<span class="hljs-number">1</span><br><span class="hljs-number">33</span>e21c499642        apache<span class="hljs-regexp">/dolphinscheduler:mysql-driver-v6                  &quot;/u</span>sr<span class="hljs-regexp">/bin/</span>tini -- <span class="hljs-regexp">/r…&quot;   5 minutes ago       Up 5 minutes (healthy)   1234/</span>tcp, <span class="hljs-number">5678</span><span class="hljs-regexp">/tcp, 12345/</span>tcp, <span class="hljs-number">50051</span>/tcp                  dolphinscheduler-dolphinscheduler-alert-<span class="hljs-number">1</span><br><span class="hljs-number">0901</span>d986e778        apache<span class="hljs-regexp">/dolphinscheduler:mysql-driver-v6                  &quot;/u</span>sr<span class="hljs-regexp">/bin/</span>tini -- <span class="hljs-regexp">/r…&quot;   5 minutes ago       Up 5 minutes (healthy)   1234/</span>tcp, <span class="hljs-number">5678</span><span class="hljs-regexp">/tcp, 50051/</span>tcp, <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">12345</span>-&gt;<span class="hljs-number">12345</span>/tcp   dolphinscheduler-dolphinscheduler-api-<span class="hljs-number">1</span><br><br><br></code></pre></td></tr></table></figure><p>使用浏览器登录：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">20.2</span>.<span class="hljs-number">56.135</span>:<span class="hljs-number">12345</span>/dolphinscheduler<br>用户名：admin   密码：dolphinscheduler123<br></code></pre></td></tr></table></figure><p><img src="1656662605027.png" alt="1656662605027"></p><p>这个页面，下周一要在上边改些配置</p><p>===============================</p><p>登陆k8s的master节点，master-01  20.2.56.177</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZ9ur01ilohl58ahns7x3fZ home]# kubectl get nodes<br>NAME                            STATUS   ROLES    AGE    VERSION<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01cg80efuvuzubh7j   Ready    &lt;none&gt;   31d    v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01cg80efuvuzubh7k   Ready    &lt;none&gt;   31d    v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01ilohl58ahns7x3f   Ready    master   233d   v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01ilohl58ahns7x3g   Ready    master   233d   v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01ilohl58ahns7x3h   Ready    master   233d   v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01jdd1rx1a806h1bu   Ready    node     233d   v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01jdd1rx1a806h1bv   Ready    node     233d   v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01jdd1rx1a806h1bw   Ready    node     233d   v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01jdd1rx1a806h1bx   Ready    &lt;none&gt;   233d   v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01vob1520f5qp1yp4   Ready    &lt;none&gt;   209d   v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01vob1520f5qp1yp5   Ready    &lt;none&gt;   209d   v1.12.6-aliyun.1<br>bjdc<span class="hljs-string">-1</span>.i<span class="hljs-string">-9</span>ur01vob1520f5qp1yp6   Ready    &lt;none&gt;   209d   v1.12.6-aliyun.1<br><br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>电力行业信息系统</category>
      
    </categories>
    
    
    <tags>
      
      <tag>组件部署</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一、智慧客服系统组件部署-2022-7-1</title>
    <link href="/2022/07/04/%E4%B8%80%E3%80%81%E6%99%BA%E6%85%A7%E5%AE%A2%E6%9C%8D%E7%B3%BB%E7%BB%9F%E7%BB%84%E4%BB%B6%E9%83%A8%E7%BD%B2-2022-7-1/"/>
    <url>/2022/07/04/%E4%B8%80%E3%80%81%E6%99%BA%E6%85%A7%E5%AE%A2%E6%9C%8D%E7%B3%BB%E7%BB%9F%E7%BB%84%E4%BB%B6%E9%83%A8%E7%BD%B2-2022-7-1/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><span id="more"></span><h1 id="一、给6台ecs挂载磁盘"><a href="#一、给6台ecs挂载磁盘" class="headerlink" title="一、给6台ecs挂载磁盘"></a>一、给6台ecs挂载磁盘</h1><h2 id="挂载之前的状态"><a href="#挂载之前的状态" class="headerlink" title="挂载之前的状态"></a>挂载之前的状态</h2><figure class="highlight tap"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><pre><code class="hljs tap">[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># ll /dev/vd*</span><br>brw-rw----<span class="hljs-number"> 1 </span>root disk 253, <span class="hljs-number"> 0 </span>May<span class="hljs-number"> 31 </span>22:12 /dev/vda<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 253, <span class="hljs-number"> 1 </span>May<span class="hljs-number"> 31 </span>22:12 /dev/vda1<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 253,<span class="hljs-number"> 16 </span>May<span class="hljs-number"> 31 </span>22:12 /dev/vdb<br><br>[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># lsblk</span><br>NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>vda    253:0   <span class="hljs-number"> 0 </span>  50G <span class="hljs-number"> 0 </span>disk <br>└─vda1 253:1   <span class="hljs-number"> 0 </span>  50G <span class="hljs-number"> 0 </span>part /<br>vdb    253:16  <span class="hljs-number"> 0 </span> 100G <span class="hljs-number"> 0 </span>disk <br><br>[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># lsblk -f</span><br>NAME   FSTYPE LABEL UUID                                 MOUNTPOINT<br>vda                                                      <br>└─vda1 ext4         1114fe9e-2309-4580-b183-d778e6d97397 /<br><br>[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># blkid </span><br>/dev/vda1: UUID=&quot;1114fe9e-2309-4580-b183-d778e6d97397&quot; TYPE=&quot;ext4&quot; <br><br>[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># df -h</span><br>Filesystem      Size  Used Avail Use% Mounted on<br>devtmpfs        1.9G    <span class="hljs-number"> 0 </span> 1.9G   0% /dev<br>tmpfs           1.9G    <span class="hljs-number"> 0 </span> 1.9G   0% /dev/shm<br>tmpfs           1.9G  776K  1.9G   1% /run<br>tmpfs           1.9G    <span class="hljs-number"> 0 </span> 1.9G   0% /sys/fs/cgroup<br>/dev/vda1        50G  3.7G   43G   8% /<br>tmpfs           379M    <span class="hljs-number"> 0 </span> 379M   0% /run/user/0<br></code></pre></td></tr></table></figure><p> 使用mbr进行分区，并格式化此分区的文件系统为exe4格式，挂载点为/home</p><h2 id="1、-使用MBR方式进行分区："><a href="#1、-使用MBR方式进行分区：" class="headerlink" title="1、 使用MBR方式进行分区："></a>1、 使用MBR方式进行分区：</h2><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># fdisk -l </span><br><br>Disk /dev/vda: 53.7 GB,<span class="hljs-number"> 53687091200 </span>bytes,<span class="hljs-number"> 104857600 </span>sectors<br>Units = sectors of<span class="hljs-number"> 1 </span>*<span class="hljs-number"> 512 </span>=<span class="hljs-number"> 512 </span>bytes<br>Sector size (logical/physical):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br>I/O size (minimum/optimal):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br>Disk label type: dos<br>Disk identifier: 0x000b2d99<br><br>   Device Boot      Start         End      Blocks   Id  System<br>/dev/vda1   *       <span class="hljs-number"> 2048 </span> <span class="hljs-number"> 104855551 </span>  <span class="hljs-number"> 52426752 </span> <span class="hljs-number"> 83 </span> Linux<br><br>Disk /dev/vdb: 107.4 GB,<span class="hljs-number"> 107374182400 </span>bytes,<span class="hljs-number"> 209715200 </span>sectors<br>Units = sectors of<span class="hljs-number"> 1 </span>*<span class="hljs-number"> 512 </span>=<span class="hljs-number"> 512 </span>bytes<br>Sector size (logical/physical):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br>I/O size (minimum/optimal):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br><br>[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># fdisk /dev/vdb</span><br>Welcome to fdisk (util-linux 2.23.2).<br><br>Changes will remain in memory only, until you decide to write them.<br>Be careful before using the write command.<br><br>Device does not contain a recognized partition table<br>Building a new DOS disklabel with disk identifier 0x8dcdf9a3.<br><br>Command (m for help): m<br>Command action<br>   a   toggle a bootable flag<br>   b   edit bsd disklabel<br>   c   toggle the dos compatibility flag<br>   d   delete a partition<br>   g   create a new empty GPT partition table<br>   G   create an IRIX (SGI) partition table<br>   l   list known partition types<br>   m   print this menu<br>   n   add a new partition<br>   o   create a new empty DOS partition table<br>   p   print the partition table<br>   q   quit without saving changes<br>   s   create a new empty Sun disklabel<br>   t   change a partition&#x27;s system id<br>   u   change display/entry units<br>   v   verify the partition table<br>   w   write table to disk and exit<br>   x   extra functionality (experts only)<br><br>Command (m for help): n<br>Partition type:<br>   p   primary (0 primary,<span class="hljs-number"> 0 </span>extended,<span class="hljs-number"> 4 </span>free)<br>   e   extended<br>Select (default p): p<br>Partition number (1-4, default 1): <br>First sector (2048-209715199, default 2048): <br>Using default value 2048<br>Last sector, +sectors or +size&#123;K,M,G&#125; (2048-209715199, default 209715199): <br>Using default value 209715199<br>Partition<span class="hljs-number"> 1 </span>of type Linux and of size<span class="hljs-number"> 100 </span>GiB is set<br><br>Command (m for help): p<br><br>Disk /dev/vdb: 107.4 GB,<span class="hljs-number"> 107374182400 </span>bytes,<span class="hljs-number"> 209715200 </span>sectors<br>Units = sectors of<span class="hljs-number"> 1 </span>*<span class="hljs-number"> 512 </span>=<span class="hljs-number"> 512 </span>bytes<br>Sector size (logical/physical):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br>I/O size (minimum/optimal):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br>Disk label type: dos<br>Disk identifier: 0x8dcdf9a3<br><br>   Device Boot      Start         End      Blocks   Id  System<br>/dev/vdb1           <span class="hljs-number"> 2048 </span> <span class="hljs-number"> 209715199 </span> <span class="hljs-number"> 104856576 </span> <span class="hljs-number"> 83 </span> Linux<br><br>Command (m for help): w<br>The partition table has been altered!<br><br>Calling ioctl() to re-read partition table.<br>Syncing disks.<br></code></pre></td></tr></table></figure><p>分区之后的状态</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># fdisk -l</span><br><br>Disk /dev/vda: 53.7 GB,<span class="hljs-number"> 53687091200 </span>bytes,<span class="hljs-number"> 104857600 </span>sectors<br>Units = sectors of<span class="hljs-number"> 1 </span>*<span class="hljs-number"> 512 </span>=<span class="hljs-number"> 512 </span>bytes<br>Sector size (logical/physical):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br>I/O size (minimum/optimal):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br>Disk label type: dos<br>Disk identifier: 0x000b2d99<br><br>   Device Boot      Start         End      Blocks   Id  System<br>/dev/vda1   *       <span class="hljs-number"> 2048 </span> <span class="hljs-number"> 104855551 </span>  <span class="hljs-number"> 52426752 </span> <span class="hljs-number"> 83 </span> Linux<br><br>Disk /dev/vdb: 107.4 GB,<span class="hljs-number"> 107374182400 </span>bytes,<span class="hljs-number"> 209715200 </span>sectors<br>Units = sectors of<span class="hljs-number"> 1 </span>*<span class="hljs-number"> 512 </span>=<span class="hljs-number"> 512 </span>bytes<br>Sector size (logical/physical):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br>I/O size (minimum/optimal):<span class="hljs-number"> 512 </span>bytes /<span class="hljs-number"> 512 </span>bytes<br>Disk label type: dos<br>Disk identifier: 0x8dcdf9a3<br><br>   Device Boot      Start         End      Blocks   Id  System<br>/dev/vdb1           <span class="hljs-number"> 2048 </span> <span class="hljs-number"> 209715199 </span> <span class="hljs-number"> 104856576 </span> <span class="hljs-number"> 83 </span> Linux<br>[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># lsblk</span><br>NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>vda    253:0   <span class="hljs-number"> 0 </span>  50G <span class="hljs-number"> 0 </span>disk <br>└─vda1 253:1   <span class="hljs-number"> 0 </span>  50G <span class="hljs-number"> 0 </span>part /<br>vdb    253:16  <span class="hljs-number"> 0 </span> 100G <span class="hljs-number"> 0 </span>disk <br>└─vdb1 253:17  <span class="hljs-number"> 0 </span> 100G <span class="hljs-number"> 0 </span>part <br>[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># lsblk -f</span><br>NAME   FSTYPE LABEL UUID                                 MOUNTPOINT<br>vda                                                      <br>└─vda1 ext4         1114fe9e-2309-4580-b183-d778e6d97397 /<br>vdb                                                      <br>└─vdb1                                                   <br>[root@iZ9ur01td940v35skimdc9Z ~]<span class="hljs-comment"># blkid</span><br>/dev/vda1: UUID=&quot;1114fe9e-2309-4580-b183-d778e6d97397&quot; TYPE=&quot;ext4&quot; <br></code></pre></td></tr></table></figure><p>格式化文件系统：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><p>挂载文件系统，并设置开机自动挂载</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><p>===================</p><h2 id="磁盘管理改用lvm方式"><a href="#磁盘管理改用lvm方式" class="headerlink" title="磁盘管理改用lvm方式"></a>磁盘管理改用lvm方式</h2><h3 id="1、卸载正在使用的文件系统"><a href="#1、卸载正在使用的文件系统" class="headerlink" title="1、卸载正在使用的文件系统"></a>1、卸载正在使用的文件系统</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@iZ9ur01td940v35skimdc9Z zookeeper]<span class="hljs-comment"># bin/zkServer.sh stop</span><br>ZooKeeper JMX enabled by default<br>Using config: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/bin/</span>..<span class="hljs-regexp">/conf/</span>zoo.cfg<br>Stopping zookeeper ... STOPPED<br>[root@iZ9ur01td940v35skimdc9Z zookeeper]<span class="hljs-comment"># bin/zkServer.sh status</span><br>ZooKeeper JMX enabled by default<br>Using config: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/bin/</span>..<span class="hljs-regexp">/conf/</span>zoo.cfg<br>Error contacting service. It is probably not running.<br>[root@iZ9ur01td940v35skimdc9Z zookeeper]<span class="hljs-comment"># cd /</span><br>[root@iZ9ur01td940v35skimdc9Z <span class="hljs-regexp">/]# umount /</span>home <br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-comment"># df -hT</span><br>Filesystem     Type      Size  Used Avail Use% Mounted on<br>devtmpfs       devtmpfs  <span class="hljs-number">1.9</span>G     <span class="hljs-number">0</span>  <span class="hljs-number">1.9</span>G   <span class="hljs-number">0</span>% /dev<br>tmpfs          tmpfs     <span class="hljs-number">1.9</span>G     <span class="hljs-number">0</span>  <span class="hljs-number">1.9</span>G   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs          tmpfs     <span class="hljs-number">1.9</span>G  <span class="hljs-number">888</span>K  <span class="hljs-number">1.9</span>G   <span class="hljs-number">1</span>% /run<br>tmpfs          tmpfs     <span class="hljs-number">1.9</span>G     <span class="hljs-number">0</span>  <span class="hljs-number">1.9</span>G   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/</span>vda1      ext4       <span class="hljs-number">50</span>G  <span class="hljs-number">4.4</span>G   <span class="hljs-number">43</span>G  <span class="hljs-number">10</span>% /<br>tmpfs          tmpfs     <span class="hljs-number">379</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">379</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h3 id="2、创建PV"><a href="#2、创建PV" class="headerlink" title="2、创建PV"></a>2、创建PV</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@iZ9ur01td940v35skimdc9Z <span class="hljs-regexp">/]# ll /</span>dev/vd*<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">253</span>,  <span class="hljs-number">0</span> Jun <span class="hljs-number">28</span> <span class="hljs-number">19</span>:<span class="hljs-number">21</span> <span class="hljs-regexp">/dev/</span>vda<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">253</span>,  <span class="hljs-number">1</span> Jun <span class="hljs-number">28</span> <span class="hljs-number">19</span>:<span class="hljs-number">21</span> <span class="hljs-regexp">/dev/</span>vda1<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">253</span>, <span class="hljs-number">16</span> Jun <span class="hljs-number">28</span> <span class="hljs-number">19</span>:<span class="hljs-number">21</span> <span class="hljs-regexp">/dev/</span>vdb<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">253</span>, <span class="hljs-number">17</span> Jun <span class="hljs-number">28</span> <span class="hljs-number">19</span>:<span class="hljs-number">21</span> <span class="hljs-regexp">/dev/</span>vdb1<br><br>[root@iZ9ur01td940v35skimdc9Z <span class="hljs-regexp">/]# pvcreate /</span>dev/vdb1<br>WARNING: ext4 signature detected on <span class="hljs-regexp">/dev/</span>vdb1 at offset <span class="hljs-number">1080</span>. Wipe it? [y/n]: y<br>  Wiping ext4 signature on <span class="hljs-regexp">/dev/</span>vdb1.<br>  Physical volume <span class="hljs-string">&quot;/dev/vdb1&quot;</span> successfully created.<br>  <br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-comment"># pvs</span><br>  PV         VG Fmt  Attr PSize    PFree   <br>  <span class="hljs-regexp">/dev/</span>vdb1     lvm2 ---  &lt;<span class="hljs-number">100.00</span>g &lt;<span class="hljs-number">100.00</span>g<br>  <br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-comment"># pvdisplay</span><br>  --- Physical volume ---<br>  PV Name               <span class="hljs-regexp">/dev/</span>vdb1<br>  VG Name               vg_data<br>  PV Size               &lt;<span class="hljs-number">100.00</span> GiB / not usable <span class="hljs-number">3.00</span> MiB<br>  Allocatable           yes <br>  PE Size               <span class="hljs-number">4.00</span> MiB<br>  Total PE              <span class="hljs-number">25599</span><br>  Free PE               <span class="hljs-number">25599</span><br>  Allocated PE          <span class="hljs-number">0</span><br>  PV UUID               GusHKH-nlVh-VnLS-v9IP-Ii7P-rwJM-fa8vd1<br></code></pre></td></tr></table></figure><h3 id="3、创建VG"><a href="#3、创建VG" class="headerlink" title="3、创建VG"></a>3、创建VG</h3><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs sqf">[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-meta"># vgcreate vg_data /dev/vdb1</span><br>  Volume <span class="hljs-built_in">group</span> <span class="hljs-string">&quot;vg_data&quot;</span> successfully created<br>  <br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-meta"># vgs</span><br>  VG      <span class="hljs-meta">#PV #LV #SN Attr   VSize    VFree   </span><br>  vg_data   <span class="hljs-number">1</span>   <span class="hljs-number">0</span>   <span class="hljs-number">0</span> wz--n- &lt;<span class="hljs-number">100.00</span>g &lt;<span class="hljs-number">100.00</span>g<br>  <br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-meta"># vgdisplay</span><br>  --- Volume <span class="hljs-built_in">group</span> ---<br>  VG <span class="hljs-built_in">Name</span>               vg_data<br>  System ID             <br>  <span class="hljs-built_in">Format</span>                lvm2<br>  Metadata Areas        <span class="hljs-number">1</span><br>  Metadata Sequence No  <span class="hljs-number">1</span><br>  VG Access             read/write<br>  VG Status             resizable<br>  <span class="hljs-built_in">MAX</span> LV                <span class="hljs-number">0</span><br>  Cur LV                <span class="hljs-number">0</span><br>  Open LV               <span class="hljs-number">0</span><br>  <span class="hljs-built_in">Max</span> PV                <span class="hljs-number">0</span><br>  Cur PV                <span class="hljs-number">1</span><br>  Act PV                <span class="hljs-number">1</span><br>  VG <span class="hljs-built_in">Size</span>               &lt;<span class="hljs-number">100.00</span> GiB<br>  PE <span class="hljs-built_in">Size</span>               <span class="hljs-number">4.00</span> MiB<br>  Total PE              <span class="hljs-number">25599</span><br>  Alloc PE / <span class="hljs-built_in">Size</span>       <span class="hljs-number">0</span> / <span class="hljs-number">0</span>   <br>  Free  PE / <span class="hljs-built_in">Size</span>       <span class="hljs-number">25599</span> / &lt;<span class="hljs-number">100.00</span> GiB<br>  VG UUID               Xm3Sw5-o2J9-exQB-PYcs-<span class="hljs-number">06</span>ok-nf2U-pv5flz<br></code></pre></td></tr></table></figure><p><img src="image-20220704211205706-16569412017554.png" alt="image-20220704211205706"></p><h3 id="4、创建LV"><a href="#4、创建LV" class="headerlink" title="4、创建LV"></a>4、创建LV</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@iZ9ur01td940v35skimdc9Z /]# lvcreate -L <span class="hljs-number">99</span>G -n lv_data vg_data<br>  Logical volume &quot;lv_data&quot; created.<br>[root@iZ9ur01td940v35skimdc9Z /]# lvs<br>  LV      VG      Attr       LSize  Pool Origin Data%  Meta%  <span class="hljs-keyword">Move</span> <span class="hljs-keyword">Log</span> Cpy%Sync Convert<br>  lv_data vg_data -wi-a<span class="hljs-comment">----- 99.00g                                                    </span><br>[root@iZ9ur01td940v35skimdc9Z /]# lvdisplay<br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/vg_data/lv_data<br>  LV <span class="hljs-type">Name</span>                lv_data<br>  VG <span class="hljs-type">Name</span>                vg_data<br>  LV <span class="hljs-type">UUID</span>                oeHNnh-vqiG<span class="hljs-number">-2</span>xVE-sJ30-HQaw<span class="hljs-number">-1</span>sT1-ovDRKd<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  LV Creation host, <span class="hljs-type">time</span> iZ9ur01td940v35skimdc9Z, <span class="hljs-number">2022</span><span class="hljs-number">-06</span><span class="hljs-number">-29</span> <span class="hljs-number">19</span>:<span class="hljs-number">14</span>:<span class="hljs-number">56</span> +<span class="hljs-number">0800</span><br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">0</span><br>  LV Size                <span class="hljs-number">99.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">25344</span><br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">8192</span><br>  Block device           <span class="hljs-number">252</span>:<span class="hljs-number">0</span><br>  <br>[root@iZ9ur01td940v35skimdc9Z /]# lsblk<br><span class="hljs-type">NAME</span>                MAJ:MIN RM  SIZE RO <span class="hljs-keyword">TYPE</span> MOUNTPOINT<br>vda                 <span class="hljs-number">253</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">50</span>G  <span class="hljs-number">0</span> disk <br>└─vda1              <span class="hljs-number">253</span>:<span class="hljs-number">1</span>    <span class="hljs-number">0</span>   <span class="hljs-number">50</span>G  <span class="hljs-number">0</span> part /<br>vdb                 <span class="hljs-number">253</span>:<span class="hljs-number">16</span>   <span class="hljs-number">0</span>  <span class="hljs-number">100</span>G  <span class="hljs-number">0</span> disk <br>└─vdb1              <span class="hljs-number">253</span>:<span class="hljs-number">17</span>   <span class="hljs-number">0</span>  <span class="hljs-number">100</span>G  <span class="hljs-number">0</span> part <br>  └─vg_data-lv_data <span class="hljs-number">252</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">99</span>G  <span class="hljs-number">0</span> lvm  <br>  <br>[root@iZ9ur01td940v35skimdc9Z /]# blkid<br>/dev/vda1: <span class="hljs-type">UUID</span>=&quot;1114fe9e-2309-4580-b183-d778e6d97397&quot; <span class="hljs-keyword">TYPE</span>=&quot;ext4&quot; <br>/dev/vdb1: <span class="hljs-type">UUID</span>=&quot;GusHKH-nlVh-VnLS-v9IP-Ii7P-rwJM-fa8vd1&quot; <span class="hljs-keyword">TYPE</span>=&quot;LVM2_member&quot;<br></code></pre></td></tr></table></figure><p>5、格式化文件系统</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@iZ9ur01td940v35skimdc9Z <span class="hljs-regexp">/]# mkfs.ext4 /</span>dev<span class="hljs-regexp">/vg_data/</span>lv_data  <span class="hljs-comment">// 命令也是对的，不知道为什么会报没有这个设备？</span><br>mke2fs <span class="hljs-number">1.42</span>.<span class="hljs-number">9</span> (<span class="hljs-number">28</span>-Dec-<span class="hljs-number">2013</span>)<br>Could not stat <span class="hljs-regexp">/dev/</span>vg_dat_data --- No such <span class="hljs-keyword">file</span> or directory<br><br>The device apparently does not exist; did you specify it correctly?<br><br>[root@iZ9ur01td940v35skimdc9Z <span class="hljs-regexp">/]# mkfs.ext4 /</span>dev<span class="hljs-regexp">/vg_data/</span>lv_data <br>mke2fs <span class="hljs-number">1.42</span>.<span class="hljs-number">9</span> (<span class="hljs-number">28</span>-Dec-<span class="hljs-number">2013</span>)<br>Filesystem label=<br>OS type: Linux<br>Block <span class="hljs-keyword">size</span>=<span class="hljs-number">4096</span> (log=<span class="hljs-number">2</span>)<br>Fragment <span class="hljs-keyword">size</span>=<span class="hljs-number">4096</span> (log=<span class="hljs-number">2</span>)<br>Stride=<span class="hljs-number">0</span> blocks, Stripe width=<span class="hljs-number">0</span> blocks<br><span class="hljs-number">6488064</span> inodes, <span class="hljs-number">25952256</span> blocks<br><span class="hljs-number">1297612</span> blocks (<span class="hljs-number">5.00</span>%) reserved <span class="hljs-keyword">for</span> the <span class="hljs-keyword">super</span> user<br>First data block=<span class="hljs-number">0</span><br>Maximum filesystem blocks=<span class="hljs-number">2174746624</span><br><span class="hljs-number">792</span> block groups<br><span class="hljs-number">32768</span> blocks per <span class="hljs-keyword">group</span>, <span class="hljs-number">32768</span> fragments per <span class="hljs-keyword">group</span><br><span class="hljs-number">8192</span> inodes per <span class="hljs-keyword">group</span><br>Superblock backups stored on blocks: <br><span class="hljs-number">32768</span>, <span class="hljs-number">98304</span>, <span class="hljs-number">163840</span>, <span class="hljs-number">229376</span>, <span class="hljs-number">294912</span>, <span class="hljs-number">819200</span>, <span class="hljs-number">884736</span>, <span class="hljs-number">1605632</span>, <span class="hljs-number">2654208</span>, <br><span class="hljs-number">4096000</span>, <span class="hljs-number">7962624</span>, <span class="hljs-number">11239424</span>, <span class="hljs-number">20480000</span>, <span class="hljs-number">23887872</span><br><br>Allocating <span class="hljs-keyword">group</span> tables: done                            <br>Writing inode tables: done                            <br>Creating journal (<span class="hljs-number">32768</span> blocks): done<br>Writing superblocks and filesystem accounting information: done   <br></code></pre></td></tr></table></figure><p><img src="image-20220704211259415-16569412017552.png" alt="image-20220704211259415"></p><p>6、配置开机自动挂载</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@iZ9ur01td940v35skimdc9Z <span class="hljs-regexp">/]# vim /</span>etc/fstab <br>[root@iZ9ur01td940v35skimdc9Z <span class="hljs-regexp">/]# cat /</span>etc/fstab <br><span class="hljs-comment">#</span><br><span class="hljs-comment"># /etc/fstab</span><br><span class="hljs-comment"># Created by anaconda on Thu Jul 11 02:52:01 2019</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><br><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><br><span class="hljs-comment">#</span><br>UUID=<span class="hljs-number">1114</span>fe9e-<span class="hljs-number">2309</span>-<span class="hljs-number">4580</span>-b183-d778e6d97397 /                       ext4    defaults        <span class="hljs-number">1</span> <span class="hljs-number">1</span><br><span class="hljs-regexp">/dev/</span>vg_data<span class="hljs-regexp">/lv_data /</span>homeext4defaults<span class="hljs-number">1</span> <span class="hljs-number">1</span><br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-comment"># mount -a</span><br>mount: wrong fs type, bad option, bad superblock on <span class="hljs-regexp">/dev/m</span>apper/vg_data-lv_data,<br>       missing codepage or helper program, or other error<br><br>       In some cases useful info is found <span class="hljs-keyword">in</span> syslog - try<br>       dmesg | tail or so.<br><br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-comment"># mount -a</span><br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-comment"># df -hT</span><br>Filesystem                  Type      Size  Used Avail Use% Mounted on<br>devtmpfs                    devtmpfs  <span class="hljs-number">1.9</span>G     <span class="hljs-number">0</span>  <span class="hljs-number">1.9</span>G   <span class="hljs-number">0</span>% /dev<br>tmpfs                       tmpfs     <span class="hljs-number">1.9</span>G     <span class="hljs-number">0</span>  <span class="hljs-number">1.9</span>G   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                       tmpfs     <span class="hljs-number">1.9</span>G  <span class="hljs-number">932</span>K  <span class="hljs-number">1.9</span>G   <span class="hljs-number">1</span>% /run<br>tmpfs                       tmpfs     <span class="hljs-number">1.9</span>G     <span class="hljs-number">0</span>  <span class="hljs-number">1.9</span>G   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/</span>vda1                   ext4       <span class="hljs-number">50</span>G  <span class="hljs-number">4.4</span>G   <span class="hljs-number">43</span>G  <span class="hljs-number">10</span>% /<br>tmpfs                       tmpfs     <span class="hljs-number">379</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">379</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/vg_data-lv_data ext4       98G   61M   93G   1% /</span>home<br><br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-comment"># lsblk</span><br>NAME                MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>vda                 <span class="hljs-number">253</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">50</span>G  <span class="hljs-number">0</span> disk <br>└─vda1              <span class="hljs-number">253</span>:<span class="hljs-number">1</span>    <span class="hljs-number">0</span>   <span class="hljs-number">50</span>G  <span class="hljs-number">0</span> part /<br>vdb                 <span class="hljs-number">253</span>:<span class="hljs-number">16</span>   <span class="hljs-number">0</span>  <span class="hljs-number">100</span>G  <span class="hljs-number">0</span> disk <br>└─vdb1              <span class="hljs-number">253</span>:<span class="hljs-number">17</span>   <span class="hljs-number">0</span>  <span class="hljs-number">100</span>G  <span class="hljs-number">0</span> part <br>  └─vg_data-lv_data <span class="hljs-number">252</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">99</span>G  <span class="hljs-number">0</span> lvm  /home<br>  <br>[root@iZ9ur01td940v35skimdc9Z /]<span class="hljs-comment"># blkid</span><br><span class="hljs-regexp">/dev/</span>vda1: UUID=<span class="hljs-string">&quot;1114fe9e-2309-4580-b183-d778e6d97397&quot;</span> TYPE=<span class="hljs-string">&quot;ext4&quot;</span> <br><span class="hljs-regexp">/dev/</span>vdb1: UUID=<span class="hljs-string">&quot;GusHKH-nlVh-VnLS-v9IP-Ii7P-rwJM-fa8vd1&quot;</span> TYPE=<span class="hljs-string">&quot;LVM2_member&quot;</span> <br><span class="hljs-regexp">/dev/m</span>apper/vg_data-lv_data: UUID=<span class="hljs-string">&quot;64f125e7-ecf0-44ca-9d00-87779b9f4f3d&quot;</span> TYPE=<span class="hljs-string">&quot;ext4&quot;</span> <br></code></pre></td></tr></table></figure><p><img src="image-20220704211327835-16569412017553.png" alt="image-20220704211327835"></p><h1 id="二、部署组件"><a href="#二、部署组件" class="headerlink" title="二、部署组件"></a>二、部署组件</h1><p>组建的部署规划：</p><table><thead><tr><th>组件生产ecs-1</th><th>20.2.56.143</th><th>10022</th><th>root</th><th>New6&amp;7*oa</th><th>客服系统生产组件zookeeper（端口2186） kafka(端口8092)</th></tr></thead><tbody><tr><td>组件生产ecs-2</td><td>20.2.56.144</td><td>10022</td><td>root</td><td>New6&amp;7*oa</td><td>客服系统生产组件zookeeper、 kafka</td></tr><tr><td>组件生产ecs-3</td><td>20.2.56.140</td><td>10022</td><td>root</td><td>New6&amp;7*oa</td><td>客服系统生产组件zookeeper、 kafka</td></tr><tr><td>组件生产ecs-4</td><td>20.2.56.142</td><td>10022</td><td>root</td><td>New6&amp;7*oa</td><td>客服系统生产组件es6.3（9201）/es2.3.5（9202）/es7（9207）</td></tr><tr><td>组件生产ecs-5</td><td>20.2.56.139</td><td>10022</td><td>root</td><td>New6&amp;7*oa</td><td>客服系统生产组件es6.3（9201）/es2.3.5（9202）</td></tr><tr><td>组件生产ecs-6</td><td>20.2.56.141</td><td>10022</td><td>root</td><td>New6&amp;7*oa</td><td>客服系统生产组件es6.3（9201）/es2.3.5（9202）</td></tr></tbody></table><h2 id="1、zookper集群部署"><a href="#1、zookper集群部署" class="headerlink" title="1、zookper集群部署"></a>1、zookper集群部署</h2><p>在20.2.56.143，20.2.56.144，20.2.56.140 这3台服务器上部署zookeeper。</p><h3 id="准备zookeeper的安装包"><a href="#准备zookeeper的安装包" class="headerlink" title="准备zookeeper的安装包"></a>准备zookeeper的安装包</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget https:<span class="hljs-regexp">//</span>archive.apache.org<span class="hljs-regexp">/dist/</span>zookeeper<span class="hljs-regexp">/zookeeper-3.4.11/</span>zookeeper-<span class="hljs-number">3.4</span>.<span class="hljs-number">11</span>.tar.gz<br>或者用本地已有的也可<br></code></pre></td></tr></table></figure><p>将包解压到/home/gw/software/目录下。解压后，在/home/gw/software目录下给zookeeper创建一个软链接。创建data和log目录</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@iZ9ur01td940v35skimdcbZ ~]# tar xf <span class="hljs-regexp">/tmp/</span>zookeeper-<span class="hljs-number">3.4</span>.<span class="hljs-number">11</span>.tar.gz -C <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span><br>[root@iZ9ur01td940v35skimdcbZ software]#ln -s zookeeper-<span class="hljs-number">3.4</span>.<span class="hljs-number">11</span> zookeeper<br>mkdir -p <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper/data<br>mkdir -p <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper/log<br></code></pre></td></tr></table></figure><h3 id="修改zookeeper的配置文件"><a href="#修改zookeeper的配置文件" class="headerlink" title="修改zookeeper的配置文件"></a>修改zookeeper的配置文件</h3><p>配置前，确认该服务器上2681、2888、3888端口没有被占用。</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@node1</span> <span class="hljs-built_in">log</span>]<span class="hljs-meta"># netstat -antpl|grep 2186</span><br>[root<span class="hljs-symbol">@node1</span> <span class="hljs-built_in">log</span>]<span class="hljs-meta"># netstat -antpl|grep 2888</span><br>[root<span class="hljs-symbol">@node1</span> <span class="hljs-built_in">log</span>]<span class="hljs-meta"># netstat -antpl|grep 3888</span><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs awk"> <span class="hljs-number">1</span>.进入conf文件夹，拷贝zoo_sample.cfg改为zoo.cfg，命令：<br>    cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/conf/</span><br>  cp zoo_sample.cfg zoo.cfg<br>  <br> <span class="hljs-number">2</span>.修改zoo.cfg的配置：<br> vim <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/conf/</span>zoo.cfg <br>  要有以下且不限于以下内容：<br>   dataDir=<span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper/data<br>  dataLogDir=<span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper/log<br>  clientPort=<span class="hljs-number">2186</span><br>  <br>  maxClientCnxns=<span class="hljs-number">6000</span><br>  server.<span class="hljs-number">0</span>=<span class="hljs-number">20.2</span>.<span class="hljs-number">56.143</span>:<span class="hljs-number">2888</span>:<span class="hljs-number">3888</span><br>  server.<span class="hljs-number">1</span>=<span class="hljs-number">20.2</span>.<span class="hljs-number">56.144</span>:<span class="hljs-number">2888</span>:<span class="hljs-number">3888</span><br>  server.<span class="hljs-number">2</span>=<span class="hljs-number">20.2</span>.<span class="hljs-number">56.140</span>:<span class="hljs-number">2888</span>:<span class="hljs-number">3888</span><br>  <br>配置解释<br> 【server】的配置含义说明：<br>      server.A=B:C:D<br>       其中 A 是一个数字，表示这个是第几号服务器<br>           B 是这个服务器的IP地址； <br>           C 表示的是这个服务器与集群中的Leader服务器交换信息的端口；<br>           D 表示的是万一集群中的Leader服务器挂了，需要一个端口来重新进行选举，选出一个新的 Leader，而这个端口就是用来执行选举时服务器相互通信的端口。<br>           <br>三个节点的zoo.cfg文件相同，可以直接复制。<br></code></pre></td></tr></table></figure><p><img src="image-20220704210903331-16569412017541.png" alt="image-20220704210903331"></p><h3 id="创建myid文件"><a href="#创建myid文件" class="headerlink" title="创建myid文件"></a>创建myid文件</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">在zoo.cfg配置的dataDir目录下创建myid的文件。<br>cd /home/gw/software/zookeeper/data<br>vim myid  <br>然后，内容写一个数字，保存即可。(这个数字，是对应的server.<span class="hljs-string">[数字]</span>的数字。)<br><span class="hljs-number">20.2.56.143</span>的，为<span class="hljs-number">0</span>；<br><span class="hljs-number">20.2.56.144</span>的，为<span class="hljs-number">1</span>；<br><span class="hljs-number">20.2.56.140</span>的，为<span class="hljs-number">2</span>；<br></code></pre></td></tr></table></figure><h3 id="启动zk服务"><a href="#启动zk服务" class="headerlink" title="启动zk服务"></a>启动zk服务</h3><p>如果没看有java环境，在执行启动zk服务的命令后会没有进程，在zookeeper目录下查看日志zookeeper.out，会发现仅有一行内容，提示“运行java命令失败”，需要先部署java环境。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<br>bin<span class="hljs-regexp">/zkServer.sh start conf/</span>zoo.cfg <br></code></pre></td></tr></table></figure><h3 id="停zk服务"><a href="#停zk服务" class="headerlink" title="停zk服务"></a>停zk服务</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@node1 zookeeper]# bin<span class="hljs-regexp">/zkServer.sh stop conf/</span>zoo.cfg <br>ZooKeeper JMX enabled by <span class="hljs-keyword">default</span><br>Using config: conf/zoo.cfg<br>Stopping zookeeper ... STOPPED<br><br>[root@node1 zookeeper]# bin/zkServer.sh status<br>ZooKeeper JMX enabled by <span class="hljs-keyword">default</span><br>Using config: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/bin/</span>..<span class="hljs-regexp">/conf/</span>zoo.cfg<br>Error contacting service. It is probably not running.<br></code></pre></td></tr></table></figure><h3 id="部署java环境（JDK安装部署）"><a href="#部署java环境（JDK安装部署）" class="headerlink" title="部署java环境（JDK安装部署）"></a>部署java环境（JDK安装部署）</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs gradle">将 jdk1.<span class="hljs-number">8.0</span>_131.tgz 上传到 <span class="hljs-regexp">/home/g</span>w/software 目录下，解压安装<br>tar -xzvf ~<span class="hljs-regexp">/downloads/</span>jdk1.<span class="hljs-number">8.0</span>_131.tgz -C <span class="hljs-regexp">/home/g</span>w/software <br><br>编辑~/.bash_profile文件，增加如下内容<br>vi ~/.bash_profile<br>```<br>JAVA_HOME=<span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>jdk1.<span class="hljs-number">8.0</span>_131/jre<br>JRE_HOME=$JAVA_HOME<br>export JAVA_HOME JRE_HOME<br>PATH=$JAVA_HOME<span class="hljs-regexp">/bin:$JRE_HOME/</span>bin:$PATH<br>export PATH<br>```<br><br>执行如下命令，使配置生效<br><span class="hljs-keyword">source</span> ~/.bash_profile <br><br>验证：  java  -version<br>===================================<br>现场使用的版本：jdk1.<span class="hljs-number">8.0</span>_172.zip，跳板机上没有解压软件，是先解压后再拷到ECS上的。<br>实际操作记录：<br>[root@iZ9ur01td940v35skimdc9Z zookeeper]# cp -rp <span class="hljs-regexp">/tmp/</span>jdk1.<span class="hljs-number">8.0</span>_172 <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span><br>[root@iZ9ur01td940v35skimdc9Z software]# java -version<br>-bash: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>jdk1.<span class="hljs-number">8.0</span>_172<span class="hljs-regexp">/jre/</span>bin/java: Permission denied<br>[root@iZ9ur01td940v35skimdc9Z software]# chmod <span class="hljs-number">755</span> <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>jdk1.<span class="hljs-number">8.0</span>_172<span class="hljs-regexp">/jre/</span>bin/java<br>[root@iZ9ur01td940v35skimdc9Z software]# java -version<br>java version <span class="hljs-string">&quot;1.8.0_172&quot;</span><br>Java(TM) SE <span class="hljs-keyword">Runtime</span> Environment (build <span class="hljs-number">1.8</span>.<span class="hljs-number">0</span>_172-b11)<br>Java HotSpot(TM) <span class="hljs-number">64</span>-Bit Server VM (build <span class="hljs-number">25.172</span>-b11, mixed mode)<br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@iZ9ur01td940v35skimdc9Z zookeeper]# bin<span class="hljs-regexp">/zkServer.sh start conf/</span>zoo.cfg <br>ZooKeeper JMX enabled by <span class="hljs-keyword">default</span><br>Using config: conf/zoo.cfg<br>Starting zookeeper ... STARTED<br>[root@iZ9ur01td940v35skimdc9Z zookeeper]# bin/zkServer.sh status<br>ZooKeeper JMX enabled by <span class="hljs-keyword">default</span><br>Using config: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/bin/</span>..<span class="hljs-regexp">/conf/</span>zoo.cfg<br>Error contacting service. It is probably not running.<br></code></pre></td></tr></table></figure><h3 id="检查是否启动成功"><a href="#检查是否启动成功" class="headerlink" title="检查是否启动成功"></a>检查是否启动成功</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">查看各机器的状态：<br>cd  <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<br>bin/zkServer.sh status<br>看下对应的zookeeper.out日志<br></code></pre></td></tr></table></figure><p>zookeeper服务启动正常时的状态：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dns">[root@iZ9ur01td940v35skimdc9Z zookeeper]# netstat -anp|grep <span class="hljs-number">2186</span><br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0 0.0.0</span>.<span class="hljs-number">0</span>:<span class="hljs-number">2186</span>            <span class="hljs-number">0.0.0.0</span>:*               LISTEN      <span class="hljs-number">1932</span>/java           <br>[root@iZ9ur01td940v35skimdc9Z zookeeper]# netstat -anp|grep <span class="hljs-number">2888</span><br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0 20.2.56</span>.<span class="hljs-number">143:56630</span>       <span class="hljs-number">20.2.56.144</span>:<span class="hljs-number">2888</span>        ESTABLISHED <span class="hljs-number">1932</span>/java           <br>[root@iZ9ur01td940v35skimdc9Z zookeeper]# netstat -anp|grep <span class="hljs-number">3888</span><br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0 20.2.56</span>.<span class="hljs-number">143:3888</span>        <span class="hljs-number">0.0.0.0</span>:*               LISTEN      <span class="hljs-number">1932</span>/java           <br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0 20.2.56</span>.<span class="hljs-number">143:3888</span>        <span class="hljs-number">20.2.56.144</span>:<span class="hljs-number">42862</span>       ESTABLISHED <span class="hljs-number">1932</span>/java           <br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0 20.2.56</span>.<span class="hljs-number">143:3888</span>        <span class="hljs-number">20.2.56.140</span>:<span class="hljs-number">58008</span>       ESTABLISHED <span class="hljs-number">1932</span>/java           <br>[root@iZ9ur01td940v35skimdc9Z zookeeper]# bin/zkServer.sh status<br>ZooKeeper JMX enabled by default<br>Using config: /home/gw/software/zookeeper/bin/../conf/zoo.cfg<br>Mode: follower<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 zookeeper]<span class="hljs-comment"># bin/zkServer.sh status </span><br>ZooKeeper JMX enabled by default<br>Using config: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/bin/</span>..<span class="hljs-regexp">/conf/</span>zoo.cfg<br>Mode: follower<br><br>[root@node2 zookeeper]<span class="hljs-comment"># bin/zkServer.sh status </span><br>ZooKeeper JMX enabled by default<br>Using config: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/bin/</span>..<span class="hljs-regexp">/conf/</span>zoo.cfg<br>Mode: follower<br><br>[root@node3 zookeeper]<span class="hljs-comment"># bin/zkServer.sh status </span><br>ZooKeeper JMX enabled by default<br>Using config: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/bin/</span>..<span class="hljs-regexp">/conf/</span>zoo.cfg<br>Mode: leader<br></code></pre></td></tr></table></figure><p><img src="1656599791448.png" alt="1656599791448"></p><p>端口的功能：</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-number">2888</span>： 这个服务器与集群中的<span class="hljs-built_in">Leader</span>服务器，交换信息。此时，lead是node3，所以与node1和node2的<span class="hljs-number">2888</span>端口建立通信连接的是node3，与node3建立连接的是node1和node2.<br><br><span class="hljs-number">3888</span>： 万一集群中的<span class="hljs-built_in">Leader</span>服务器挂了，需要一个端口来重新进行选举，选出一个新的 <span class="hljs-built_in">Leader</span>，而这个端口就是用来执行选举时服务器相互通信的端口。所以与各种<span class="hljs-number">3888</span>端口建立连接的是另外两个node。<br></code></pre></td></tr></table></figure><p>​     </p><h3 id="部署可能遇到的问题"><a href="#部署可能遇到的问题" class="headerlink" title="部署可能遇到的问题"></a>部署可能遇到的问题</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs powershell">启动时如果报错：<br>bin/zkServer.sh <span class="hljs-built_in">start</span> conf/zoo.cfg <br>ZooKeeper JMX enabled by default<br><span class="hljs-keyword">Using</span> config: conf/zoo.cfg<br>Starting zookeeper ... already running as <span class="hljs-keyword">process</span> <span class="hljs-number">27777</span>.<br><br>解决办法：<br>进入<span class="hljs-keyword">data</span>目录，删除zookeeper_server.pid文件<br><span class="hljs-built_in">rm</span> zookeeper_server.pid文件<br></code></pre></td></tr></table></figure><h3 id="服务地址"><a href="#服务地址" class="headerlink" title="服务地址"></a>服务地址</h3><p>​    三台zookeeper部署完毕后，它对外提供服务的地址就是:</p><p>​    20.2.56.143:2181,20.2.56.144:2181,20.2.56.140:2181    </p><h3 id="常用工具"><a href="#常用工具" class="headerlink" title="常用工具"></a>常用工具</h3><p>​    如果需要连接zookeeper集群，查看zookeeper中保存的源数据，可以通过这个工具进行查看：ZooInspector。</p><p>​    或者使用命令，登录zookeeper的客户端。bin/zkCli.sh -server 127.0.0.1:2181</p><p>在执行启动zk服务的命令后，2888端口没有启动，使用“bin/zkCli.sh -server 127.0.0.1:2181”测试，部分内容如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-number">2022</span>-<span class="hljs-number">06</span>-<span class="hljs-number">30</span> <span class="hljs-number">10</span>:<span class="hljs-number">18</span>:<span class="hljs-number">39</span>,<span class="hljs-number">886</span> <span class="hljs-selector-attr">[myid:]</span> - INFO  <span class="hljs-selector-attr">[main-SendThread(127.0.0.1:2181):ClientCnxn$SendThread@1035]</span> - Opening socket connection to server <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>/<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">2181</span>. Will not attempt to authenticate using SASL (unknown error)<br><span class="hljs-number">2022</span>-<span class="hljs-number">06</span>-<span class="hljs-number">30</span> <span class="hljs-number">10</span>:<span class="hljs-number">18</span>:<span class="hljs-number">39</span>,<span class="hljs-number">887</span> <span class="hljs-selector-attr">[myid:]</span> - WARN  <span class="hljs-selector-attr">[main-SendThread(127.0.0.1:2181):ClientCnxn$SendThread@1165]</span> - Session <span class="hljs-number">0</span>x0 <span class="hljs-keyword">for</span> server null, unexpected error, closing socket connection and attempting reconnect<br>java<span class="hljs-selector-class">.net</span><span class="hljs-selector-class">.ConnectException</span>: Connection refused<br>at sun<span class="hljs-selector-class">.nio</span><span class="hljs-selector-class">.ch</span><span class="hljs-selector-class">.SocketChannelImpl</span><span class="hljs-selector-class">.checkConnect</span>(Native Method)<br>at sun<span class="hljs-selector-class">.nio</span><span class="hljs-selector-class">.ch</span><span class="hljs-selector-class">.SocketChannelImpl</span><span class="hljs-selector-class">.finishConnect</span>(SocketChannelImpl<span class="hljs-selector-class">.java</span>:<span class="hljs-number">717</span>)<br>at org<span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.zookeeper</span><span class="hljs-selector-class">.ClientCnxnSocketNIO</span><span class="hljs-selector-class">.doTransport</span>(ClientCnxnSocketNIO<span class="hljs-selector-class">.java</span>:<span class="hljs-number">361</span>)<br>at org<span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.zookeeper</span>.ClientCnxn<span class="hljs-variable">$SendThread</span><span class="hljs-selector-class">.run</span>(ClientCnxn<span class="hljs-selector-class">.java</span>:<span class="hljs-number">1144</span>)<br></code></pre></td></tr></table></figure><p>关闭selinux</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@node1</span> zookeeper]<span class="hljs-meta"># getenforce</span><br>Enforcing<br>[root<span class="hljs-symbol">@node1</span> zookeeper]<span class="hljs-meta"># setenforce 0</span><br>[root<span class="hljs-symbol">@node1</span> zookeeper]<span class="hljs-meta"># getenforce</span><br>Permissive<br>[root<span class="hljs-symbol">@node1</span> zookeeper]<span class="hljs-meta"># sed -i s/SELINUX=enforcing/SELINUX=disabled/ /etc/selinux/config </span><br></code></pre></td></tr></table></figure><p>关闭防火墙</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 zookeeper]<span class="hljs-comment"># systemctl status firewalld</span><br>● firewalld.service - firewalld - dynamic firewall daemon<br>   Loaded: loaded (<span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/systemd/</span>system/firewalld.service; enabled; vendor preset: enabled)<br>   Active: active (running) since Thu <span class="hljs-number">2022</span>-<span class="hljs-number">06</span>-<span class="hljs-number">30</span> <span class="hljs-number">08</span>:<span class="hljs-number">30</span>:<span class="hljs-number">27</span> EDT; <span class="hljs-number">1</span>h <span class="hljs-number">53</span>min ago<br>     Docs: man:firewalld(<span class="hljs-number">1</span>)<br> Main PID: <span class="hljs-number">6710</span> (firewalld)<br>   CGroup: <span class="hljs-regexp">/system.slice/</span>firewalld.service<br>           └─<span class="hljs-number">6710</span> <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/python -Es /u</span>sr<span class="hljs-regexp">/sbin/</span>firewalld --nofork --nopid<br><br>Jun <span class="hljs-number">30</span> <span class="hljs-number">08</span>:<span class="hljs-number">30</span>:<span class="hljs-number">25</span> node1 systemd[<span class="hljs-number">1</span>]: Starting firewalld - dynamic firewall daemon...<br>Jun <span class="hljs-number">30</span> <span class="hljs-number">08</span>:<span class="hljs-number">30</span>:<span class="hljs-number">27</span> node1 systemd[<span class="hljs-number">1</span>]: Started firewalld - dynamic firewall daemon.<br><br>关闭防火墙：<br>[root@node1 zookeeper]<span class="hljs-comment"># systemctl stop firewalld</span><br><br>[root@node1 zookeeper]<span class="hljs-comment"># systemctl status firewalld</span><br>● firewalld.service - firewalld - dynamic firewall daemon<br>   Loaded: loaded (<span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/systemd/</span>system/firewalld.service; enabled; vendor preset: enabled)<br>   Active: inactive (dead) since Thu <span class="hljs-number">2022</span>-<span class="hljs-number">06</span>-<span class="hljs-number">30</span> <span class="hljs-number">10</span>:<span class="hljs-number">24</span>:<span class="hljs-number">13</span> EDT; <span class="hljs-number">1</span>s ago<br>     Docs: man:firewalld(<span class="hljs-number">1</span>)<br>  Process: <span class="hljs-number">6710</span> ExecStart=<span class="hljs-regexp">/usr/</span>sbin<span class="hljs-regexp">/firewalld --nofork --nopid $FIREWALLD_ARGS (code=exited, status=0/</span>SUCCESS)<br> Main PID: <span class="hljs-number">6710</span> (code=exited, status=<span class="hljs-number">0</span>/SUCCESS)<br><br>Jun <span class="hljs-number">30</span> <span class="hljs-number">08</span>:<span class="hljs-number">30</span>:<span class="hljs-number">25</span> node1 systemd[<span class="hljs-number">1</span>]: Starting firewalld - dynamic firewall daemon...<br>Jun <span class="hljs-number">30</span> <span class="hljs-number">08</span>:<span class="hljs-number">30</span>:<span class="hljs-number">27</span> node1 systemd[<span class="hljs-number">1</span>]: Started firewalld - dynamic firewall daemon.<br>Jun <span class="hljs-number">30</span> <span class="hljs-number">10</span>:<span class="hljs-number">24</span>:<span class="hljs-number">12</span> node1 systemd[<span class="hljs-number">1</span>]: Stopping firewalld - dynamic firewall daemon...<br>Jun <span class="hljs-number">30</span> <span class="hljs-number">10</span>:<span class="hljs-number">24</span>:<span class="hljs-number">13</span> node1 systemd[<span class="hljs-number">1</span>]: Stopped firewalld - dynamic firewall daemon.<br><br>禁止防护墙开机启动：<br>[root@node1 zookeeper]<span class="hljs-comment"># systemctl disable firewalld.service</span><br>Removed symlink <span class="hljs-regexp">/etc/</span>systemd<span class="hljs-regexp">/system/mu</span>lti-user.target.wants/firewalld.service.<br>Removed symlink <span class="hljs-regexp">/etc/</span>systemd<span class="hljs-regexp">/system/</span>dbus-org.fedoraproject.FirewallD1.service.<br><br>查看防火墙状态：<br>[root@node1 zookeeper]<span class="hljs-comment"># firewall-cmd --state</span><br>not running<br></code></pre></td></tr></table></figure><h2 id="2、kafka集群部署"><a href="#2、kafka集群部署" class="headerlink" title="2、kafka集群部署"></a>2、kafka集群部署</h2><p>​    在20.2.56.143，20.2.56.144，20.2.56.140这3台服务器上部署kafka。</p><p>部署包：zookeeper-3.4.11.tar.gz</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget https:<span class="hljs-regexp">//</span>archive.apache.org<span class="hljs-regexp">/dist/</span>zookeeper<span class="hljs-regexp">/zookeeper-3.4.11/</span>zookeeper-<span class="hljs-number">3.4</span>.<span class="hljs-number">11</span>.tar.gz<br>或者用本地已有的也可<br></code></pre></td></tr></table></figure><h3 id="准备Kafka的安装包"><a href="#准备Kafka的安装包" class="headerlink" title="准备Kafka的安装包"></a>准备Kafka的安装包</h3><p>解压压缩包，放到/home/gw/software/目录下。在/home/gw/software目录下给zookeeper创建一个软链接。</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs tap">tar xf kafka_2.11-2.1.1.tgz -C /home/gw/software/<br>ln -s kafka_2.11-2.1.1 kafka<br>[root@node1 tmp]<span class="hljs-comment"># cd /home/gw/software/</span><br>[root@node1 software]<span class="hljs-comment"># ln -s kafka_2.11-2.1.1 kafka</span><br>[root@node2 software]<span class="hljs-comment"># ll</span><br>total 12<br>drwxr-xr-x. <span class="hljs-number"> 8 </span>root root <span class="hljs-number"> 4096 </span>Jun<span class="hljs-number"> 29 </span>09:34 jdk1.8.0_172<br>drwxr-xr-x. <span class="hljs-number"> 6 </span>root root <span class="hljs-number"> 4096 </span>Feb <span class="hljs-number"> 8 </span><span class="hljs-number"> 2019 </span>kafka_2.11-2.1.1<br>lrwxrwxrwx. <span class="hljs-number"> 1 </span>root root   <span class="hljs-number"> 16 </span>Jun<span class="hljs-number"> 29 </span>09:20 zookeeper -&gt; zookeeper-3.4.11<br>drwxr-xr-x.<span class="hljs-number"> 13 </span><span class="hljs-number"> 502 </span>games<span class="hljs-number"> 4096 </span>Jun<span class="hljs-number"> 29 </span>10:17 zookeeper-3.4.11<br></code></pre></td></tr></table></figure><h3 id="修改-server-properties文件"><a href="#修改-server-properties文件" class="headerlink" title="修改 server.properties文件"></a>修改 server.properties文件</h3><p>1）在/home/gw/software/kafka/目录下，需要创建2个目录。一个data目录，一个logs目录。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkdir -p <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>kafka/logs<br>mkdir <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>kafka/data<br></code></pre></td></tr></table></figure><p>如果已经有这2个目录了，请将这2个目录的数据清空。(注意是清理要部署的服务器的。)</p><p>2）修改配置文件<br>         vi config/server.properties</p><p>  配置文件里的内容有但不限于以下内容。配置前，确认该服务器上8092端口没有被占用。配置文件里面的值以下面的值为准:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">broker.id</span>=<span class="hljs-number">0</span>                              <span class="hljs-comment">#同一集群中保持唯一</span><br><span class="hljs-attr">listeners</span>=PLAINTEXT://<span class="hljs-number">20.2</span>.<span class="hljs-number">56.143</span>:<span class="hljs-number">9092</span>  <span class="hljs-comment">#ip改成当前机器ip</span><br><span class="hljs-attr">log.dirs</span>=/home/gw/software/kafka/logs/<br><br><span class="hljs-comment"># 这个168表示kafka的日志保存168个小时，即7天。只要7天内将kafka内的数据消费了就行。</span><br><span class="hljs-attr">log.retention.hours</span>=<span class="hljs-number">168</span><br><span class="hljs-attr">log.segment.bytes</span>=<span class="hljs-number">1073741824</span><br><br><span class="hljs-comment"># 这个zookeeper配置我们部署好的zookeeper的服务地址。</span><br><span class="hljs-attr">zookeeper.connect</span>=<span class="hljs-number">20.2</span>.<span class="hljs-number">56.143</span>:<span class="hljs-number">2186</span>,<span class="hljs-number">20.2</span>.<span class="hljs-number">56.144</span>:<span class="hljs-number">2186</span>,<span class="hljs-number">20.2</span>.<span class="hljs-number">56.140</span>:<span class="hljs-number">2186</span>   //是<span class="hljs-number">2186</span>端口<br></code></pre></td></tr></table></figure><h3 id="其它两台服务器部署"><a href="#其它两台服务器部署" class="headerlink" title="其它两台服务器部署"></a>其它两台服务器部署</h3><p>​    其它两台服务器的部署和20.2.56.143一样。部署前检查服务器上是否已经占用了9092端口。只是在配置server.properties文件时，需要注意以下两项：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">broker</span>.id的值:<br><span class="hljs-attribute">20</span>.<span class="hljs-number">2</span>.<span class="hljs-number">56</span>.<span class="hljs-number">143</span>的broker.id的值是<span class="hljs-number">0</span>，<span class="hljs-number">20.2.56.144</span>的broker.id的值需要设置为<span class="hljs-number">1</span>，<span class="hljs-number">20.2.56.140</span>的broker.id的值需要设置为<span class="hljs-number">2</span>。<br></code></pre></td></tr></table></figure><h3 id="启动命令"><a href="#启动命令" class="headerlink" title="启动命令"></a>启动命令</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>kafka<br>bin<span class="hljs-regexp">/kafka-server-start.sh -daemon config/</span>server.properties<br></code></pre></td></tr></table></figure><h3 id="关闭命令"><a href="#关闭命令" class="headerlink" title="关闭命令"></a>关闭命令</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">bin/kafka-server-<span class="hljs-built_in">stop</span>.sh <span class="hljs-built_in">stop</span><br>或者将进程<span class="hljs-built_in">kill</span>掉。<br></code></pre></td></tr></table></figure><h3 id="提供服务"><a href="#提供服务" class="headerlink" title="提供服务"></a>提供服务</h3><p>​    20.2.56.143,20.2.56.144,20.2.56.140这3台服务器上的kafka部署完毕后，kafka对外提供服务的地址就是:</p><p>​    20.2.56.143:9092,20.2.56.144:9092,20.2.56.140:9092</p><h3 id="验证集群是否搭建成功"><a href="#验证集群是否搭建成功" class="headerlink" title="验证集群是否搭建成功"></a>验证集群是否搭建成功</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">启动成功后进⼊Zookeeper中，在<span class="hljs-regexp">/brokers/i</span>ds下有 相应的brokerId数据代表集群搭建成功：<br><span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>zookeeper<span class="hljs-regexp">/bin/</span>zkCli.sh  -server localhost:<span class="hljs-number">2186</span>     <br> ls <span class="hljs-regexp">/brokers/i</span>ds （ 反馈信息停止后，敲入此行命令后，会返回如下信息：）<br> [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]<br></code></pre></td></tr></table></figure><p><img src="image-20220704211429715-16569412017556.png" alt="image-20220704211429715"></p><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><p>创建topic:</p><p>cd /home/gw/software/kafka/bin/</p><p>./kafka-topics.sh –zookeeper 192.168.23.101:2186  –create –topic test  –replication-factor 1 –partitions 1</p><p>./kafka-topics.sh –zookeeper 192.168.23.101:2186  –create –topic test  –replication-factor 2 –partitions 3</p><p>查看 topic:</p><p>./kafka-topics.sh –zookeeper 192.168.23.101:2186  –list</p><p>./kafka-topics.sh –zookeeper 192.168.23.101:2186  –describe  –topic test</p><p>删除topic:</p><p>./kafka-topics.sh –zookeeper 192.168.23.101:2186  –delete –topic test</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.140:2186 --create --topic test004 --replication-factor 1 --partitions 1</span><br><span class="hljs-string">Created</span> <span class="hljs-string">topic</span> <span class="hljs-string">&quot;test004&quot;</span><span class="hljs-string">.</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.140:2186 --list</span><br><span class="hljs-string">test</span><br><span class="hljs-string">test001</span><br><span class="hljs-string">test004</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.140:2186 --create --topic test005 --replication-factor 2 --partitions 3</span><br><span class="hljs-string">Created</span> <span class="hljs-string">topic</span> <span class="hljs-string">&quot;test005&quot;</span><span class="hljs-string">.</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.140:2186 --list</span><br><span class="hljs-string">test</span><br><span class="hljs-string">test001</span><br><span class="hljs-string">test004</span><br><span class="hljs-string">test005</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.144:2186 --create --topic test003 --replication-factor 2 --partitions 3</span><br><span class="hljs-string">Created</span> <span class="hljs-string">topic</span> <span class="hljs-string">&quot;test003&quot;</span><span class="hljs-string">.</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.140:2186 --list</span><br><span class="hljs-string">test</span><br><span class="hljs-string">test001</span><br><span class="hljs-string">test003</span><br><span class="hljs-string">test004</span><br><span class="hljs-string">test005</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --create --topic test006 --replication-factor 2 --partitions 3</span><br><span class="hljs-string">Created</span> <span class="hljs-string">topic</span> <span class="hljs-string">&quot;test006&quot;</span><span class="hljs-string">.</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --list</span><br><span class="hljs-string">test</span><br><span class="hljs-string">test001</span><br><span class="hljs-string">test003</span><br><span class="hljs-string">test004</span><br><span class="hljs-string">test005</span><br><span class="hljs-string">test006</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --describe --topictest</span><br><span class="hljs-string">Exception</span> <span class="hljs-string">in</span> <span class="hljs-string">thread</span> <span class="hljs-string">&quot;main&quot;</span> <span class="hljs-attr">joptsimple.UnrecognizedOptionException:</span> <span class="hljs-string">topictest</span> <span class="hljs-string">is</span> <span class="hljs-string">not</span> <span class="hljs-string">a</span> <span class="hljs-string">recognized</span> <span class="hljs-string">option</span><br><span class="hljs-string">at</span> <span class="hljs-string">joptsimple.OptionException.unrecognizedOption(OptionException.java:108)</span><br><span class="hljs-string">at</span> <span class="hljs-string">joptsimple.OptionParser.handleLongOptionToken(OptionParser.java:510)</span><br><span class="hljs-string">at</span> <span class="hljs-string">joptsimple.OptionParserState$2.handleArgument(OptionParserState.java:56)</span><br><span class="hljs-string">at</span> <span class="hljs-string">joptsimple.OptionParser.parse(OptionParser.java:396)</span><br><span class="hljs-string">at</span> <span class="hljs-string">kafka.admin.TopicCommand$TopicCommandOptions.&lt;init&gt;(TopicCommand.scala:361)</span><br><span class="hljs-string">at</span> <span class="hljs-string">kafka.admin.TopicCommand$.main(TopicCommand.scala:44)</span><br><span class="hljs-string">at</span> <span class="hljs-string">kafka.admin.TopicCommand.main(TopicCommand.scala)</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --describe --topic test</span><br><span class="hljs-string">Topic:test</span><span class="hljs-string">PartitionCount:3</span><span class="hljs-string">ReplicationFactor:2</span><span class="hljs-attr">Configs:</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">0</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">0</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">0</span><span class="hljs-string">,1</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">0</span><span class="hljs-string">,1</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">1</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">1</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">1</span><span class="hljs-string">,2</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">1</span><span class="hljs-string">,2</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">2</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">2</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">2</span><span class="hljs-string">,0</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">2</span><span class="hljs-string">,0</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --describe --topic test001</span><br><span class="hljs-string">Topic:test001</span><span class="hljs-string">PartitionCount:1</span><span class="hljs-string">ReplicationFactor:1</span><span class="hljs-attr">Configs:</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test001</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">0</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">0</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">0</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">0</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --describe --topic test002</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --describe --topic test003</span><br><span class="hljs-string">Topic:test003</span><span class="hljs-string">PartitionCount:3</span><span class="hljs-string">ReplicationFactor:2</span><span class="hljs-attr">Configs:</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test003</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">0</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">1</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">1</span><span class="hljs-string">,2</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">1</span><span class="hljs-string">,2</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test003</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">1</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">2</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">2</span><span class="hljs-string">,0</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">2</span><span class="hljs-string">,0</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test003</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">2</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">0</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">0</span><span class="hljs-string">,1</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">0</span><span class="hljs-string">,1</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --describe --topic test004</span><br><span class="hljs-string">Topic:test004</span><span class="hljs-string">PartitionCount:1</span><span class="hljs-string">ReplicationFactor:1</span><span class="hljs-attr">Configs:</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test004</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">0</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">2</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">2</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">2</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --describe --topic test006</span><br><span class="hljs-string">Topic:test006</span><span class="hljs-string">PartitionCount:3</span><span class="hljs-string">ReplicationFactor:2</span><span class="hljs-attr">Configs:</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test006</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">0</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">0</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">0</span><span class="hljs-string">,2</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">0</span><span class="hljs-string">,2</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test006</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">1</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">1</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">1</span><span class="hljs-string">,0</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">1</span><span class="hljs-string">,0</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test006</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">2</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">2</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">2</span><span class="hljs-string">,1</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">2</span><span class="hljs-string">,1</span><br>[<span class="hljs-string">root@iZ9ur01td940v35skimdc9Z</span> <span class="hljs-string">kafka</span>]<span class="hljs-comment"># bin/kafka-topics.sh --zookeeper 20.2.56.143:2186 --describe --topic test005</span><br><span class="hljs-string">Topic:test005</span><span class="hljs-string">PartitionCount:3</span><span class="hljs-string">ReplicationFactor:2</span><span class="hljs-attr">Configs:</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test005</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">0</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">2</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">2</span><span class="hljs-string">,0</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">2</span><span class="hljs-string">,0</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test005</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">1</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">0</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">0</span><span class="hljs-string">,1</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">0</span><span class="hljs-string">,1</span><br><span class="hljs-attr">Topic:</span> <span class="hljs-string">test005</span><span class="hljs-attr">Partition:</span> <span class="hljs-number">2</span><span class="hljs-attr">Leader:</span> <span class="hljs-number">1</span><span class="hljs-attr">Replicas:</span> <span class="hljs-number">1</span><span class="hljs-string">,2</span><span class="hljs-attr">Isr:</span> <span class="hljs-number">1</span><span class="hljs-string">,2</span><br><br></code></pre></td></tr></table></figure><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">### 查看kafka数据是否有积压<br></code></pre></td></tr></table></figure><p>​    以group的ID（具体group ID的值需要看具体项目中的配置）为tracers0601为例，连接kafka的一个点即可。，查看积压的命令如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">bin/kafka-consumer-groups<span class="hljs-selector-class">.sh</span> <span class="hljs-attr">--new-consumer</span> <span class="hljs-attr">--bootstrap-server</span> ip:<span class="hljs-number">9092</span> <span class="hljs-attr">--group</span> tracers0601 <span class="hljs-attr">--describe</span><br></code></pre></td></tr></table></figure><p> 里面有一列是LAG，如果LAG的值不是0，则是有积压。</p><h3 id="查看一个kafka的所有group-ID"><a href="#查看一个kafka的所有group-ID" class="headerlink" title="查看一个kafka的所有group ID"></a>查看一个kafka的所有group ID</h3><p>​    连接一个kafka节点，即可查询。命令如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">bin/kafka-consumer-groups<span class="hljs-selector-class">.sh</span> <span class="hljs-attr">--bootstrap-server</span> ip:<span class="hljs-number">9092</span> <span class="hljs-attr">--list</span><br></code></pre></td></tr></table></figure><p>​    我们看到该kafka集群有目前只有一个group ID，为aggregation-group-per。</p><p>​    只有跑过业务，才会自动生成这些group ID。如果该kafka还没有接入过业务，是不会有group ID的内容的。</p><h2 id="3、elasticsearch-2-3-集群部署"><a href="#3、elasticsearch-2-3-集群部署" class="headerlink" title="3、elasticsearch 2.3 集群部署"></a>3、elasticsearch 2.3 集群部署</h2><p>部署3台服务器,具体版本已现场要求为准，以现在6.3使用的elasticsearch版本为准。</p><p>​    我们在20.2.56.142,20.2.56.139,20.2.56.141这3台服务器上部署elasticsearch。</p><h3 id="部署步骤"><a href="#部署步骤" class="headerlink" title="部署步骤"></a>部署步骤</h3><h3 id="elasticsearch安装包"><a href="#elasticsearch安装包" class="headerlink" title="elasticsearch安装包"></a>elasticsearch安装包</h3><p>解压压缩包，放到/home/gw/software/目录下。：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">tar xf elasticsearch-<span class="hljs-number">2.3</span>.<span class="hljs-number">5</span>.tar.gz -C <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span><br></code></pre></td></tr></table></figure><h3 id="检查配置机器环境"><a href="#检查配置机器环境" class="headerlink" title="检查配置机器环境"></a>检查配置机器环境</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs stata">vi /etc/security/limits.<span class="hljs-keyword">conf</span><br>添加如下内容，如已有，则不添加：<br><span class="hljs-comment">* soft nofile 65536 </span><br><span class="hljs-comment">* hard nofile 131072 </span><br><span class="hljs-comment">* soft nproc 2048 </span><br><span class="hljs-comment">* hard nproc 4096</span><br><br>vi /etc/sysctl.<span class="hljs-keyword">conf</span> 文件最后添加一行<br>vm.max_map_count=262144<br><br>保存退出后，执行命令：<br>sysctl -p<br></code></pre></td></tr></table></figure><h3 id="修改-elasticsearch-yml文件"><a href="#修改-elasticsearch-yml文件" class="headerlink" title="修改 elasticsearch.yml文件"></a>修改 elasticsearch.yml文件</h3><p>创建目录</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkdir -p <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">2.3</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/logs &amp;&amp; mkdir -p /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-2.3.5/</span>data<br>cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">2.3</span>.<span class="hljs-number">5</span>/config &amp;&amp; cp elasticsearch.yml elasticsearch.yml.bak<br> <br> ecs-<span class="hljs-number">4</span><br>cat &gt; <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">2.3</span>.<span class="hljs-number">5</span><span class="hljs-regexp">/config/</span>elasticsearch.yml &lt;&lt;EOF  <br><span class="hljs-comment">#集群的名称</span><br>cluster.name: es2.<span class="hljs-number">3</span><br><span class="hljs-comment">#节点名称,其余两个节点分别为node-2 和node-3</span><br>node.name: node-<span class="hljs-number">1</span><br><span class="hljs-comment">#指定该节点是否有资格被选举成为master节点，默认是true，es是默认集群中的第一台机器为master，如果这台机挂了就会重新选举master</span><br>node.master: true<br><span class="hljs-comment">#允许该节点存储数据(默认开启)</span><br>node.data: true<br><span class="hljs-comment">#索引数据的存储路径</span><br>path.data: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">2.3</span>.<span class="hljs-number">5</span>/data<br><span class="hljs-comment">#日志文件的存储路径</span><br>path.logs: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">2.3</span>.<span class="hljs-number">5</span>/logs<br><span class="hljs-comment">#设置为true来锁住内存。因为内存交换到磁盘对服务器性能来说是致命的，当jvm开始swapping时es的效率会降低，所以要保证它不swap</span><br><span class="hljs-comment">#bootstrap.memory_lock: true</span><br><span class="hljs-comment">#绑定的ip地址  (每个节点都配置自己的IP)</span><br>network.host: <span class="hljs-number">20.2</span>.<span class="hljs-number">56.142</span><br><span class="hljs-comment">#设置对外服务的http端口，默认为9200</span><br>http.port: <span class="hljs-number">9202</span><br><span class="hljs-comment"># 设置节点间交互的tcp端口,默认是9400</span><br>transport.tcp.port: <span class="hljs-number">9400</span><br><span class="hljs-comment">#Elasticsearch将绑定到可用的环回地址，并将扫描端口9400到9405以尝试连接到运行在同一台服务器上的其他节点。</span><br><span class="hljs-comment">#这提供了自动集群体验，而无需进行任何配置。数组设置或逗号分隔的设置。每个值的形式应该是host:port或host</span><br><span class="hljs-comment">#（如果没有设置，port默认设置会transport.profiles.default.port 回落到transport.tcp.port）。</span><br><span class="hljs-comment">#请注意，IPv6主机必须放在括号内。默认为127.0.0.1, [::1]</span><br>discovery.zen.ping.unicast.hosts: [<span class="hljs-string">&quot;20.2.56.142:9400&quot;</span>, <span class="hljs-string">&quot;20.2.56.139:9400&quot;</span>, <span class="hljs-string">&quot;20.2.56.141:9400&quot;</span>]<br><span class="hljs-comment">#如果没有这种设置,遭受网络故障的集群就有可能将集群分成两个独立的集群 - 分裂的大脑 - 这将导致数据丢失</span><br>discovery.zen.minimum_master_nodes: <span class="hljs-number">3</span><br><br>network.publish_host: <span class="hljs-number">20.2</span>.<span class="hljs-number">56.142</span>  <span class="hljs-comment">#服务器ip即可</span><br><br>EOF<br></code></pre></td></tr></table></figure><h3 id="在es用户下部署"><a href="#在es用户下部署" class="headerlink" title="在es用户下部署"></a>在es用户下部署</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">groupadd <span class="hljs-built_in">es</span>  &amp;&amp; useradd <span class="hljs-built_in">es</span> -g <span class="hljs-built_in">es</span>   <br>chown -R <span class="hljs-built_in">es</span>:<span class="hljs-built_in">es</span> /home/gw/software/elasticsearch-<span class="hljs-number">2.3</span><span class="hljs-number">.5</span><br></code></pre></td></tr></table></figure><h3 id="JDK安装："><a href="#JDK安装：" class="headerlink" title="JDK安装："></a>JDK安装：</h3><p>将 jdk1.8.0_131.tgz 上传到 /home/gw/software 目录下，解压安装</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">tar -xzvf ~<span class="hljs-regexp">/downloads/</span>jdk1.<span class="hljs-number">8.0</span>_131.tgz -C <span class="hljs-regexp">/home/g</span>w/software <br></code></pre></td></tr></table></figure><p>编辑~/.bash_profile文件，增加如下内容</p><p>vi ~/.bash_profile</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">[es@node5 ~]$ vim ~/.bash_profile<br>PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$HOME</span>/.local/bin:<span class="hljs-variable">$HOME</span>/bin<br>JAVA_HOME=/home/gw/software/jdk1.8.0_172/jre<br>JRE_HOME=<span class="hljs-variable">$JAVA_HOME</span><br><span class="hljs-built_in">export</span> JAVA_HOME JRE_HOME<br>PATH=<span class="hljs-variable">$JAVA_HOME</span>/bin:<span class="hljs-variable">$JRE_HOME</span>/bin:<span class="hljs-variable">$PAT</span><br><span class="hljs-built_in">export</span> PATH=/bin:/usr/bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> PATH<br></code></pre></td></tr></table></figure><p>执行如下命令，使配置生效</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> ~/.bash_profile <br></code></pre></td></tr></table></figure><p>验证：  java  -version</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">[es@node5 ~]$ <span class="hljs-keyword">java </span>-version<br><span class="hljs-keyword">java </span>version <span class="hljs-string">&quot;1.8.0_172&quot;</span><br><span class="hljs-keyword">Java(TM) </span>SE Runtime Environment (<span class="hljs-keyword">build </span><span class="hljs-number">1</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>_172-<span class="hljs-keyword">b11)</span><br><span class="hljs-keyword"></span><span class="hljs-keyword">Java </span>HotSpot(TM) <span class="hljs-number">64</span>-<span class="hljs-keyword">Bit </span>Server VM (<span class="hljs-keyword">build </span><span class="hljs-number">25</span>.<span class="hljs-number">172</span>-<span class="hljs-keyword">b11, </span>mixed mode)<br></code></pre></td></tr></table></figure><h3 id="启动服务："><a href="#启动服务：" class="headerlink" title="启动服务："></a>启动服务：</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">su - es<br>cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">2.3</span>.<span class="hljs-number">5</span> &amp;&amp; .<span class="hljs-regexp">/bin/</span>elasticsearch -d<br></code></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="其它两台服务器部署-1"><a href="#其它两台服务器部署-1" class="headerlink" title="其它两台服务器部署"></a>其它两台服务器部署</h3><p>​    其它两台服务器的部署和上述步骤一样，注意server.properties文件更改即可。</p><h2 id="其他一些记录："><a href="#其他一些记录：" class="headerlink" title="其他一些记录："></a>其他一些记录：</h2><ol><li>如果es需要分角色部署，可以参考<a href="https://blog.imdst.com/elasticsearchji-qun-bu-shu-wen-dang/">https://blog.imdst.com/elasticsearchji-qun-bu-shu-wen-dang/</a><br>主要区别在于：<br>节点：    node.master  node.data   node.name   network.host<br>master:  true          true       es-master    es-001<br>client:  false         true       es-clinet    es-002<br>data:    true          false      es-data      es-003 </li><li>日志目录：<br>/home/gw/software/elasticsearch/logs</li></ol><h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><p>查看端口</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vim">[es@iZ9ur01td940v35skimdccZ elasticsearch-<span class="hljs-number">2.3</span>.<span class="hljs-number">5</span>]$ netstat -utpln|<span class="hljs-keyword">grep</span> <span class="hljs-number">9202</span><br>(Not <span class="hljs-keyword">all</span> processes could <span class="hljs-keyword">be</span> identified, non-owned process info<br> will not <span class="hljs-keyword">be</span> shown, you would have <span class="hljs-keyword">to</span> <span class="hljs-keyword">be</span> root <span class="hljs-keyword">to</span> see it <span class="hljs-keyword">all</span>.)<br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">20.2</span>.<span class="hljs-number">56.142</span>:<span class="hljs-number">9202</span>        <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">5330</span>/java<br><br>[es@iZ9ur01td940v35skimdcdZ software]$ netstat -utpln|<span class="hljs-keyword">grep</span> <span class="hljs-number">9202</span><br>(Not <span class="hljs-keyword">all</span> processes could <span class="hljs-keyword">be</span> identified, non-owned process info<br> will not <span class="hljs-keyword">be</span> shown, you would have <span class="hljs-keyword">to</span> <span class="hljs-keyword">be</span> root <span class="hljs-keyword">to</span> see it <span class="hljs-keyword">all</span>.)<br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">20.2</span>.<span class="hljs-number">56.139</span>:<span class="hljs-number">9202</span>        <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">2134</span>/java           <br>[es@iZ9ur01td940v35skimdcdZ software]$ timed out waiting <span class="hljs-keyword">for</span> <span class="hljs-built_in">input</span>: auto-logout<br><br>[root@iZ9ur01td940v35skimdceZ ~]# netstat -utpln|<span class="hljs-keyword">grep</span> <span class="hljs-number">9202</span><br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">20.2</span>.<span class="hljs-number">56.141</span>:<span class="hljs-number">9202</span>        <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">2292</span>/java  <br><br></code></pre></td></tr></table></figure><p>安装插件</p><h3 id="下载：elasticsearch-head-crx"><a href="#下载：elasticsearch-head-crx" class="headerlink" title="下载：elasticsearch-head.crx"></a>下载：elasticsearch-head.crx</h3><p>扩展程序—&gt;</p><p>创建索引：</p><p><img src="image-20220704211909579-16569412017555.png" alt="image-20220704211909579"></p><p>==================</p><h1 id="4、elasticsearch-6-3-集群部署"><a href="#4、elasticsearch-6-3-集群部署" class="headerlink" title="4、elasticsearch 6.3 集群部署"></a>4、elasticsearch 6.3 集群部署</h1><p>​    部署3台服务器,具体版本已现场要求为准，以现在6.3使用的elasticsearch版本为准。</p><p>​    我们在20.2.56.142,20.2.56.139 ,20.2.56.141这3台服务器上部署elasticsearch。</p><h2 id="部署步骤-1"><a href="#部署步骤-1" class="headerlink" title="部署步骤"></a>部署步骤</h2><h3 id="elasticsearch安装包-1"><a href="#elasticsearch安装包-1" class="headerlink" title="elasticsearch安装包"></a>elasticsearch安装包</h3><p>先在172.31.47.15上部署,部署包地址：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">wget</span> https://mirrors.huaweicloud.com/elasticsearch/<span class="hljs-number">6</span>.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>/elasticsearch-<span class="hljs-number">6</span>.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>.tar.gz<br></code></pre></td></tr></table></figure><p>解压压缩包，放到/home/gw/software/目录下。：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tar</span> -zxf elasticsearch-<span class="hljs-number">6</span>.<span class="hljs-number">3</span>.<span class="hljs-number">0</span>.tar.gz <br></code></pre></td></tr></table></figure><h3 id="检查配置机器环境-1"><a href="#检查配置机器环境-1" class="headerlink" title="检查配置机器环境"></a>检查配置机器环境</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs stata">vi /etc/security/limits.<span class="hljs-keyword">conf</span><br>添加如下内容，如已有，则不添加：<br><span class="hljs-comment">* soft nofile 65536 </span><br><span class="hljs-comment">* hard nofile 131072 </span><br><span class="hljs-comment">* soft nproc 2048 </span><br><span class="hljs-comment">* hard nproc 4096</span><br><br>vi /etc/sysctl.<span class="hljs-keyword">conf</span> 文件最后添加一行<br>vm.max_map_count=262144<br>sysctl -p<br></code></pre></td></tr></table></figure><p>实践操作</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@iZ9ur01td940v35skimdccZ config]# grep -v ^# /etc/security/limits.<span class="hljs-keyword">conf</span> <br>root soft nofile 65535<br>root hard nofile 65535<br><span class="hljs-comment">* soft nofile 65536</span><br><span class="hljs-comment">* hard nofile 131072</span><br><span class="hljs-comment">* soft nproc 2048</span><br><span class="hljs-comment">* hard nproc 4096</span><br><br>[root@iZ9ur01td940v35skimdccZ config]# tail /etc/sysctl.<span class="hljs-keyword">conf</span> <br><span class="hljs-keyword">net</span>.ipv4.tcp_max_syn_backlog = 1024<br><span class="hljs-keyword">net</span>.ipv4.tcp_synack_retries = 2<br><br><span class="hljs-keyword">net</span>.ipv6.<span class="hljs-keyword">conf</span>.all.disable_ipv6 = 1<br><span class="hljs-keyword">net</span>.ipv6.<span class="hljs-keyword">conf</span>.default.disable_ipv6 = 1<br><span class="hljs-keyword">net</span>.ipv6.<span class="hljs-keyword">conf</span>.lo.disable_ipv6 = 1<br><br>kernel.sysrq=1<br><br>vm.max_map_count=262144<br>未作改动，之前在部署es2.3时已做配置<br></code></pre></td></tr></table></figure><h3 id="修改-elasticsearch-yml文件-1"><a href="#修改-elasticsearch-yml文件-1" class="headerlink" title="修改 elasticsearch.yml文件"></a>修改 elasticsearch.yml文件</h3><p>创建目录</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkdir -p <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/logs &amp;&amp; mkdir -p /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-6.3.0/</span>data<br>cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>/config &amp;&amp; cp elasticsearch.yml elasticsearch.yml.bak<br><br><br>ecs-<span class="hljs-number">4</span> <br>cat &gt; <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/config/</span>elasticsearch.yml &lt;&lt;EOF  <br><span class="hljs-comment">#集群的名称</span><br>cluster.name: elasticsearchs<br><span class="hljs-comment">#节点名称,其余两个节点分别为node-2 和node-3</span><br>node.name: node-<span class="hljs-number">1</span><br><span class="hljs-comment">#指定该节点是否有资格被选举成为master节点，默认是true，es是默认集群中的第一台机器为master，如果这台机挂了就会重新选举master</span><br>node.master: true<br><span class="hljs-comment">#允许该节点存储数据(默认开启)</span><br>node.data: true<br><span class="hljs-comment">#索引数据的存储路径</span><br>path.data: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>/data<br><span class="hljs-comment">#日志文件的存储路径</span><br>path.logs: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>/logs<br><span class="hljs-comment">#设置为true来锁住内存。因为内存交换到磁盘对服务器性能来说是致命的，当jvm开始swapping时es的效率会降低，所以要保证它不swap</span><br><span class="hljs-comment">#bootstrap.memory_lock: true</span><br><span class="hljs-comment">#绑定的ip地址  (每个节点都配置自己的IP)</span><br>network.host: <span class="hljs-number">20.2</span>.<span class="hljs-number">56.142</span><br><span class="hljs-comment">#设置对外服务的http端口，默认为9200</span><br>http.port: <span class="hljs-number">9201</span><br><span class="hljs-comment"># 设置节点间交互的tcp端口,默认是9400</span><br>transport.tcp.port: <span class="hljs-number">9300</span><br><span class="hljs-comment">#Elasticsearch将绑定到可用的环回地址，并将扫描端口9400到9405以尝试连接到运行在同一台服务器上的其他节点。</span><br><span class="hljs-comment">#这提供了自动集群体验，而无需进行任何配置。数组设置或逗号分隔的设置。每个值的形式应该是host:port或host</span><br><span class="hljs-comment">#（如果没有设置，port默认设置会transport.profiles.default.port 回落到transport.tcp.port）。</span><br><span class="hljs-comment">#请注意，IPv6主机必须放在括号内。默认为127.0.0.1, [::1]</span><br>discovery.zen.ping.unicast.hosts: [<span class="hljs-string">&quot;20.2.56.142:9300&quot;</span>, <span class="hljs-string">&quot;20.2.56.139:9300&quot;</span>, <span class="hljs-string">&quot;20.2.56.141:9300&quot;</span>]<br><span class="hljs-comment">#如果没有这种设置,遭受网络故障的集群就有可能将集群分成两个独立的集群 - 分裂的大脑 - 这将导致数据丢失</span><br>discovery.zen.minimum_master_nodes: <span class="hljs-number">3</span><br><br>network.publish_host: <span class="hljs-number">20.2</span>.<span class="hljs-number">56.142</span>  <span class="hljs-comment">#服务器ip</span><br><br>EOF<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs awk">ecs-<span class="hljs-number">5</span><br>cat &gt; <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/config/</span>elasticsearch.yml &lt;&lt;EOF  <br><span class="hljs-comment">#集群的名称</span><br>cluster.name: elasticsearchs<br><span class="hljs-comment">#节点名称,其余两个节点分别为node-1 和node-3</span><br>node.name: node-<span class="hljs-number">2</span><br><span class="hljs-comment">#指定该节点是否有资格被选举成为master节点，默认是true，es是默认集群中的第一台机器为master，如果这台机挂了就会重新选举master</span><br>node.master: true<br><span class="hljs-comment">#允许该节点存储数据(默认开启)</span><br>node.data: true<br><span class="hljs-comment">#索引数据的存储路径</span><br>path.data: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>/data<br><span class="hljs-comment">#日志文件的存储路径</span><br>path.logs: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>/logs<br><span class="hljs-comment">#设置为true来锁住内存。因为内存交换到磁盘对服务器性能来说是致命的，当jvm开始swapping时es的效率会降低，所以要保证它不swap</span><br><span class="hljs-comment">#bootstrap.memory_lock: true</span><br><span class="hljs-comment">#绑定的ip地址  (每个节点都配置自己的IP)</span><br>network.host: <span class="hljs-number">20.2</span>.<span class="hljs-number">56.139</span><br><span class="hljs-comment">#设置对外服务的http端口，默认为9200</span><br>http.port: <span class="hljs-number">9201</span><br><span class="hljs-comment"># 设置节点间交互的tcp端口,默认是9400</span><br>transport.tcp.port: <span class="hljs-number">9300</span><br><span class="hljs-comment">#Elasticsearch将绑定到可用的环回地址，并将扫描端口9400到9405以尝试连接到运行在同一台服务器上的其他节点。</span><br><span class="hljs-comment">#这提供了自动集群体验，而无需进行任何配置。数组设置或逗号分隔的设置。每个值的形式应该是host:port或host</span><br><span class="hljs-comment">#（如果没有设置，port默认设置会transport.profiles.default.port 回落到transport.tcp.port）。</span><br><span class="hljs-comment">#请注意，IPv6主机必须放在括号内。默认为127.0.0.1, [::1]</span><br>discovery.zen.ping.unicast.hosts: [<span class="hljs-string">&quot;20.2.56.142:9300&quot;</span>, <span class="hljs-string">&quot;20.2.56.139:9300&quot;</span>, <span class="hljs-string">&quot;20.2.56.141:9300&quot;</span>]<br><span class="hljs-comment">#如果没有这种设置,遭受网络故障的集群就有可能将集群分成两个独立的集群 - 分裂的大脑 - 这将导致数据丢失</span><br>discovery.zen.minimum_master_nodes: <span class="hljs-number">3</span><br><br>network.publish_host: <span class="hljs-number">20.2</span>.<span class="hljs-number">56.139</span>  <span class="hljs-comment">#服务器ip</span><br><br>EOF<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs awk">ecs-<span class="hljs-number">6</span><br>cat &gt; <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/config/</span>elasticsearch.yml &lt;&lt;EOF  <br><span class="hljs-comment">#集群的名称</span><br>cluster.name: elasticsearchs<br><span class="hljs-comment">#节点名称,其余两个节点分别为node-1 和node-2</span><br>node.name: node-<span class="hljs-number">3</span><br><span class="hljs-comment">#指定该节点是否有资格被选举成为master节点，默认是true，es是默认集群中的第一台机器为master，如果这台机挂了就会重新选举master</span><br>node.master: true<br><span class="hljs-comment">#允许该节点存储数据(默认开启)</span><br>node.data: true<br><span class="hljs-comment">#索引数据的存储路径</span><br>path.data: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>/data<br><span class="hljs-comment">#日志文件的存储路径</span><br>path.logs: <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>/logs<br><span class="hljs-comment">#设置为true来锁住内存。因为内存交换到磁盘对服务器性能来说是致命的，当jvm开始swapping时es的效率会降低，所以要保证它不swap</span><br><span class="hljs-comment">#bootstrap.memory_lock: true</span><br><span class="hljs-comment">#绑定的ip地址  (每个节点都配置自己的IP)</span><br>network.host: <span class="hljs-number">20.2</span>.<span class="hljs-number">56.141</span><br><span class="hljs-comment">#设置对外服务的http端口，默认为9200</span><br>http.port: <span class="hljs-number">9201</span><br><span class="hljs-comment"># 设置节点间交互的tcp端口,默认是9400</span><br>transport.tcp.port: <span class="hljs-number">9300</span><br><span class="hljs-comment">#Elasticsearch将绑定到可用的环回地址，并将扫描端口9400到9405以尝试连接到运行在同一台服务器上的其他节点。</span><br><span class="hljs-comment">#这提供了自动集群体验，而无需进行任何配置。数组设置或逗号分隔的设置。每个值的形式应该是host:port或host</span><br><span class="hljs-comment">#（如果没有设置，port默认设置会transport.profiles.default.port 回落到transport.tcp.port）。</span><br><span class="hljs-comment">#请注意，IPv6主机必须放在括号内。默认为127.0.0.1, [::1]</span><br>discovery.zen.ping.unicast.hosts: [<span class="hljs-string">&quot;20.2.56.142:9300&quot;</span>, <span class="hljs-string">&quot;20.2.56.139:9300&quot;</span>, <span class="hljs-string">&quot;20.2.56.141:9300&quot;</span>]<br><span class="hljs-comment">#如果没有这种设置,遭受网络故障的集群就有可能将集群分成两个独立的集群 - 分裂的大脑 - 这将导致数据丢失</span><br>discovery.zen.minimum_master_nodes: <span class="hljs-number">3</span><br><br>network.publish_host: <span class="hljs-number">20.2</span>.<span class="hljs-number">56.141</span>  <span class="hljs-comment">#服务器ip</span><br><br>EOF<br></code></pre></td></tr></table></figure><h3 id="在es用户下部署-1"><a href="#在es用户下部署-1" class="headerlink" title="在es用户下部署"></a>在es用户下部署</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">groupadd <span class="hljs-built_in">es</span>  &amp;&amp; useradd <span class="hljs-built_in">es</span> -g <span class="hljs-built_in">es</span>   <br>chown -R <span class="hljs-built_in">es</span>:<span class="hljs-built_in">es</span> /home/gw/software/elasticsearch-<span class="hljs-number">6.3</span><span class="hljs-number">.0</span><br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@iZ9ur01td940v35skimdccZ config]# ll -d <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>/<br>drwxr-xr-x <span class="hljs-number">9</span> es es <span class="hljs-number">4096</span> Jun <span class="hljs-number">18</span> <span class="hljs-number">01</span>:<span class="hljs-number">47</span> <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>/<br>之前已经做了授权<br></code></pre></td></tr></table></figure><h3 id="启动服务：-1"><a href="#启动服务：-1" class="headerlink" title="启动服务："></a>启动服务：</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">su - es<br>cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span> &amp;&amp; .<span class="hljs-regexp">/bin/</span>elasticsearch -d<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">[es@iZ9ur01td940v35skimdccZ elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>]$ .<span class="hljs-regexp">/bin/</span>elasticsearch -d<br>[es@iZ9ur01td940v35skimdccZ elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>]$ ps -ef|grep ela<br>es        <span class="hljs-number">5330</span>     <span class="hljs-number">1</span>  <span class="hljs-number">0</span> <span class="hljs-number">17</span>:<span class="hljs-number">29</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">29</span> <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>jdk1.<span class="hljs-number">8.0</span>_172<span class="hljs-regexp">/jre/</span>bin<span class="hljs-regexp">/java -Xms256m -Xmx1g -Djava.awt.headless=true -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:+HeapDumpOnOutOfMemoryError -XX:+DisableExplicitGC -Dfile.encoding=UTF-8 -Djna.nosys=true -Des.path.home=/</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-2.3.5 -cp /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-2.3.5/</span>lib<span class="hljs-regexp">/elasticsearch-2.3.5.jar:/</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-2.3.5/</span>lib/* org.elasticsearch.bootstrap.Elasticsearch start -d<br>es        <span class="hljs-number">5810</span>     <span class="hljs-number">1</span> <span class="hljs-number">99</span> <span class="hljs-number">19</span>:<span class="hljs-number">13</span> pts<span class="hljs-regexp">/0    00:00:13 /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/jdk1.8.0_172/</span>jre<span class="hljs-regexp">/bin/</span>java -Xms1g -Xmx1g -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=<span class="hljs-number">75</span> -XX:+UseCMSInitiatingOccupancyOnly -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-<span class="hljs-number">8</span> -Djna.nosys=true -XX:-OmitStackTraceInFastThrow -Dio.netty.noUnsafe=true -Dio.netty.noKeySetOptimization=true -Dio.netty.recycler.maxCapacityPerThread=<span class="hljs-number">0</span> -Dlog4j.shutdownHookEnabled=false -Dlog4j2.disable.jmx=true -Djava.io.tmpdir=<span class="hljs-regexp">/tmp/</span>elasticsearch.<span class="hljs-number">8</span>BBnuDh4 -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=data -XX:ErrorFile=logs<span class="hljs-regexp">/hs_err_pid%p.log -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintTenuringDistribution -XX:+PrintGCApplicationStoppedTime -Xloggc:logs/g</span>c.log -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=<span class="hljs-number">32</span> -XX:GCLogFileSize=<span class="hljs-number">64</span>m -Des.path.home=<span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span> -Des.path.conf=<span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/config -Des.distribution.flavor=default -Des.distribution.type=tar -cp /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-6.3.0/</span>lib/* org.elasticsearch.bootstrap.Elasticsearch -d<br>es        <span class="hljs-number">5825</span>  <span class="hljs-number">5810</span>  <span class="hljs-number">0</span> <span class="hljs-number">19</span>:<span class="hljs-number">13</span> pts<span class="hljs-regexp">/0    00:00:00 /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-6.3.0/m</span>odules<span class="hljs-regexp">/x-pack/</span>x-pack-ml<span class="hljs-regexp">/platform/</span>linux-x86_64<span class="hljs-regexp">/bin/</span>controller<br>es        <span class="hljs-number">5836</span>  <span class="hljs-number">5729</span>  <span class="hljs-number">0</span> <span class="hljs-number">19</span>:<span class="hljs-number">13</span> pts/<span class="hljs-number">0</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> grep --color=auto ela<br><br></code></pre></td></tr></table></figure><p>启动服务后，进程很快就又消失了。</p><p>启动日志</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><p>网上查看博客，建议修改java.policy</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[es@iZ9ur01td940v35skimdceZ security]$ tail java.policy <br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.specification.name&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.version&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.vendor&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.name&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br><br>        permission javax.management.MBeanTrustPermission <span class="hljs-string">&quot;register&quot;</span>;<br><br><br>&#125;;<br><br>[es@iZ9ur01td940v35skimdceZ security]$ tail java.policy bak/java.policy <br>==&gt; java.policy &lt;==<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.specification.name&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.version&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.vendor&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.name&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br><br>        permission javax.management.MBeanTrustPermission <span class="hljs-string">&quot;register&quot;</span>;<br><br><br>&#125;;<br><br><br>==&gt; bak/java.policy &lt;==<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.version&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.vendor&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.util.PropertyPermission <span class="hljs-string">&quot;java.vm.name&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br><br>        permission javax.management.MBeanTrustPermission <span class="hljs-string">&quot;register&quot;</span>;<br>        #permission java.security.AllPermission;  <span class="hljs-comment">//注释后，启动报错，删掉后可启动</span><br>&#125;;<br>[es@iZ9ur01td940v35skimdceZ elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>]$ bin/elasticsearch -d<br>[es@iZ9ur01td940v35skimdceZ elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>]$ java.security.policy: error parsing <span class="hljs-keyword">file</span>:<span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>jdk1.<span class="hljs-number">8.0</span>_172<span class="hljs-regexp">/jre/</span>lib<span class="hljs-regexp">/security/</span>java.policy:<br>line <span class="hljs-number">50</span>: expected permission entry<br><br></code></pre></td></tr></table></figure><p>ecs-6启动正常后</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">[es@iZ9ur01td940v35skimdceZ elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>]$ netstat -utpln|grep <span class="hljs-number">9300</span><br>(Not all processes could be identified, non-owned process info<br> will not be shown, you would have to be root to see it all.)<br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">20.2</span>.<span class="hljs-number">56.141</span>:<span class="hljs-number">9300</span>        <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">5745</span>/java           <br>[es@iZ9ur01td940v35skimdceZ elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>]$ netstat -utpln|grep <span class="hljs-number">9201</span><br>(Not all processes could be identified, non-owned process info<br> will not be shown, you would have to be root to see it all.)<br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">20.2</span>.<span class="hljs-number">56.141</span>:<span class="hljs-number">9201</span>        <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">5745</span>/java           <br>[es@iZ9ur01td940v35skimdceZ elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span>]$ ps -ef|grep ela<br>es        <span class="hljs-number">2292</span>     <span class="hljs-number">1</span>  <span class="hljs-number">0</span> <span class="hljs-number">02</span>:<span class="hljs-number">34</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">05</span>:<span class="hljs-number">57</span> <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>jdk1.<span class="hljs-number">8.0</span>_172<span class="hljs-regexp">/jre/</span>bin<span class="hljs-regexp">/java -Xms256m -Xmx1g -Djava.awt.headless=true -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:+HeapDumpOnOutOfMemoryError -XX:+DisableExplicitGC -Dfile.encoding=UTF-8 -Djna.nosys=true -Des.path.home=/</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-2.3.5 -cp /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-2.3.5/</span>lib<span class="hljs-regexp">/elasticsearch-2.3.5.jar:/</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-2.3.5/</span>lib/* org.elasticsearch.bootstrap.Elasticsearch start -d<br>es        <span class="hljs-number">5745</span>     <span class="hljs-number">1</span>  <span class="hljs-number">4</span> <span class="hljs-number">20</span>:<span class="hljs-number">03</span> pts<span class="hljs-regexp">/0    00:00:22 /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/jdk1.8.0_172/</span>jre<span class="hljs-regexp">/bin/</span>java -Xms1g -Xmx1g -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=<span class="hljs-number">75</span> -XX:+UseCMSInitiatingOccupancyOnly -XX:+AlwaysPreTouch -Xss1m -Djava.awt.headless=true -Dfile.encoding=UTF-<span class="hljs-number">8</span> -Djna.nosys=true -XX:-OmitStackTraceInFastThrow -Dio.netty.noUnsafe=true -Dio.netty.noKeySetOptimization=true -Dio.netty.recycler.maxCapacityPerThread=<span class="hljs-number">0</span> -Dlog4j.shutdownHookEnabled=false -Dlog4j2.disable.jmx=true -Djava.io.tmpdir=<span class="hljs-regexp">/tmp/</span>elasticsearch.vRY4RBBM -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=data -XX:ErrorFile=logs<span class="hljs-regexp">/hs_err_pid%p.log -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintTenuringDistribution -XX:+PrintGCApplicationStoppedTime -Xloggc:logs/g</span>c.log -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=<span class="hljs-number">32</span> -XX:GCLogFileSize=<span class="hljs-number">64</span>m -Des.path.home=<span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span> -Des.path.conf=<span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">6.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/config -Des.distribution.flavor=default -Des.distribution.type=tar -cp /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-6.3.0/</span>lib/* org.elasticsearch.bootstrap.Elasticsearch -d<br>es        <span class="hljs-number">5760</span>  <span class="hljs-number">5745</span>  <span class="hljs-number">0</span> <span class="hljs-number">20</span>:<span class="hljs-number">03</span> pts<span class="hljs-regexp">/0    00:00:00 /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-6.3.0/m</span>odules<span class="hljs-regexp">/x-pack/</span>x-pack-ml<span class="hljs-regexp">/platform/</span>linux-x86_64<span class="hljs-regexp">/bin/</span>controller<br>es        <span class="hljs-number">5991</span>  <span class="hljs-number">4996</span>  <span class="hljs-number">0</span> <span class="hljs-number">20</span>:<span class="hljs-number">11</span> pts/<span class="hljs-number">0</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> grep --color=auto ela<br><br></code></pre></td></tr></table></figure><h3 id="其它两台服务器部署-2"><a href="#其它两台服务器部署-2" class="headerlink" title="其它两台服务器部署"></a>其它两台服务器部署</h3><p>​    其它两台服务器的部署和上述步骤一样，注意server.properties文件更改即可。</p><h3 id="es集群装完后，电脑谷歌浏览器装个elasticsearch-head插件就可以访问es"><a href="#es集群装完后，电脑谷歌浏览器装个elasticsearch-head插件就可以访问es" class="headerlink" title="es集群装完后，电脑谷歌浏览器装个elasticsearch-head插件就可以访问es"></a>es集群装完后，电脑谷歌浏览器装个elasticsearch-head插件就可以访问es</h3><h3 id="ik分词器的一些配置更改，暂时先不操作"><a href="#ik分词器的一些配置更改，暂时先不操作" class="headerlink" title="ik分词器的一些配置更改，暂时先不操作!!!"></a>ik分词器的一些配置更改，暂时先不操作!!!</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs javascript">vi  /home/gw/software/elasticsearch-<span class="hljs-number">6.3</span><span class="hljs-number">.0</span>/plugins/ik/config/<span class="hljs-title class_">IKAnalyzer</span>.<span class="hljs-property">cfg</span>.<span class="hljs-property">xml</span><br><br>&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;<br>&lt;!<span class="hljs-variable constant_">DOCTYPE</span> properties <span class="hljs-variable constant_">SYSTEM</span> <span class="hljs-string">&quot;http://java.sun.com/dtd/properties.dtd&quot;</span>&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">comment</span>&gt;</span>IK Analyzer 扩展配置<span class="hljs-tag">&lt;/<span class="hljs-name">comment</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-comment">&lt;!--用户可以在这里配置自己的扩展字典 --&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;ext_dict&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">entry</span>&gt;</span></span><br><span class="language-xml">         <span class="hljs-comment">&lt;!--用户可以在这里配置自己的扩展停止词字典--&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;ext_stopwords&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">entry</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-comment">&lt;!--用户可以在这里配置远程扩展字典 --&gt;</span></span><br><span class="language-xml">        <span class="hljs-comment">&lt;!-- &lt;entry key=&quot;remote_ext_dict&quot;&gt;words_location&lt;/entry&gt; --&gt;</span></span><br><span class="language-xml">        <span class="hljs-comment">&lt;!--</span></span><br><span class="hljs-comment"><span class="language-xml">        &lt;entry key=&quot;remote_ext_dict&quot;&gt;https://172.28.5.36:31388/kc/manage/wordsvc/msa/loadExtDict.dic&lt;/entry&gt;</span></span><br><span class="hljs-comment"><span class="language-xml">        &lt;entry key=&quot;remote_ext_stopwords&quot;&gt;&lt;/entry&gt;</span></span><br><span class="hljs-comment"><span class="language-xml">         --&gt;</span></span><br><span class="language-xml">        <span class="hljs-comment">&lt;!--用户可以在这里配置远程扩展停止词字典--&gt;</span></span><br><span class="language-xml">        <span class="hljs-comment">&lt;!-- &lt;entry key=&quot;remote_ext_stopwords&quot;&gt;words_location&lt;/entry&gt; --&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span></span><br><br><br>主要修改 <span class="hljs-attr">https</span>:<span class="hljs-comment">//172.28.5.36:31388   修改完后，重启es可能无法解析，需要修改jdk的java.policy文件</span><br>cd /home/gw/software/jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>/jre/lib/security  <br>vim  java.<span class="hljs-property">policy</span><br>grant &#123;<br>        <span class="hljs-comment">// Allows any thread to stop itself using the java.lang.Thread.stop()</span><br>        <span class="hljs-comment">// method that takes no argument.</span><br>        <span class="hljs-comment">// Note that this permission is granted by default only to remain</span><br>        <span class="hljs-comment">// backwards compatible.</span><br>        <span class="hljs-comment">// It is strongly recommended that you either remove this permission</span><br>        <span class="hljs-comment">// from this policy file or further restrict it to code sources</span><br>        <span class="hljs-comment">// that you specify, because Thread.stop() is potentially unsafe.</span><br>        <span class="hljs-comment">// See the API specification of java.lang.Thread.stop() for more</span><br>        <span class="hljs-comment">// information.</span><br>        permission java.<span class="hljs-property">lang</span>.<span class="hljs-property">RuntimePermission</span> <span class="hljs-string">&quot;stopThread&quot;</span>;<br><br>        <span class="hljs-comment">// allows anyone to listen on dynamic ports</span><br>        permission java.<span class="hljs-property">net</span>.<span class="hljs-property">SocketPermission</span> <span class="hljs-string">&quot;localhost:0&quot;</span>, <span class="hljs-string">&quot;listen&quot;</span>;<br>        permission java.<span class="hljs-property">net</span>.<span class="hljs-property">SocketPermission</span> <span class="hljs-string">&quot;172.28.5.6:31388&quot;</span>,<span class="hljs-string">&quot;connect,resolve&quot;</span>;<br><br>        <span class="hljs-comment">// &quot;standard&quot; properies that can be read by anyone</span><br><br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.version&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.vendor&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.vendor.url&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.class.version&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;os.name&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;os.version&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;os.arch&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;file.separator&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;path.separator&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;line.separator&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br><br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.specification.version&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.specification.vendor&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.specification.name&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br><br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.vm.specification.version&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.vm.specification.vendor&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.vm.specification.name&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.vm.version&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.vm.vendor&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>        permission java.<span class="hljs-property">util</span>.<span class="hljs-property">PropertyPermission</span> <span class="hljs-string">&quot;java.vm.name&quot;</span>, <span class="hljs-string">&quot;read&quot;</span>;<br>&#125;;<br><br></code></pre></td></tr></table></figure><h1 id="5、elasticsearch7-1-0-集群部署"><a href="#5、elasticsearch7-1-0-集群部署" class="headerlink" title="5、elasticsearch7.1.0 集群部署"></a>5、elasticsearch7.1.0 集群部署</h1><p>安装之前计算机资源的使用情况：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><p>为了方便后期管理，决定还是安装在4、5、6上。20.2.56.142,20.2.56.139,20.2.56.141</p><h2 id="部署步骤-2"><a href="#部署步骤-2" class="headerlink" title="部署步骤"></a>部署步骤</h2><h3 id="elasticsearch安装包-2"><a href="#elasticsearch安装包-2" class="headerlink" title="elasticsearch安装包"></a>elasticsearch安装包</h3><p>解压压缩包，放到/home/gw/software/目录下。</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node4 ~]<span class="hljs-comment"># tar xf /tmp/elasticsearch-7.10.2-linux-x86_64.tar.gz -C /home/gw/software/</span><br>[root@node4 ~]<span class="hljs-comment"># cd !$</span><br>cd /home/gw/software/<br>[root@node4 software]<span class="hljs-comment"># ll</span><br>total 16<br>drwxr-x---<span class="hljs-number"> 9 </span>es   es  <span class="hljs-number"> 4096 </span>Jun<span class="hljs-number"> 30 </span>17:29 elasticsearch-2.3.5<br>drwxr-xr-x<span class="hljs-number"> 9 </span>es   es  <span class="hljs-number"> 4096 </span>Jun<span class="hljs-number"> 30 </span>19:27 elasticsearch-6.3.0<br>drwxr-xr-x<span class="hljs-number"> 9 </span>root root<span class="hljs-number"> 4096 </span>Jan<span class="hljs-number"> 13 </span><span class="hljs-number"> 2021 </span>elasticsearch-7.10.2<br>drwxr-x---<span class="hljs-number"> 8 </span>es   es  <span class="hljs-number"> 4096 </span>Jun<span class="hljs-number"> 30 </span>01:47 jdk1.8.0_172<br><br></code></pre></td></tr></table></figure><h3 id="检查配置机器环境-2"><a href="#检查配置机器环境-2" class="headerlink" title="检查配置机器环境"></a>检查配置机器环境</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs stata">vi /etc/security/limits.<span class="hljs-keyword">conf</span><br>添加如下内容，如已有，则不添加：<br><span class="hljs-comment">* soft nofile 65536 </span><br><span class="hljs-comment">* hard nofile 131072 </span><br><span class="hljs-comment">* soft nproc 2048 </span><br><span class="hljs-comment">* hard nproc 4096</span><br><br>vi /etc/sysctl.<span class="hljs-keyword">conf</span> 文件最后添加一行<br>vm.max_map_count=262144<br>sysctl -p<br><br>之前部署es2.3时已做配置，最多只需确认如下即可：<br>[root@node4 software]# grep -v ^#  /etc/security/limits.<span class="hljs-keyword">conf</span> <br>root soft nofile 65535<br>root hard nofile 65535<br><span class="hljs-comment">* soft nofile 65536</span><br><span class="hljs-comment">* hard nofile 131072</span><br><span class="hljs-comment">* soft nproc 2048</span><br><span class="hljs-comment">* hard nproc 4096</span><br>[root@node4 software]# tail /etc/sysctl.<span class="hljs-keyword">conf</span> <br><span class="hljs-keyword">net</span>.ipv4.tcp_max_syn_backlog = 1024<br><span class="hljs-keyword">net</span>.ipv4.tcp_synack_retries = 2<br><br><span class="hljs-keyword">net</span>.ipv6.<span class="hljs-keyword">conf</span>.all.disable_ipv6 = 1<br><span class="hljs-keyword">net</span>.ipv6.<span class="hljs-keyword">conf</span>.default.disable_ipv6 = 1<br><span class="hljs-keyword">net</span>.ipv6.<span class="hljs-keyword">conf</span>.lo.disable_ipv6 = 1<br><br>kernel.sysrq=1<br><br>vm.max_map_count=262144<br><br><br></code></pre></td></tr></table></figure><h3 id="修改-elasticsearch-yml文件-2"><a href="#修改-elasticsearch-yml文件-2" class="headerlink" title="修改 elasticsearch.yml文件"></a>修改 elasticsearch.yml文件</h3><p>创建目录</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkdir -p <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">7.10</span>.<span class="hljs-number">2</span><span class="hljs-regexp">/logs &amp;&amp; mkdir -p /</span>home<span class="hljs-regexp">/gw/</span>software<span class="hljs-regexp">/elasticsearch-7.10.2/</span>data<br>cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">7.10</span>.<span class="hljs-number">2</span>/config &amp;&amp; cp elasticsearch.yml elasticsearch.yml.bak<br><br>node4<br>cat &gt; <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">7.10</span>.<span class="hljs-number">2</span><span class="hljs-regexp">/config/</span>elasticsearch.yml &lt;&lt;EOF  <br><span class="hljs-comment">#集群名称（此名称在任何节点的配置文件下都是一致的）</span><br>cluster.name: es-<span class="hljs-number">7.10</span><br><span class="hljs-comment">#节点名称(这里需要修改，第一个节点是 node-1，配置其他二个节点的时候就是 node-2,node-3)</span><br>node.name: node-<span class="hljs-number">1</span><br><span class="hljs-comment">#是不是有资格主节点</span><br>node.master: true<br><span class="hljs-comment">#是否存储数据</span><br>node.data: true<br><span class="hljs-comment">#最⼤集群节点数</span><br>node.max_local_storage_nodes: <span class="hljs-number">3</span><br><span class="hljs-comment">#换成服务器ip</span><br>network.host: <span class="hljs-number">20.2</span>.<span class="hljs-number">56.142</span><br><span class="hljs-comment">#端⼝</span><br>http.port: <span class="hljs-number">9207</span><br><span class="hljs-comment">#内部节点之间沟通端⼝</span><br>transport.tcp.port: <span class="hljs-number">9500</span><br><span class="hljs-comment">#es7.x 之后新增的配置，写⼊候选主节点的设备地址，在开启服务后可以被选为主节点</span><br><span class="hljs-comment"># 部署在一个服务器用于测试的的伪分布式就用不同的端口，真分布式的话自行修改ip地址</span><br>discovery.seed_hosts: [<span class="hljs-string">&quot;20.2.56.142:9500&quot;</span>,<span class="hljs-string">&quot;20.2.56.139:9500&quot;</span>,<span class="hljs-string">&quot;20.2.56.141:9500&quot;</span>]<br><span class="hljs-comment">#es7.x 之后新增的配置，初始化⼀个新的集群时需要此配置来选举master</span><br>cluster.initial_master_nodes: [<span class="hljs-string">&quot;node-1&quot;</span>, <span class="hljs-string">&quot;node-2&quot;</span>,<span class="hljs-string">&quot;node-3&quot;</span>]<br><span class="hljs-comment">#数据和存储路径</span><br>path.data: <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/elasticsearch-7.10.2/</span>data<br>path.logs: <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/elasticsearch-7.10.2/</span>logs<br><br>EOF<br><br></code></pre></td></tr></table></figure><h3 id="在es用户下部署-2"><a href="#在es用户下部署-2" class="headerlink" title="在es用户下部署"></a>在es用户下部署</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">groupadd <span class="hljs-built_in">es</span>  &amp;&amp; useradd <span class="hljs-built_in">es</span> -g <span class="hljs-built_in">es</span>   <br>chown -R <span class="hljs-built_in">es</span>:<span class="hljs-built_in">es</span> /home/gw/software/elasticsearch-<span class="hljs-number">7.10</span><span class="hljs-number">.2</span><br><br></code></pre></td></tr></table></figure><h3 id="启动服务：-2"><a href="#启动服务：-2" class="headerlink" title="启动服务："></a>启动服务：</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">su - es<br>cd <span class="hljs-regexp">/home/g</span>w<span class="hljs-regexp">/software/</span>elasticsearch-<span class="hljs-number">7.10</span>.<span class="hljs-number">2</span> &amp;&amp; .<span class="hljs-regexp">/bin/</span>elasticsearch -d<br><br><br></code></pre></td></tr></table></figure><h3 id="其它两台服务器部署-3"><a href="#其它两台服务器部署-3" class="headerlink" title="其它两台服务器部署"></a>其它两台服务器部署</h3><p>​    其它两台服务器的部署和上述步骤一样，注意server.properties文件更改即可。</p><h3 id="其他一些记录：-1"><a href="#其他一些记录：-1" class="headerlink" title="其他一些记录："></a>其他一些记录：</h3><ol><li><p>如果es需要分角色部署，可以参考<a href="https://blog.imdst.com/elasticsearchji-qun-bu-shu-wen-dang/">https://blog.imdst.com/elasticsearchji-qun-bu-shu-wen-dang/</a><br>主要区别在于：<br>节点：    node.master  node.data   node.name   network.host<br>master:  true          true       es-master    es-001<br>client:  false         true       es-clinet    es-002<br>data:    true          false      es-data      es-003 </p></li><li><p>日志目录：<br>/home/gw/software/elasticsearch/logs</p><h3 id="测试验证"><a href="#测试验证" class="headerlink" title="测试验证"></a>测试验证</h3><p>1、使用浏览器直接访问：</p><p><a href="http://20.2.56.142:9207/">http://20.2.56.142:9207/</a></p><p><a href="http://20.2.56.139:9207/">http://20.2.56.139:9207/</a></p><p><a href="http://20.2.56.141:9207/">http://20.2.56.141:9207/</a></p><p><img src="image-20220704212215575-16569412017557.png" alt="image-20220704212215575"></p></li></ol><p>​    2、使用es插件分别访问：</p><p><a href="http://20.2.56.142:9207/">http://20.2.56.142:9207/</a></p><p><a href="http://20.2.56.139:9207/">http://20.2.56.139:9207/</a></p><p><a href="http://20.2.56.141:9207/">http://20.2.56.141:9207/</a></p><p>下图是使用postman新建索引之后截图：</p><p><img src="image-20220704212355803-16569412017558.png" alt="image-20220704212355803"></p><p>​    3、使用postman创建索引 </p><p>put ：</p><p> <a href="http://20.2.56.142:9207/es7_test002">http://20.2.56.142:9207/es7_test002</a> </p><p>Body：</p><p>{</p><p>​    “settings”:{</p><p>​        “refresh_interval”:”-1”,</p><p>​        “number_of_shards”:”3”,</p><p>​        “number_of_replicas”:”2”</p><p>​    }</p><p>}</p><p>返回的Body信息：</p><p>{</p><p>​    “acknowledged”: true,</p><p>​    “shards_acknowledged”: true,</p><p>​    “index”: “es7_test002”</p><p>}</p><p><img src="%E4%B8%80%E3%80%81%E6%99%BA%E6%85%A7%E5%AE%A2%E6%9C%8D%E7%B3%BB%E7%BB%9F%E7%BB%84%E4%BB%B6%E9%83%A8%E7%BD%B2-2022-7-1/image-20220704212238032-16569412017559.png"></p>]]></content>
    
    
    <categories>
      
      <category>电力行业信息系统</category>
      
    </categories>
    
    
    <tags>
      
      <tag>组件部署</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第四周作业-2022-6-29</title>
    <link href="/2022/06/28/%E7%AC%AC%E5%9B%9B%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-29/"/>
    <url>/2022/06/28/%E7%AC%AC%E5%9B%9B%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-29/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>：报全程班和单就业的小伙伴，本周建议学习内容：第十五天、第十六天、第十七天 、第十八天。</p><span id="more"></span><p>请同学们完成作业后，将博客作业提交到此链接：<a href="https://www.wjx.top/vj/POHTQOH.aspx">https://www.wjx.top/vj/POHTQOH.aspx</a></p><h1 id="章节内容"><a href="#章节内容" class="headerlink" title="章节内容"></a>章节内容</h1><p>第十五天：进程和计划任务<br>1、shell脚本编程进阶符串切片和高级变量<br>2、Linux进程和内存管理<br>3、进程状态和相关概念<br>4、进程管理工具<br>5、性能相关工具<br>6、进程的前后执行和并发执行<br>7、任务计划管理”<br>第十六天：文本处理awk 内核管理<br>1、文本处理三剑客之awk基本用法<br>2、文本处理三剑客之awk基本用法<br>3、文本处理三剑客之awk高级用法<br>4、Linux启动流程和grub管理<br>5、Linux启动流程和服务管理<br>6、Linux的内核参数配置<br>7、systemd特性和内核编译安装”<br>第十七天：加密安全<br>1、systemd的服务service文件实现<br>2、target管理和grub2故障排错<br>3、安全机制和各种攻击方式实战<br>4、对称和非对称算法及单向哈希算法<br>5、加密综合应用及证书和CA<br>6、私有CA和openss配置文件详解<br>第十八天：加密安全2<br>1、实现私有CA和证书申请<br>2、证书管理和ssh服务工作原理<br>3、ssh客户端使用<br>4、ssh基于key验证<br>5、ssh高级用法及自动运维工具<br>6、sudo进行权限委派<br>7、pam模块功能和常用模块”</p><h1 id="作业："><a href="#作业：" class="headerlink" title="作业："></a>作业：</h1><h2 id="1、自定义写出10个定时任务的示例："><a href="#1、自定义写出10个定时任务的示例：" class="headerlink" title="1、自定义写出10个定时任务的示例："></a>1、自定义写出10个定时任务的示例：</h2><p>比如每周三凌晨三点执行data命令<br>要求尽量的覆盖各种场景</p><p>（1）每天8点对系统所有磁盘分区的磁盘使用率进行一次巡检，如有大于80%的，则立即发送告警邮件。</p><figure class="highlight bash"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><pre><code class="hljs bash">[root@node1 <span class="hljs-built_in">test</span>]<span class="hljs-comment"># cat /test/disk_check.sh </span><br><span class="hljs-comment">#!/bin/bash</span><br>warning=80<br>used=`<span class="hljs-built_in">df</span> |grep -Eo <span class="hljs-string">&#x27;[0-9]+%&#x27;</span>|grep -Eo [0-9]+ |<span class="hljs-built_in">sort</span> -rn|<span class="hljs-built_in">head</span> -1`<br>[ <span class="hljs-variable">$used</span> -gt <span class="hljs-variable">$warning</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> Disk will be full! |mail -s <span class="hljs-string">&#x27;diskwarning&#x27;</span> 253494546@qq.com<br><br>[root@node1 <span class="hljs-built_in">test</span>]<span class="hljs-comment"># chmod +x disk_check.sh</span><br>[root@node1 <span class="hljs-built_in">test</span>]<span class="hljs-comment"># crontab -l</span><br>* 9 * * * /test/disk_check.sh<br></code></pre></td></tr></table></figure><p>（2）因为查看业务软件日志对故障进行分析时，希望日志里显示的就是当时的实际时间，所以需要每周进行一次时钟同步，以保证时间的准确性。</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs perl">[root@node1 test]<span class="hljs-comment"># ntpdate ntp.ntsc.ac.cn</span><br> <span class="hljs-number">2</span> Jul <span class="hljs-number">21</span>:<span class="hljs-number">26</span>:<span class="hljs-number">00</span> ntpdate[<span class="hljs-number">11012</span>]: adjust <span class="hljs-keyword">time</span> server <span class="hljs-number">114.118</span>.<span class="hljs-number">7.161</span> offset -<span class="hljs-number">0</span>.<span class="hljs-number">01</span>9675 sec<br>[root@node1 test]<span class="hljs-comment"># date</span><br>Sat Jul  <span class="hljs-number">2</span> <span class="hljs-number">21</span>:<span class="hljs-number">26</span>:<span class="hljs-number">03</span> CST <span class="hljs-number">2022</span><br>[root@node1 test]<span class="hljs-comment"># crontab -l</span><br>* * * * */<span class="hljs-number">1</span> ntpdate ntp.ntsc.ac.cn<br></code></pre></td></tr></table></figure><p>（3）每周五23：50自动备份zookeeper的日志到/bak目录下 ，并以日期命名； </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node1 <span class="hljs-built_in">test</span>]<span class="hljs-comment"># cat zklog_backup.sh </span><br><span class="hljs-comment">#!/bin/bash</span><br>[ -d /bak ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Backup is ready&quot;</span> || <span class="hljs-built_in">mkdir</span> /bak &gt; /dev/null<br>tar -cf /bak/`<span class="hljs-built_in">date</span> +%F_%T`_zookeeper.out.tar.gz /home/gw/software/zookeeper/zookeeper.out &amp;&gt; /dev/null<br><span class="hljs-built_in">ls</span> -lrt /bak|<span class="hljs-built_in">tail</span> -1<br>[root@node1 <span class="hljs-built_in">test</span>]<span class="hljs-comment"># chmod +x zklog_backup.sh</span><br>[root@node1 <span class="hljs-built_in">test</span>]<span class="hljs-comment"># bash zklog_backup.sh </span><br>Backup is ready<br>-rw-r--r--. 1 root root 860160 Jul  2 22:36 2022-07-02_22:36:22_zookeeper.out.tar.gz<br><br>[root@node1 <span class="hljs-built_in">test</span>]<span class="hljs-comment"># crontab -l</span><br>50 23 * * 5 /test/zklog_backup.sh<br><br></code></pre></td></tr></table></figure><p>(4) 一般都是周六进行检修，周三可能就做一些检修的准备工作，备份配置文件就是准备工作之一，可制定每周二8：30进行备份。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 test]<span class="hljs-comment"># crontab -l</span><br><span class="hljs-number">30</span> <span class="hljs-number">8</span> * * <span class="hljs-number">2</span> <span class="hljs-regexp">/test/</span>config_backup.sh<br><br><br></code></pre></td></tr></table></figure><p>（5）每15分钟进行一次计算机资源监测，包括内存使用率、cpu使用率</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 test]<span class="hljs-comment"># crontab -l</span><br>*<span class="hljs-regexp">/15 * * * * /</span>test/monitor.sh<br></code></pre></td></tr></table></figure><p>（6）</p><p>（7）</p><p>（8）</p><p>（9）</p><p>（10）</p><h2 id="2、图文并茂说明Linux进程和内存概念"><a href="#2、图文并茂说明Linux进程和内存概念" class="headerlink" title="2、图文并茂说明Linux进程和内存概念"></a>2、图文并茂说明Linux进程和内存概念</h2><p>内存：<br>内存是计算机中重要的部件之一， 由内存芯片、电路板、金手指等部分组成，它是与CPU进行沟通的桥梁。<br>内存(Memory)也被称为内存储器，其作用是用于暂时存放CPU中的运算数据，以及与硬盘等外部存储器交换的数据。<br>计算机中所有程序的运行都是在内存中进行的，因此内存的性能对计算机的影响非常大。<br>只要计算机在运行中，CPU就会把需要运算的数据调到内存中进行运算，当运算完成后CPU再将结果传送出来，内存的运行也决定了计算机的稳定运行。</p><p><img src="1656514610098.png" alt="1656514610098"></p><p>进程：</p><p>进程是一个正在执行的程序；计算机中正在运行的程序实例；可以分配给处理器并由处理器执行的一个实体；由单一顺序的执行显示，一个当前状态和一组相关的系统资源所描述的活动单元。 </p><h2 id="3、图文并茂说明Linux启动流程"><a href="#3、图文并茂说明Linux启动流程" class="headerlink" title="3、图文并茂说明Linux启动流程"></a>3、图文并茂说明Linux启动流程</h2><p>操作系统的启动分为两个阶段：引导boot和启动startup。<br>引导阶段开始于打开电源开关，结束于内核初始化完成和 systemd 进程成功运行。<br>启动阶段接管了剩余工作，直到操作系统进入可操作状态。 </p><p>linux系统的启动流程可以分为以下步骤： POST（加电自检）–&gt;加载BIOS（Basic  Input/Outpu System)–&gt;确定启动设备（Boot sequence)、加载Boot  Loader–&gt;加载内核（kernel）初始化initrd–&gt;运行/sbin/init初始化系统–&gt;打印用户登录提示符 </p><p><img src="1656775025615.png" alt="1656775025615"></p><p> （1）POST开机自检<br>linux开机加电后，系统开始开机自检，该过程主要对计算机各种硬件设备进行检测，如CPU、内存、主板、硬盘、CMOS芯片等，如果出现致命故障则停机，并且由于初始化过程还没完成，所以不会出现任何提示信号；如果出现一般故障则会发出声音等提示信号，等待故障清除；若未出现故障，加电自检完成。 </p><p>（2）开机自检完成，查找可启动设备，加载主引导目录（MBR)<br>开机自检完成后，CPU首先读取位于CMOS中的BIOS程序，按照BIOS中设定的启动次序（Boot Sequence)逐一查找可启动设备,找到可启动的设备后，去该设备的第一个扇区 中读取MBR，那么MBR是什么哪？它又有什么作用哪？ MBR存在于可启动磁盘的0磁道0扇区，占用512字节，它主要用来告诉计算机从选定的可启动设备的哪个分区来加载引导加载程序（Boot loader)。<br>MBR中存在如下内容： 1、 Boot Loader 占用446字节，存储有操作系统（OS）相关信息，如操作系统名称，操作系统内核位置等，它的主要功能是加载内核到内存中运行。 2、 Partition Table 分区表，占用64字节，每个主分区占用16字节（这就是为啥一块硬盘只能有4个主分区啦^_^）  3、分区表有效性标记占用2字节  CPU将MBR读取至内存，运行GRUB(Boot Loader常用的有GRUB和LILO两种，现在常用的是GRUB），GRUB会把内核加载到内存去执行。 </p><p>（3）加载内核，初始化initrd<br>GRUB把内核加载到内存后展开并运行， 此时GRUB的任务已经完成，接下来内核将会接管并完成  探测硬件–&gt;加载驱动–&gt;挂载根文件系统–&gt;切换至根文件系统（rootfs）–&gt;运行/sbin/init完成系统初始化。GRUB在加载内核同时，也把initrd加载到内存中并运行。</p><p>（4）运行/sbin/init，进行系统初始化<br>内核并加载进内存运行并以读写方式挂载完根文件系统后，执行第一个用户进程init，init首先运行/etc/init/rcS.conf脚本，  init执行完/etc/rc.d/rc.sysinit后，将会执行/etc/inittab来设定系统运行的默认级别： linux中共有[0-6]七个运行级别，而我自己系统的默认运行级别是3. </p><p><img src="1656776015730.png" alt="1656776015730"></p><p> （5）打印登录提示符** 系统初始化完成后，init给出用户登 录提示符（login）或者图形化登录界面，用户输入用户和密码登陆后，系统会为用户分配一个用户ID（uid）和组ID（gid），这两个ID是用户的 <a href="https://cloud.tencent.com/solution/tb-digitalid?from=10680">身份标识</a>，用于检测用户运行程序时的<a href="https://cloud.tencent.com/product/mfas?from=10680">身份验证</a>。登录成功后，整个系统启动流程运行完毕！ </p><h2 id="4、自定义一个systemd服务"><a href="#4、自定义一个systemd服务" class="headerlink" title="4、自定义一个systemd服务"></a>4、自定义一个systemd服务</h2><p>定时去其他服务器上检查/tmp/下文件的个数，如果发现数量有变化就记录变化情况到文件中。</p><h2 id="5、写Linux内核编译安装博客"><a href="#5、写Linux内核编译安装博客" class="headerlink" title="5、写Linux内核编译安装博客"></a>5、写Linux内核编译安装博客</h2><h2 id="6、总结5个自我觉得比较有用的awk的使用场景，"><a href="#6、总结5个自我觉得比较有用的awk的使用场景，" class="headerlink" title="6、总结5个自我觉得比较有用的awk的使用场景，"></a>6、总结5个自我觉得比较有用的awk的使用场景，</h2><p>比如在什么情况下用awk处理文本效率最高，发散题，至少写1个。”</p><p>  (1)   计算VSZ和RSS各自的和 并以M单位显示。 VSZ 表示进程分配的虚拟内存。RSS 是常驻内存集（Resident Set Size），表示该进程分配的内存大小。</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@node1 ~]# ps aux | awk &#x27;BEGIN&#123;i=0&#125;NR&gt;=2&#123;VSZ+=<span class="hljs-variable">$5</span>;RSS+=<span class="hljs-variable">$6</span>;i++&#125;END&#123;<span class="hljs-keyword">print</span> <span class="hljs-string">&quot;process count = &quot;</span>i; <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;VSZ total = &quot;</span>VSZ/1024<span class="hljs-string">&quot;M&quot;</span> ; <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;RSS total = &quot;</span>RSS/1024<span class="hljs-string">&quot;M&quot;</span>&#125;&#x27;<br>process <span class="hljs-keyword">count</span> = 109<br>VSZ <span class="hljs-keyword">total</span> = 4026.38M<br>RSS <span class="hljs-keyword">total</span> = 109.633M<br></code></pre></td></tr></table></figure><p>（2）  统计系统中管理员、系统用户、普通用户的数量</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs swift">[root<span class="hljs-meta">@node1</span> <span class="hljs-operator">~</span>]# awk <span class="hljs-operator">-</span><span class="hljs-type">F</span>: &#x27;<span class="hljs-type">BEGIN</span>&#123;x<span class="hljs-operator">=</span><span class="hljs-number">0</span>;y<span class="hljs-operator">=</span><span class="hljs-number">0</span>;x<span class="hljs-operator">=</span><span class="hljs-number">0</span>&#125;&#123;<span class="hljs-keyword">if</span>(<span class="hljs-variable">$3</span><span class="hljs-operator">==</span><span class="hljs-number">0</span>)print <span class="hljs-variable">$1</span><span class="hljs-string">&quot;<span class="hljs-subst">\t</span>&quot;</span><span class="hljs-string">&quot;ADMIN&quot;</span> x<span class="hljs-operator">++</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$3</span><span class="hljs-operator">&gt;</span><span class="hljs-number">0</span> <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-variable">$3</span><span class="hljs-operator">&lt;</span><span class="hljs-number">500</span>) print <span class="hljs-variable">$1</span><span class="hljs-string">&quot;<span class="hljs-subst">\t</span>&quot;</span><span class="hljs-string">&quot;SYSUSER&quot;</span> y<span class="hljs-operator">++</span>;<span class="hljs-keyword">else</span> print <span class="hljs-variable">$1</span><span class="hljs-string">&quot;<span class="hljs-subst">\t</span>&quot;</span><span class="hljs-string">&quot;USER&quot;</span> z<span class="hljs-operator">++</span>&#125;<span class="hljs-type">END</span>&#123;print <span class="hljs-string">&quot;ADMIN COUNT = &quot;</span>x ; print <span class="hljs-string">&quot;SYSUSER COUNT = &quot;</span>y ; print <span class="hljs-string">&quot;USER COUNT = &quot;</span>z&#125;&#x27; <span class="hljs-operator">/</span>etc<span class="hljs-operator">/</span>passwd<br>root<span class="hljs-type">ADMIN0</span><br>bin<span class="hljs-type">SYSUSER0</span><br>daemon<span class="hljs-type">SYSUSER1</span><br>adm<span class="hljs-type">SYSUSER2</span><br>lp<span class="hljs-type">SYSUSER3</span><br>sync<span class="hljs-type">SYSUSER4</span><br>shutdown<span class="hljs-type">SYSUSER5</span><br>halt<span class="hljs-type">SYSUSER6</span><br>mail<span class="hljs-type">SYSUSER7</span><br><span class="hljs-keyword">operator</span><span class="hljs-type">SYSUSER8</span><br>games<span class="hljs-type">SYSUSER9</span><br>ftp<span class="hljs-type">SYSUSER10</span><br>nobody<span class="hljs-type">SYSUSER11</span><br>systemd<span class="hljs-operator">-</span>network<span class="hljs-type">SYSUSER12</span><br>dbus<span class="hljs-type">SYSUSER13</span><br>polkitd<span class="hljs-type">USER0</span><br>sshd<span class="hljs-type">SYSUSER14</span><br><span class="hljs-keyword">postfix</span><span class="hljs-type">SYSUSER15</span><br>chrony<span class="hljs-type">USER1</span><br>tyh<span class="hljs-type">USER2</span><br>ntp<span class="hljs-type">SYSUSER16</span><br><span class="hljs-type">ADMIN</span> <span class="hljs-type">COUNT</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br><span class="hljs-type">SYSUSER</span> <span class="hljs-type">COUNT</span> <span class="hljs-operator">=</span> <span class="hljs-number">17</span><br><span class="hljs-type">USER</span> <span class="hljs-type">COUNT</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>作业</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>初始化系统环境</title>
    <link href="/2022/06/26/%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83/"/>
    <url>/2022/06/26/%E5%88%9D%E5%A7%8B%E5%8C%96%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><span id="more"></span><h1 id="修改网卡名称"><a href="#修改网卡名称" class="headerlink" title="修改网卡名称"></a>修改网卡名称</h1><figure class="highlight gradle"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><pre><code class="hljs gradle">[root@localhost network-scripts]# sed -Ei.bak <span class="hljs-string">&#x27;/GRUB_CMDLINE_LINUX=/s/quiet.*$/quiet net.ifnames=0 biosdevname=0&quot;/&#x27;</span> <span class="hljs-regexp">/etc/</span><span class="hljs-keyword">default</span>/grub<br>[root@localhost network-scripts]# cat <span class="hljs-regexp">/etc/</span><span class="hljs-keyword">default</span>/grub<br>GRUB_TIMEOUT=<span class="hljs-number">5</span><br>GRUB_DISTRIBUTOR=<span class="hljs-string">&quot;$(sed &#x27;s, release .*$,,g&#x27; /etc/system-release)&quot;</span><br>GRUB_DEFAULT=saved<br>GRUB_DISABLE_SUBMENU=<span class="hljs-keyword">true</span><br>GRUB_TERMINAL_OUTPUT=<span class="hljs-string">&quot;console&quot;</span><br>GRUB_CMDLINE_LINUX=<span class="hljs-string">&quot;crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet net.ifnames=0 biosdevname=0&quot;</span><br>GRUB_DISABLE_RECOVERY=<span class="hljs-string">&quot;true&quot;</span><br>[root@localhost network-scripts]# ll <span class="hljs-regexp">/etc/</span><span class="hljs-keyword">default</span>/<br>total <span class="hljs-number">16</span><br>-rw-r--r--. <span class="hljs-number">1</span> root root  <span class="hljs-number">307</span> Jun <span class="hljs-number">28</span> <span class="hljs-number">11</span>:<span class="hljs-number">45</span> grub<br>-rw-r--r--. <span class="hljs-number">1</span> root root  <span class="hljs-number">293</span> Jun <span class="hljs-number">28</span> <span class="hljs-number">10</span>:<span class="hljs-number">09</span> grub.bak<br>-rw-r--r--. <span class="hljs-number">1</span> root root <span class="hljs-number">1756</span> Oct <span class="hljs-number">30</span>  <span class="hljs-number">2018</span> nss<br>-rw-r--r--. <span class="hljs-number">1</span> root root  <span class="hljs-number">119</span> Oct <span class="hljs-number">30</span>  <span class="hljs-number">2018</span> useradd<br>[root@localhost network-scripts]# grub2-mkconfig -o <span class="hljs-regexp">/boot/g</span>rub2/grub.cfg<br>Generating grub configuration <span class="hljs-keyword">file</span> ...<br>Found linux image: <span class="hljs-regexp">/boot/</span>vmlinuz-<span class="hljs-number">3.10</span>.<span class="hljs-number">0</span>-<span class="hljs-number">957</span>.el7.x86_64<br>Found initrd image: <span class="hljs-regexp">/boot/i</span>nitramfs-<span class="hljs-number">3.10</span>.<span class="hljs-number">0</span>-<span class="hljs-number">957</span>.el7.x86_64.img<br>Found linux image: <span class="hljs-regexp">/boot/</span>vmlinuz-<span class="hljs-number">0</span>-rescue-<span class="hljs-number">378</span>c51b5339e4dbbb29e0c20e8508196<br>Found initrd image: <span class="hljs-regexp">/boot/i</span>nitramfs-<span class="hljs-number">0</span>-rescue-<span class="hljs-number">378</span>c51b5339e4dbbb29e0c20e8508196.img<br>done<br></code></pre></td></tr></table></figure><h1 id="修改主机名"><a href="#修改主机名" class="headerlink" title="修改主机名"></a>修改主机名</h1><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@localhost</span> ~]<span class="hljs-meta"># hostnamectl set-hostname node2</span><br>[root<span class="hljs-symbol">@localhost</span> ~]<span class="hljs-meta"># hostname</span><br>node2<br>[root<span class="hljs-symbol">@localhost</span> ~]<span class="hljs-meta"># cat /etc/hostname </span><br>node2<br></code></pre></td></tr></table></figure><h1 id="系统时间"><a href="#系统时间" class="headerlink" title="系统时间"></a>系统时间</h1><h2 id="显示为24小时制"><a href="#显示为24小时制" class="headerlink" title="显示为24小时制"></a>显示为24小时制</h2><p>新部署的Linux服务器是12小时制的 ，使用date命令查看时，分不清是上午还是下午的时间，不利于进行日志分析。</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@node1 test]# cp <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/zoneinfo/</span>Asia<span class="hljs-regexp">/Shanghai /</span>etc/localtime <br>cp: overwrite ‘<span class="hljs-regexp">/etc/</span>localtime’? y<br>[root@node1 test]# date<br>Sat Jul  <span class="hljs-number">2</span> <span class="hljs-number">21</span>:<span class="hljs-number">16</span>:<span class="hljs-number">57</span> CST <span class="hljs-number">2022</span><br></code></pre></td></tr></table></figure><p>国内知名公共 NTP 服务器地址 </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs routeros">国家授时中心<span class="hljs-built_in"> NTP </span>服务器：ntp.ntsc.ac.cn<br>阿里云公共<span class="hljs-built_in"> NTP </span>服务器：<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time1.aliyun.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time2.aliyun.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time3.aliyun.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time4.aliyun.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time5.aliyun.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time6.aliyun.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time7.aliyun.com<br>腾讯云公共<span class="hljs-built_in"> NTP </span>服务器：<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time1.cloud.tencent.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time2.cloud.tencent.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time3.cloud.tencent.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time4.cloud.tencent.com<span class="hljs-built_in"></span><br><span class="hljs-built_in">ping </span>time5.cloud.tencent.com<br>[root@node1 test]# ntpdate ntp.ntsc.ac.cn<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>系统环境</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第三周作业-2022-6-20</title>
    <link href="/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/"/>
    <url>/2022/06/20/%E7%AC%AC%E4%B8%89%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-20/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>：报全程班和单就业的小伙伴，本周建议学习内容：第十一天、第十二天、第十三天 、第十四天。</p><span id="more"></span><p>请同学们完成作业后，将博客作业提交到此链接：<a href="https://www.wjx.top/vj/POHTQOH.aspx%E3%80%82">https://www.wjx.top/vj/POHTQOH.aspx。</a></p><h1 id="章节内容"><a href="#章节内容" class="headerlink" title="章节内容"></a>章节内容</h1><p>第十一天：<br>软件管理2<br>1、ubunut软件管理<br>2、磁盘类型和结构<br>3、MBR和GPT分区类型<br>4、文件系统管理<br>5、挂载管理和swap空间管理<br>6、移动设备和raid初步<br>7、raid工作原理和特性”<br>第十二天：<br>磁盘存储和文件系统管理<br>1、逻辑卷工作原理和创建<br>2、逻辑卷扩容和缩容及快照管理<br>3、网络和OSI分层结构<br>4、局域网及网络线缆<br>5、网络设备和局域网技术<br>6、tcpip协议和tcp详解<br>7、tcp协议三次握手和四次挥手详解”<br>第十三天：<br>网络协议和管理配置<br>1、udp和internet层协议<br>2、ip地址组成和分类<br>3、网络地址规划和子网划分<br>4、网卡配置文件和命令<br>5、网络路由和配置<br>6、多网卡绑定bond和team<br>7、网桥实现和网络工具”<br>第十四天：<br>shell脚本进阶<br>1、ununtu网络配置<br>2、shell脚本编程进阶while循环和控制<br>3、shell脚本进阶shift和select<br>4、shell脚本进阶函数实现<br>5、shell脚本进阶函数递归和信号捕捉<br>6、shell脚本进阶常用工具<br>7、shell脚本进阶数组”</p><h1 id="作业："><a href="#作业：" class="headerlink" title="作业："></a>作业：</h1><h2 id="1、图文并茂说明raid0-raid1-raid10-raid01-raid5等原理。"><a href="#1、图文并茂说明raid0-raid1-raid10-raid01-raid5等原理。" class="headerlink" title="1、图文并茂说明raid0,raid1, raid10, raid01, raid5等原理。"></a>1、图文并茂说明raid0,raid1, raid10, raid01, raid5等原理。</h2><p>独立硬盘冗余阵列（RAID, Redundant Array of Independent Disks），旧称廉价磁盘冗余阵列 （Redundant Array of Inexpensive Disks），简称磁盘阵列。利用虚拟化存储技术把多个硬盘组合起 来，成为一个或多个硬盘阵列组，目的为提升性能或数据冗余，或是两者同时提升。 </p><p>RAID功能实现：1、 提高IO能力，磁盘并行读写 ；2、提高耐用性，磁盘冗余算法来实现。 </p><p>（1）raid0,  条带集</p><p>以 chunk 单位,读写数据,因为读写时都可以并行处理，所以在所有的级别中，RAID 0的速度是最快的。 但是RAID 0既没有冗余功能，也不具备容错能力，如果一个磁盘（物理）损坏，所有数据都会丢失 .</p><p>磁盘利用率：100%</p><p>优点：读写速度快</p><p>缺点：不容错</p><p>硬盘个数：2+</p><p><img src="1656763185363.png" alt="1656763185363"></p><p>（2）raid1, 镜像集</p><p>也称为镜像, 两组以上的N个磁盘相互作镜像，在一些多线程操作系统中能有很好的读取速度，理论上读 取速度等于硬盘数量的倍数，与RAID 0相同。另外写入速度有微小的降低。 </p><p>磁盘利用率：50%</p><p>优点：读写速率一般，容错</p><p>硬盘个数：2</p><p><img src="1656763499122.png" alt="1656763499122"></p><p>（3）raid10, 先镜像后条带（RAID1的安全+RAID0的高速）</p><p>磁盘利用率：50%</p><p>优点：读写速率快，容错</p><p>硬盘个数：4</p><p><img src="1656763529259.png" alt="1656763529259"></p><p>（4）raid01, 先条带后镜像</p><p><img src="1656763543110.png" alt="1656763543110"></p><p>（5）raid5 ，带奇偶校验的条带集</p><p>磁盘利用率：(n-1)/n</p><p>优点：读写速率快，容错，允许坏一块硬盘</p><p>硬盘个数：3,3+</p><p><img src="1656763572737.png" alt="1656763572737"></p><p>（6）raid6，带奇偶校验的条带集（双份校验位,算法更复杂 ）</p><p>磁盘利用率：(n-2)/n</p><p>优点：读写速率快，容错，允许坏两块硬盘</p><p>硬盘个数：4,4+</p><p><img src="1656763589189.png" alt="1656763589189"></p><h2 id="2、创建一个至少有两个PV组成的大小为20G的名为testvg的VG，要求PE大小为16M，而后在卷组中创建大小为5G的逻辑卷testlv-挂载至-users目录"><a href="#2、创建一个至少有两个PV组成的大小为20G的名为testvg的VG，要求PE大小为16M，而后在卷组中创建大小为5G的逻辑卷testlv-挂载至-users目录" class="headerlink" title="2、创建一个至少有两个PV组成的大小为20G的名为testvg的VG，要求PE大小为16M，而后在卷组中创建大小为5G的逻辑卷testlv;挂载至/users目录"></a>2、创建一个至少有两个PV组成的大小为20G的名为testvg的VG，要求PE大小为16M，而后在卷组中创建大小为5G的逻辑卷testlv;挂载至/users目录</h2><p>（1）添加硬盘</p><p><img src="1656763749199.png" alt="1656763749199"></p><p>（2）此时系统还没有识别到新增加的硬盘 ，需要使用命令进行扫描硬盘</p><figure class="highlight tap"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><pre><code class="hljs tap">[root@node1 test]<span class="hljs-comment"># echo &#x27;- - -&#x27; &gt; /sys/class/scsi_host/host0/scan </span><br>[root@node1 test]<span class="hljs-comment"># ll /dev/sd*</span><br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 0 </span>Jun<span class="hljs-number"> 19 </span>07:45 /dev/sda<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 1 </span>Jun<span class="hljs-number"> 19 </span>07:45 /dev/sda1<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 2 </span>Jun<span class="hljs-number"> 19 </span>07:45 /dev/sda2<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 16 </span>Jun<span class="hljs-number"> 19 </span>07:45 /dev/sdb<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 32 </span>Jun<span class="hljs-number"> 20 </span>10:16 /dev/sdc<br>[root@node1 test]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm  /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm  [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>disk <br>sdc               8:32  <span class="hljs-number"> 0 </span>  18G <span class="hljs-number"> 0 </span>disk <br>sr0              11:0   <span class="hljs-number"> 1 </span> 4.4G <span class="hljs-number"> 0 </span>rom<br></code></pre></td></tr></table></figure><p>（3）创建PV</p><figure class="highlight irpf90"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs irpf90">[root@node1 test]# pvcreate /dev/sdb <br>  Physical volume <span class="hljs-string">&quot;/dev/sdb&quot;</span> successfully created.<br>   <br>[root@node1 test]# pvcreate /dev/sdc <br>  Physical volume <span class="hljs-string">&quot;/dev/sdc&quot;</span> successfully created.<br>  <br>[root@node1 test]# pvdisplay<br>  --- Physical volume ---<br>  PV <span class="hljs-keyword">Name</span>               /dev/sda2<br>  VG <span class="hljs-keyword">Name</span>               centos<br>  PV <span class="hljs-built_in">Size</span>               &lt;<span class="hljs-number">19.00</span> GiB / not usable <span class="hljs-number">3.00</span> MiB<br>  <span class="hljs-keyword">Allocatable</span>           yes (but full)<br>  PE <span class="hljs-built_in">Size</span>               <span class="hljs-number">4.00</span> MiB<br>  Total PE              <span class="hljs-number">4863</span><br>  <span class="hljs-keyword">Free</span> PE               <span class="hljs-number">0</span><br>  <span class="hljs-built_in">Allocated</span> PE          <span class="hljs-number">4863</span><br>  PV UUID               Pcy8Mo-duHv-KVJI-NGLy-CCln-pDEl-zUOaPV<br>   <br>  <span class="hljs-string">&quot;/dev/sdb&quot;</span> is a new physical volume of <span class="hljs-string">&quot;2.00 GiB&quot;</span><br>  --- NEW Physical volume ---<br>  PV <span class="hljs-keyword">Name</span>               /dev/sdb<br>  VG <span class="hljs-keyword">Name</span>               <br>  PV <span class="hljs-built_in">Size</span>               <span class="hljs-number">2.00</span> GiB<br>  <span class="hljs-keyword">Allocatable</span>           NO<br>  PE <span class="hljs-built_in">Size</span>               <span class="hljs-number">0</span>   <br>  Total PE              <span class="hljs-number">0</span><br>  <span class="hljs-keyword">Free</span> PE               <span class="hljs-number">0</span><br>  <span class="hljs-built_in">Allocated</span> PE          <span class="hljs-number">0</span><br>  PV UUID               sCiC1O-wM9v-ecWQ-Knx3-JCEx-jX4E-rLTmQ1<br>   <br>  <span class="hljs-string">&quot;/dev/sdc&quot;</span> is a new physical volume of <span class="hljs-string">&quot;18.00 GiB&quot;</span><br>  --- NEW Physical volume ---<br>  PV <span class="hljs-keyword">Name</span>               /dev/sdc<br>  VG <span class="hljs-keyword">Name</span>               <br>  PV <span class="hljs-built_in">Size</span>               <span class="hljs-number">18.00</span> GiB<br>  <span class="hljs-keyword">Allocatable</span>           NO<br>  PE <span class="hljs-built_in">Size</span>               <span class="hljs-number">0</span>   <br>  Total PE              <span class="hljs-number">0</span><br>  <span class="hljs-keyword">Free</span> PE               <span class="hljs-number">0</span><br>  <span class="hljs-built_in">Allocated</span> PE          <span class="hljs-number">0</span><br>  PV UUID               dsIn9M-LD1O-jD8R-<span class="hljs-number">6</span>S9b-i7ts-sJmG-GOz45s<br>  <br>  [root@node1 test]# pvs<br>  PV         VG     <span class="hljs-keyword">Fmt</span>  Attr PSize   PFree <br>  /dev/sda2  centos lvm2 a--  &lt;<span class="hljs-number">19.00</span>g     <span class="hljs-number">0</span> <br>  /dev/sdb          lvm2 ---    <span class="hljs-number">2.00</span>g  <span class="hljs-number">2.00</span>g<br>  /dev/sdc          lvm2 ---   <span class="hljs-number">18.00</span>g <span class="hljs-number">18.00</span>g<br></code></pre></td></tr></table></figure><p>（4）创建VG</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@node1 test]# vgcreate -s <span class="hljs-number">16</span>M testvg /dev/sdb /dev/sdc<br>  Volume <span class="hljs-keyword">group</span> &quot;testvg&quot; successfully created<br>  <br>[root@node1 test]# vgs<br>  VG     #PV #LV #SN Attr   VSize   VFree  <br>  centos   <span class="hljs-number">1</span>   <span class="hljs-number">2</span>   <span class="hljs-number">0</span> wz<span class="hljs-comment">--n- &lt;19.00g      0 </span><br>  testvg   <span class="hljs-number">2</span>   <span class="hljs-number">0</span>   <span class="hljs-number">0</span> wz<span class="hljs-comment">--n- &lt;19.97g &lt;19.97g</span><br>  <br>[root@node1 test]# vgdisplay<br>  <span class="hljs-comment">--- Volume group ---</span><br>  VG <span class="hljs-type">Name</span>               centos<br>  <span class="hljs-keyword">System</span> ID             <br>  <span class="hljs-keyword">Format</span>                lvm2<br>  Metadata Areas        <span class="hljs-number">1</span><br>  Metadata <span class="hljs-keyword">Sequence</span> <span class="hljs-keyword">No</span>  <span class="hljs-number">3</span><br>  VG <span class="hljs-keyword">Access</span>             <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  VG Status             resizable<br>  MAX LV                <span class="hljs-number">0</span><br>  Cur LV                <span class="hljs-number">2</span><br>  <span class="hljs-keyword">Open</span> LV               <span class="hljs-number">2</span><br>  Max PV                <span class="hljs-number">0</span><br>  Cur PV                <span class="hljs-number">1</span><br>  Act PV                <span class="hljs-number">1</span><br>  VG Size               &lt;<span class="hljs-number">19.00</span> GiB<br>  PE Size               <span class="hljs-number">4.00</span> MiB<br>  Total PE              <span class="hljs-number">4863</span><br>  Alloc PE / Size       <span class="hljs-number">4863</span> / &lt;<span class="hljs-number">19.00</span> GiB<br>  Free  PE / Size       <span class="hljs-number">0</span> / <span class="hljs-number">0</span>   <br>  VG <span class="hljs-type">UUID</span>               <span class="hljs-number">9</span>KnTtD<span class="hljs-number">-88</span>ve-B3cy-Ftc7-TplO-oVwc<span class="hljs-number">-5</span>SfeZh<br>   <br>  <span class="hljs-comment">--- Volume group ---</span><br>  VG <span class="hljs-type">Name</span>               testvg<br>  <span class="hljs-keyword">System</span> ID             <br>  <span class="hljs-keyword">Format</span>                lvm2<br>  Metadata Areas        <span class="hljs-number">2</span><br>  Metadata <span class="hljs-keyword">Sequence</span> <span class="hljs-keyword">No</span>  <span class="hljs-number">1</span><br>  VG <span class="hljs-keyword">Access</span>             <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  VG Status             resizable<br>  MAX LV                <span class="hljs-number">0</span><br>  Cur LV                <span class="hljs-number">0</span><br>  <span class="hljs-keyword">Open</span> LV               <span class="hljs-number">0</span><br>  Max PV                <span class="hljs-number">0</span><br>  Cur PV                <span class="hljs-number">2</span><br>  Act PV                <span class="hljs-number">2</span><br>  VG Size               &lt;<span class="hljs-number">19.97</span> GiB<br>  PE Size               <span class="hljs-number">16.00</span> MiB<br>  Total PE              <span class="hljs-number">1278</span><br>  Alloc PE / Size       <span class="hljs-number">0</span> / <span class="hljs-number">0</span>   <br>  Free  PE / Size       <span class="hljs-number">1278</span> / &lt;<span class="hljs-number">19.97</span> GiB<br>  VG <span class="hljs-type">UUID</span>               Jp1YqS-l0O0-vboZ-eLyu<span class="hljs-number">-4</span>w4M-pAGj-USbKEU<br></code></pre></td></tr></table></figure><p>（5）创建LV</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@node1 test]# lvcreate -L <span class="hljs-number">5</span>G -n testlv testvg<br>  Logical volume &quot;testlv&quot; created.<br>  <br>[root@node1 test]# lvs<br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  <span class="hljs-keyword">Move</span> <span class="hljs-keyword">Log</span> Cpy%Sync Convert<br>  root   centos -wi-ao<span class="hljs-comment">---- &lt;17.00g                                                    </span><br>  swap   centos -wi-ao<span class="hljs-comment">----   2.00g                                                    </span><br>  testlv testvg -wi-a<span class="hljs-comment">-----   5.00g     </span><br>  <br>[root@node1 test]# lvdisplay<br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/centos/swap<br>  LV <span class="hljs-type">Name</span>                swap<br>  VG <span class="hljs-type">Name</span>                centos<br>  LV <span class="hljs-type">UUID</span>                <span class="hljs-number">4</span>mNwDD-vOdz-y4WI<span class="hljs-number">-9</span>FlR-FufL-bt5c-Kh6gOq<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  LV Creation host, <span class="hljs-type">time</span> localhost, <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-08</span> <span class="hljs-number">15</span>:<span class="hljs-number">12</span>:<span class="hljs-number">57</span> <span class="hljs-number">-0400</span><br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">2</span><br>  LV Size                <span class="hljs-number">2.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">512</span><br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">1</span><br>   <br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/centos/root<br>  LV <span class="hljs-type">Name</span>                root<br>  VG <span class="hljs-type">Name</span>                centos<br>  LV <span class="hljs-type">UUID</span>                <span class="hljs-number">8</span>O7iWh-vgrE-dDPW<span class="hljs-number">-3</span>f6S-ofbX-pZPK-Eed0tV<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  LV Creation host, <span class="hljs-type">time</span> localhost, <span class="hljs-number">2021</span><span class="hljs-number">-08</span><span class="hljs-number">-08</span> <span class="hljs-number">15</span>:<span class="hljs-number">12</span>:<span class="hljs-number">57</span> <span class="hljs-number">-0400</span><br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">1</span><br>  LV Size                &lt;<span class="hljs-number">17.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">4351</span><br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">0</span><br>   <br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/testvg/testlv<br>  LV <span class="hljs-type">Name</span>                testlv<br>  VG <span class="hljs-type">Name</span>                testvg<br>  LV <span class="hljs-type">UUID</span>                xXdpZU-KAj3<span class="hljs-number">-1</span>MGn-HVeO-lVWh<span class="hljs-number">-3</span>wTQ<span class="hljs-number">-10</span>x2b1<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  LV Creation host, <span class="hljs-type">time</span> node1, <span class="hljs-number">2022</span><span class="hljs-number">-06</span><span class="hljs-number">-20</span> <span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">33</span> <span class="hljs-number">-0400</span><br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">0</span><br>  LV Size                <span class="hljs-number">5.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">320</span><br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>（6）格式化并挂载文件系统</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 test]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm  /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm  [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>disk <br>sdc               8:32  <span class="hljs-number"> 0 </span>  18G <span class="hljs-number"> 0 </span>disk <br>└─testvg-testlv 253:2   <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>lvm  <br>sr0              11:0   <span class="hljs-number"> 1 </span> 4.4G <span class="hljs-number"> 0 </span>rom  <br>[root@node1 test]<span class="hljs-comment"># df -h</span><br>Filesystem               Size  Used Avail Use% Mounted on<br>devtmpfs                 475M    <span class="hljs-number"> 0 </span> 475M   0% /dev<br>tmpfs                    487M    <span class="hljs-number"> 0 </span> 487M   0% /dev/shm<br>tmpfs                    487M  7.8M  479M   2% /run<br>tmpfs                    487M    <span class="hljs-number"> 0 </span> 487M   0% /sys/fs/cgroup<br>/dev/mapper/centos-root   17G  1.3G   16G   8% /<br>/dev/sda1               1014M  138M  877M  14% /boot<br>tmpfs                     98M    <span class="hljs-number"> 0 </span>  98M   0% /run/user/0<br><br>[root@node1 test]<span class="hljs-comment"># ll /dev/testvg/testlv</span><br>lrwxrwxrwx<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 7 </span>Jun<span class="hljs-number"> 20 </span>10:30 /dev/testvg/testlv -&gt; ../dm-2<br><br>[root@node1 test]<span class="hljs-comment"># mkfs.ext4 /dev/testvg/testlv </span><br>mke2fs 1.42.9 (28-Dec-2013)<br>Filesystem label=<br>OS type: Linux<br>Block size=4096 (log=2)<br>Fragment size=4096 (log=2)<br>Stride=0 blocks, Stripe width=0 blocks<br>327680 inodes,<span class="hljs-number"> 1310720 </span>blocks<br>65536 blocks (5.00%) reserved for the super user<br>First data block=0<br>Maximum filesystem blocks=1342177280<br>40 block groups<br>32768 blocks per group,<span class="hljs-number"> 32768 </span>fragments per group<br>8192 inodes per group<br>Superblock backups stored on blocks: <br>32768, 98304, 163840, 229376, 294912, 819200, 884736<br><br>Allocating group tables: done                            <br>Writing inode tables: done                            <br>Creating journal (32768 blocks): done<br>Writing superblocks and filesystem accounting information: done <br><br>[root@node1 test]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm  /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm  [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>disk <br>sdc               8:32  <span class="hljs-number"> 0 </span>  18G <span class="hljs-number"> 0 </span>disk <br>└─testvg-testlv 253:2   <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>lvm  <br>sr0              11:0   <span class="hljs-number"> 1 </span> 4.4G <span class="hljs-number"> 0 </span>rom <br><br>[root@node1 test]<span class="hljs-comment"># mkdir /users</span><br>[root@node1 test]<span class="hljs-comment"># mount /dev/testvg/testlv /users/</span><br>[root@node1 test]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   475M    <span class="hljs-number"> 0 </span> 475M   0% /dev<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /dev/shm<br>tmpfs                      487M  7.8M  479M   2% /run<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /sys/fs/cgroup<br>/dev/mapper/centos-root     17G  1.3G   16G   8% /<br>/dev/sda1                 1014M  138M  877M  14% /boot<br>tmpfs                       98M    <span class="hljs-number"> 0 </span>  98M   0% /run/user/0<br>/dev/mapper/testvg-testlv  4.8G   20M  4.6G   1% /users<br></code></pre></td></tr></table></figure><h2 id="3、新建用户archlinux-要求其家目录为-users-archlinux，而后su切换至archlinux用户，复制-etc-pam-d-目录至自己的家目录。"><a href="#3、新建用户archlinux-要求其家目录为-users-archlinux，而后su切换至archlinux用户，复制-etc-pam-d-目录至自己的家目录。" class="headerlink" title="3、新建用户archlinux,要求其家目录为/users/archlinux，而后su切换至archlinux用户，复制/etc/pam.d/目录至自己的家目录。"></a>3、新建用户archlinux,要求其家目录为/users/archlinux，而后su切换至archlinux用户，复制/etc/pam.d/目录至自己的家目录。</h2><p>（1）新建用户</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ruby">[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># useradd -d /users/archlinux archlinux</span><br>[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># id archlinux</span><br>uid=<span class="hljs-number">1000</span>(archlinux) gid=<span class="hljs-number">1000</span>(archlinux) groups=<span class="hljs-number">1000</span>(archlinux)<br>[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># grep archlinux /etc/passwd</span><br><span class="hljs-symbol">archlinux:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/users/archlinux</span><span class="hljs-symbol">:/bin/bash</span><br>[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># ls /users/archlinux/</span><br>[root<span class="hljs-variable">@node1</span> test]<span class="hljs-comment"># ll -d /users/archlinux/</span><br>drwx------ <span class="hljs-number">2</span> archlinux archlinux <span class="hljs-number">4096</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span><span class="hljs-symbol">:</span><span class="hljs-number">41</span> /users/archlinux/<br></code></pre></td></tr></table></figure><p>（2）复制/etc/pam.d/目录至自己的家目录。</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs tap">[archlinux@node1 ~]$ echo $HOME<br>/users/archlinux<br>[archlinux@node1 ~]$ cp -rp /etc/pam.d/ $HOME<br>[archlinux@node1 ~]$ ll $HOME<br>total 4<br>drwxr-xr-x<span class="hljs-number"> 2 </span>archlinux archlinux<span class="hljs-number"> 4096 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>pam.d<br>[archlinux@node1 ~]$ ll $HOME/pam.d <br>total 100<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 192 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>chfn<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 192 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>chsh<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 232 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>config-util<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 287 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2019 </span>crond<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 19 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>fingerprint-auth -&gt; fingerprint-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 702 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>fingerprint-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 796 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>login<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 154 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>other<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 188 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>passwd<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 16 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>password-auth -&gt; password-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux<span class="hljs-number"> 1033 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>password-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 155 </span>Apr <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>polkit-1<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 12 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>postlogin -&gt; postlogin-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 330 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>postlogin-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 681 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>remote<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 143 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>runuser<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 138 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>runuser-l<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 17 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smartcard-auth -&gt; smartcard-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 752 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smartcard-auth-ac<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 25 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smtp -&gt; /etc/alternatives/mta-pam<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 76 </span>Apr <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>smtp.postfix<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 904 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2019 </span>sshd<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 540 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>su<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 200 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>sudo<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 178 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>sudo-i<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 137 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>su-l<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 14 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>system-auth -&gt; system-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux<span class="hljs-number"> 1031 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>system-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 129 </span>Oct <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>systemd-user<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 84 </span>Oct<span class="hljs-number"> 30 </span><span class="hljs-number"> 2018 </span>vlock<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 278 </span>Oct <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>vmtoolsd<br></code></pre></td></tr></table></figure><h2 id="4、扩展testlv至7G，要求archlinux用户的文件不能丢失"><a href="#4、扩展testlv至7G，要求archlinux用户的文件不能丢失" class="headerlink" title="4、扩展testlv至7G，要求archlinux用户的文件不能丢失"></a>4、扩展testlv至7G，要求archlinux用户的文件不能丢失</h2><p>（1）在线扩展逻辑卷至7G</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 ~]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;17.00g                                                    <br>  swap   centos -wi-ao----   2.00g                                                    <br>  testlv testvg -wi-ao----   5.00g  <br><br>[root@node1 ~]<span class="hljs-comment"># lvextend -L 7G /dev/testvg/testlv </span><br>  Size of logical volume testvg/testlv changed from 5.00 GiB (320 extents) to 7.00 GiB (448 extents).<br>  Logical volume testvg/testlv successfully resized.<br>[root@node1 ~]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm  /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm  [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>disk <br>sdc               8:32  <span class="hljs-number"> 0 </span>  18G <span class="hljs-number"> 0 </span>disk <br>└─testvg-testlv 253:2   <span class="hljs-number"> 0 </span>   7G <span class="hljs-number"> 0 </span>lvm  /users<br>sr0              11:0   <span class="hljs-number"> 1 </span> 4.4G <span class="hljs-number"> 0 </span>rom  <br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   475M    <span class="hljs-number"> 0 </span> 475M   0% /dev<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /dev/shm<br>tmpfs                      487M  7.8M  479M   2% /run<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /sys/fs/cgroup<br>/dev/mapper/centos-root     17G  1.3G   16G   8% /<br>/dev/sda1                 1014M  138M  877M  14% /boot<br>tmpfs                       98M    <span class="hljs-number"> 0 </span>  98M   0% /run/user/0<br>/dev/mapper/testvg-testlv  4.8G   21M  4.6G   1% /users<br><br>[root@node1 ~]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;17.00g                                                    <br>  swap   centos -wi-ao----   2.00g                                                    <br>  testlv testvg -wi-ao----   7.00g  <br></code></pre></td></tr></table></figure><p>（2）扩展文件系统</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 ~]<span class="hljs-comment"># resize2fs /dev/testvg/testlv </span><br>resize2fs 1.42.9 (28-Dec-2013)<br>Filesystem at /dev/testvg/testlv is mounted on /users; on-line resizing required<br>old_desc_blocks = 1, new_desc_blocks = 1<br>The filesystem on /dev/testvg/testlv is now<span class="hljs-number"> 1835008 </span>blocks long.<br><br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   475M    <span class="hljs-number"> 0 </span> 475M   0% /dev<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /dev/shm<br>tmpfs                      487M  7.8M  479M   2% /run<br>tmpfs                      487M    <span class="hljs-number"> 0 </span> 487M   0% /sys/fs/cgroup<br>/dev/mapper/centos-root     17G  1.3G   16G   8% /<br>/dev/sda1                 1014M  138M  877M  14% /boot<br>tmpfs                       98M    <span class="hljs-number"> 0 </span>  98M   0% /run/user/0<br>/dev/mapper/testvg-testlv  6.8G   23M  6.4G   1% /users<br><br>[root@node1 ~]<span class="hljs-comment"># ll /users/archlinux/pam.d/</span><br>total 100<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 192 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>chfn<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 192 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>chsh<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 232 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>config-util<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 287 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2019 </span>crond<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 19 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>fingerprint-auth -&gt; fingerprint-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 702 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>fingerprint-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 796 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>login<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 154 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>other<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 188 </span>Mar<span class="hljs-number"> 31 </span><span class="hljs-number"> 2020 </span>passwd<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 16 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>password-auth -&gt; password-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux<span class="hljs-number"> 1033 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>password-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 155 </span>Apr <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>polkit-1<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 12 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>postlogin -&gt; postlogin-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 330 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>postlogin-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 681 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>remote<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 143 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>runuser<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 138 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>runuser-l<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 17 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smartcard-auth -&gt; smartcard-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 752 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smartcard-auth-ac<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 25 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>smtp -&gt; /etc/alternatives/mta-pam<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 76 </span>Apr <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>smtp.postfix<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 904 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2019 </span>sshd<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 540 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>su<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 200 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>sudo<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 178 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>sudo-i<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 137 </span>Sep<span class="hljs-number"> 30 </span><span class="hljs-number"> 2020 </span>su-l<br>lrwxrwxrwx<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 14 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>system-auth -&gt; system-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux<span class="hljs-number"> 1031 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>system-auth-ac<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 129 </span>Oct <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>systemd-user<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux  <span class="hljs-number"> 84 </span>Oct<span class="hljs-number"> 30 </span><span class="hljs-number"> 2018 </span>vlock<br>-rw-r--r--<span class="hljs-number"> 1 </span>archlinux archlinux <span class="hljs-number"> 278 </span>Oct <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>vmtoolsd<br></code></pre></td></tr></table></figure><h2 id="5、收缩testlv至3G，要求archlinux用户的文件不能丢失"><a href="#5、收缩testlv至3G，要求archlinux用户的文件不能丢失" class="headerlink" title="5、收缩testlv至3G，要求archlinux用户的文件不能丢失"></a>5、收缩testlv至3G，要求archlinux用户的文件不能丢失</h2><p>注意：缩减有数据损坏的风险，建议先备份再缩减，xfs文件系统不支持缩减 </p><p>（1）备份数据</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">[root@node1 ~]<span class="hljs-comment"># tar -cf /tmp/user.tar /users/</span><br>tar: Removing leading `/&#x27; from member names<br><br>[root@node1 ~]<span class="hljs-comment"># ll /tmp/user.tar </span><br>-rw-r<span class="hljs-params">--r--</span> 1 root root 40960 Jun 20 11<span class="hljs-function">:14</span> <span class="hljs-string">/tmp/user.tar</span><br><br>[root@node1 ~]<span class="hljs-comment"># tar -tf /tmp/user.tar </span><br>users/<br>users/lost+found/<br>users/archlinux/<br>users/archlinux/<span class="hljs-string">.bashrc</span><br>users/archlinux/pam.d/<br>users/archlinux/pam.d/login<br>users/archlinux/pam.d/config-util<br>users/archlinux/pam.d/crond<br>users/archlinux/pam.d/sudo-i<br>users/archlinux/pam.d/chsh<br>users/archlinux/pam.d/postlogin-ac<br>users/archlinux/pam.d/system-auth<br>users/archlinux/pam.d/su-l<br>users/archlinux/pam.d/vmtoolsd<br>users/archlinux/pam.d/runuser-l<br>users/archlinux/pam.d/other<br>users/archlinux/pam.d/password-auth-ac<br>users/archlinux/pam.d/postlogin<br>users/archlinux/pam.d/smartcard-auth-ac<br>users/archlinux/pam.d/su<br>users/archlinux/pam.d/fingerprint-auth-ac<br>users/archlinux/pam.d/fingerprint-auth<br>users/archlinux/pam.d/smtp<br>users/archlinux/pam.d/remote<br>users/archlinux/pam.d/systemd-user<br>users/archlinux/pam.d/passwd<br>users/archlinux/pam.d/sudo<br>users/archlinux/pam.d/runuser<br>users/archlinux/pam.d/smtp.postfix<br>users/archlinux/pam.d/sshd<br>users/archlinux/pam.d/smartcard-auth<br>users/archlinux/pam.d/vlock<br>users/archlinux/pam.d/polkit-1<br>users/archlinux/pam.d/system-auth-ac<br>users/archlinux/pam.d/chfn<br>users/archlinux/pam.d/password-auth<br>users/archlinux/<span class="hljs-string">.bash_logout</span><br>users/archlinux/<span class="hljs-string">.bash_profile</span><br></code></pre></td></tr></table></figure><p>（2）卸载要缩容的逻辑卷上的文件系统</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                      <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root     17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                 <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                       <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv  6.8G   23M  6.4G   1% /u</span>sers<br><br>[root@node1 ~]<span class="hljs-comment"># umount /users</span><br>umount: /users: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(<span class="hljs-number">8</span>) or fuser(<span class="hljs-number">1</span>))<br>         <br>         [root@node1 ~]<span class="hljs-comment"># umount /dev/testvg/testlv              卸载失败了怎么办？重启系统后，自动卸载掉了</span><br>umount: /users: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(<span class="hljs-number">8</span>) or fuser(<span class="hljs-number">1</span>))<br>         <br></code></pre></td></tr></table></figure><p>（3）</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@node1 ~]# umount <span class="hljs-regexp">/users/</span><br>[root@node1 ~]# df -h<br>Filesystem               <span class="hljs-keyword">Size</span>  Used Avail Use% Mounted on<br>devtmpfs                 <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                    <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root   17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1               <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                     <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br>[root@node1 ~]# resize2fs <span class="hljs-regexp">/dev/</span>testvg/testlv <span class="hljs-number">3</span>G<br>resize2fs <span class="hljs-number">1.42</span>.<span class="hljs-number">9</span> (<span class="hljs-number">28</span>-Dec-<span class="hljs-number">2013</span>)<br>Please run <span class="hljs-string">&#x27;e2fsck -f /dev/testvg/testlv&#x27;</span> first.<br></code></pre></td></tr></table></figure><p>（4）</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 ~]<span class="hljs-comment"># fsck -f /dev/testvg/testlv </span><br>fsck from util-linux <span class="hljs-number">2.23</span>.<span class="hljs-number">2</span><br>e2fsck <span class="hljs-number">1.42</span>.<span class="hljs-number">9</span> (<span class="hljs-number">28</span>-Dec-<span class="hljs-number">2013</span>)<br>Pass <span class="hljs-number">1</span>: Checking inodes, blocks, and sizes<br>Pass <span class="hljs-number">2</span>: Checking directory structure<br>Pass <span class="hljs-number">3</span>: Checking directory connectivity<br>Pass <span class="hljs-number">4</span>: Checking reference counts<br>Pass <span class="hljs-number">5</span>: Checking group summary information<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv: 47/</span><span class="hljs-number">458752</span> files (<span class="hljs-number">0.0</span>% non-contiguous), <span class="hljs-number">67357</span>/<span class="hljs-number">1835008</span> blocks<br>[root@node1 ~]<span class="hljs-comment"># resize2fs /dev/testvg/testlv 3G</span><br>resize2fs <span class="hljs-number">1.42</span>.<span class="hljs-number">9</span> (<span class="hljs-number">28</span>-Dec-<span class="hljs-number">2013</span>)<br>Resizing the filesystem on <span class="hljs-regexp">/dev/</span>testvg/testlv to <span class="hljs-number">786432</span> (<span class="hljs-number">4</span>k) blocks.<br>The filesystem on <span class="hljs-regexp">/dev/</span>testvg/testlv is now <span class="hljs-number">786432</span> blocks long.<br><br>[root@node1 ~]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;<span class="hljs-number">17.00</span>g                                                    <br>  swap   centos -wi-ao----   <span class="hljs-number">2.00</span>g                                                    <br>  testlv testvg -wi-a-----   <span class="hljs-number">7.00</span>g                                                    <br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem               Size  Used Avail Use% Mounted on<br>devtmpfs                 <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                    <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root   17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1               <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                     <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br>[root@node1 ~]<span class="hljs-comment"># cat /etc/fstab </span><br><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># /etc/fstab</span><br><span class="hljs-comment"># Created by anaconda on Sun Aug  8 15:12:58 2021</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><br><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><br><span class="hljs-comment">#</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root /</span>                       xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>UUID=f7d6f590-<span class="hljs-number">611</span>d-<span class="hljs-number">44</span>bb-<span class="hljs-number">8228</span>-bcd7e1a43333 /boot                   xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper/centos-swap swap                    swap    defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>[root@node1 ~]<span class="hljs-comment"># vim /etc/fstab </span><br>-bash: vim: command not found<br>[root@node1 ~]<span class="hljs-comment"># vi /etc/fstab </span><br>[root@node1 ~]<span class="hljs-comment"># cat /etc/fstab </span><br><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># /etc/fstab</span><br><span class="hljs-comment"># Created by anaconda on Sun Aug  8 15:12:58 2021</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><br><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><br><span class="hljs-comment">#</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root /</span>                       xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>UUID=f7d6f590-<span class="hljs-number">611</span>d-<span class="hljs-number">44</span>bb-<span class="hljs-number">8228</span>-bcd7e1a43333 /boot                   xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper/centos-swap swap                    swap    defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/</span>testvg<span class="hljs-regexp">/testlv /u</span>sers/ext4defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>[root@node1 ~]<span class="hljs-comment"># mount -a</span><br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                      <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root     17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                 <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                       <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv  2.9G   16M  2.7G   1% /u</span>sers<br></code></pre></td></tr></table></figure><p>（5）</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs crystal">[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># umount /users/</span><br>[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># lvreduce -L 3G /dev/testvg/testlv </span><br>  <span class="hljs-symbol">WARNING:</span> Reducing active logical volume to <span class="hljs-number">3.00</span> GiB.<br>  THIS MAY DESTROY YOUR DATA (filesystem etc.)<br>Do you really want to reduce testvg/testlv? [y/n]: y<br>  Size <span class="hljs-keyword">of</span> logical volume testvg/testlv changed from <span class="hljs-number">7.00</span> GiB (<span class="hljs-number">448</span> extents) to <span class="hljs-number">3.00</span> GiB (<span class="hljs-number">192</span> extents).<br>  Logical volume testvg/testlv successfully resized.<br>[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;<span class="hljs-number">17.00</span>g                                                    <br>  swap   centos -wi-ao----   <span class="hljs-number">2.00</span>g                                                    <br>  testlv testvg -wi-a-----   <span class="hljs-number">3.00</span>g                                                    <br>[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># mount -a</span><br>[root<span class="hljs-variable">@node1</span> ~]<span class="hljs-comment"># df -h</span><br>Filesystem                 Size  Used Avail Use% Mounted on<br>devtmpfs                   <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev</span><br><span class="hljs-regexp">tmpfs                      487M     0  487M   0% /dev</span><span class="hljs-regexp">/shm</span><br><span class="hljs-regexp">tmpfs                      487M  7.8M  479M   2% /run</span><br>tmpfs                      <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/fs</span><span class="hljs-regexp">/cgroup</span><br><span class="hljs-regexp">/dev</span><span class="hljs-regexp">/mapper/centos</span>-root     <span class="hljs-number">17</span>G  <span class="hljs-number">1.3</span>G   <span class="hljs-number">16</span>G   <span class="hljs-number">8</span>% <span class="hljs-regexp">/</span><br><span class="hljs-regexp">/dev</span><span class="hljs-regexp">/sda1                 1014M  138M  877M  14% /boot</span><br>tmpfs                       <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/user</span><span class="hljs-regexp">/0</span><br><span class="hljs-regexp">/dev</span><span class="hljs-regexp">/mapper/testvg</span>-testlv  <span class="hljs-number">2.9</span>G   <span class="hljs-number">16</span>M  <span class="hljs-number">2.7</span>G   <span class="hljs-number">1</span>% <span class="hljs-regexp">/users</span><br></code></pre></td></tr></table></figure><h2 id="6、对testlv创建快照，并尝试基于快照备份数据，验正快照的功能"><a href="#6、对testlv创建快照，并尝试基于快照备份数据，验正快照的功能" class="headerlink" title="6、对testlv创建快照，并尝试基于快照备份数据，验正快照的功能"></a>6、对testlv创建快照，并尝试基于快照备份数据，验正快照的功能</h2><p>（1）为现有逻辑卷/dev/testvg/testlv 创建快照<br>ext4必须使用-p r 实现只读 （否则快照是可以被别人篡改的，那样的话备份就没有意义了）</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@node1 ~]# lvcreate -l <span class="hljs-number">64</span> -s -n <span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span> -p r /dev/testvg/testlv <br>  Logical volume &quot;user-snapshot&quot; created.<br>[root@node1 ~]# lvs<br>  LV            VG     Attr       LSize   Pool Origin Data%  Meta%  <span class="hljs-keyword">Move</span> <span class="hljs-keyword">Log</span> Cpy%Sync Convert<br>  root          centos -wi-ao<span class="hljs-comment">---- &lt;17.00g                                                    </span><br>  swap          centos -wi-ao<span class="hljs-comment">----   2.00g                                                    </span><br>  testlv        testvg owi-aos<span class="hljs-comment">---   3.00g                                                    </span><br>  <span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span> testvg sri-a-s<span class="hljs-comment">---   1.00g      testlv 0.01    //创建快照后会多一个逻辑卷</span><br>  <br>[root@node1 ~]# blkid<br>/dev/mapper/testvg-testlv: <span class="hljs-type">UUID</span>=&quot;1db19aff-18f0-42d5-88d2-0f4ea074d33f&quot; <span class="hljs-keyword">TYPE</span>=&quot;ext4&quot; <br>/dev/sda1: <span class="hljs-type">UUID</span>=&quot;f7d6f590-611d-44bb-8228-bcd7e1a43333&quot; <span class="hljs-keyword">TYPE</span>=&quot;xfs&quot; <br>/dev/sda2: <span class="hljs-type">UUID</span>=&quot;Pcy8Mo-duHv-KVJI-NGLy-CCln-pDEl-zUOaPV&quot; <span class="hljs-keyword">TYPE</span>=&quot;LVM2_member&quot; <br>/dev/sdb: <span class="hljs-type">UUID</span>=&quot;sCiC1O-wM9v-ecWQ-Knx3-JCEx-jX4E-rLTmQ1&quot; <span class="hljs-keyword">TYPE</span>=&quot;LVM2_member&quot; <br>/dev/sr0: <span class="hljs-type">UUID</span>=&quot;2020-11-04-11-36-43-00&quot; LABEL=&quot;CentOS 7 x86_64&quot; <span class="hljs-keyword">TYPE</span>=&quot;iso9660&quot; PTTYPE=&quot;dos&quot; <br>/dev/sdc: <span class="hljs-type">UUID</span>=&quot;dsIn9M-LD1O-jD8R-6S9b-i7ts-sJmG-GOz45s&quot; <span class="hljs-keyword">TYPE</span>=&quot;LVM2_member&quot; <br>/dev/mapper/centos-root: <span class="hljs-type">UUID</span>=&quot;21bd96c2-bd2c-4649-b5b0-fbb11870671c&quot; <span class="hljs-keyword">TYPE</span>=&quot;xfs&quot; <br>/dev/mapper/centos-swap: <span class="hljs-type">UUID</span>=&quot;f0fb2d3e-4915-4353-8ef4-decf20ea52a3&quot; <span class="hljs-keyword">TYPE</span>=&quot;swap&quot; <br>/dev/mapper/testvg-<span class="hljs-keyword">user</span><span class="hljs-comment">--snapshot: UUID=&quot;1db19aff-18f0-42d5-88d2-0f4ea074d33f&quot; TYPE=&quot;ext4&quot;   //uuid是一样的</span><br>  <br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@node1 ~]# lvdisplay<br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/testvg/testlv<br>  LV <span class="hljs-type">Name</span>                testlv<br>  VG <span class="hljs-type">Name</span>                testvg<br>  LV <span class="hljs-type">UUID</span>                xXdpZU-KAj3<span class="hljs-number">-1</span>MGn-HVeO-lVWh<span class="hljs-number">-3</span>wTQ<span class="hljs-number">-10</span>x2b1<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span>/<span class="hljs-keyword">write</span><br>  LV Creation host, <span class="hljs-type">time</span> node1, <span class="hljs-number">2022</span><span class="hljs-number">-06</span><span class="hljs-number">-20</span> <span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">33</span> <span class="hljs-number">-0400</span><br>  LV <span class="hljs-keyword">snapshot</span> status     source <span class="hljs-keyword">of</span><br>                         <span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span> [active]<br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">1</span><br>  LV Size                <span class="hljs-number">3.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">192</span><br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">2</span><br>   <br>  <span class="hljs-comment">--- Logical volume ---</span><br>  LV <span class="hljs-type">Path</span>                /dev/testvg/<span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span><br>  LV <span class="hljs-type">Name</span>                <span class="hljs-keyword">user</span>-<span class="hljs-keyword">snapshot</span><br>  VG <span class="hljs-type">Name</span>                testvg<br>  LV <span class="hljs-type">UUID</span>                DZzugm-ieN6-yNca-eigO-NSFF-uu6O-L09uqf<br>  LV <span class="hljs-keyword">Write</span> <span class="hljs-keyword">Access</span>        <span class="hljs-keyword">read</span> <span class="hljs-keyword">only</span><br>  LV Creation host, <span class="hljs-type">time</span> node1, <span class="hljs-number">2022</span><span class="hljs-number">-06</span><span class="hljs-number">-21</span> <span class="hljs-number">10</span>:<span class="hljs-number">39</span>:<span class="hljs-number">26</span> <span class="hljs-number">-0400</span><br>  LV <span class="hljs-keyword">snapshot</span> status     active destination <span class="hljs-keyword">for</span> testlv<br>  LV Status              available<br>  # <span class="hljs-keyword">open</span>                 <span class="hljs-number">0</span><br>  LV Size                <span class="hljs-number">3.00</span> GiB<br>  <span class="hljs-keyword">Current</span> LE             <span class="hljs-number">192</span><br>  COW-<span class="hljs-keyword">table</span> size         <span class="hljs-number">1.00</span> GiB<br>  COW-<span class="hljs-keyword">table</span> LE           <span class="hljs-number">64</span><br>  Allocated <span class="hljs-keyword">to</span> <span class="hljs-keyword">snapshot</span>  <span class="hljs-number">0.01</span>%<br>  <span class="hljs-keyword">Snapshot</span> chunk size    <span class="hljs-number">4.00</span> KiB<br>  Segments               <span class="hljs-number">1</span><br>  Allocation             <span class="hljs-keyword">inherit</span><br>  <span class="hljs-keyword">Read</span> ahead sectors     auto<br>  - currently <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span>     <span class="hljs-number">256</span><br>  Block device           <span class="hljs-number">253</span>:<span class="hljs-number">5</span><br>  <br>[root@node1 snap]# ll<br>total <span class="hljs-number">20</span><br>drwx<span class="hljs-comment">------ 3 archlinux archlinux  4096 Jun 20 10:45 archlinux</span><br>drwx<span class="hljs-comment">------ 2 root      root      16384 Jun 20 10:35 lost+found</span><br><br>快照不能被修改，说明达到了备份的效果<br>[root@node1 snap]# touch <span class="hljs-number">1.</span>txt<br>touch: cannot touch ‘<span class="hljs-number">1.</span>txt’: <span class="hljs-keyword">Read</span>-<span class="hljs-keyword">only</span> file <span class="hljs-keyword">system</span><br></code></pre></td></tr></table></figure><p>（2）挂载快照</p><p>xfs注意要使用-o ro实现只读,访止快照被修改</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 ~]<span class="hljs-comment"># mkdir /mnt/snap</span><br>[root@node1 ~]<span class="hljs-comment"># mount /dev/testvg/user-snapshot /mnt/snap/</span><br>mount: <span class="hljs-regexp">/dev/m</span>apper/testvg-user--snapshot is write-protected, mounting read-only<br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                         Size  Used Avail Use% Mounted on<br>devtmpfs                           <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                              <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root             17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                         <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                               <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv          2.9G   16M  2.7G   1% /u</span>sers<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-user--snapshot  2.9G   16M  2.7G   1% /m</span>nt/snap<br>[root@node1 ~]<span class="hljs-comment"># ll /mnt/snap/       //这里看到的文件都是虚的</span><br>total <span class="hljs-number">20</span><br>drwx------ <span class="hljs-number">3</span> archlinux archlinux  <span class="hljs-number">4096</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span>:<span class="hljs-number">45</span> archlinux<br>drwx------ <span class="hljs-number">2</span> root      root      <span class="hljs-number">16384</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span>:<span class="hljs-number">35</span> lost+found<br><br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem                         Size  Used Avail Use% Mounted on<br>devtmpfs                           <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                              <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root             17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                         <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                               <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv          2.9G   16M  2.7G   1% /u</span>sers<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-user--snapshot  2.9G   16M  2.7G   1% /m</span>nt/snap   快照显示的文件大小跟<br></code></pre></td></tr></table></figure><p>（3）验证快照的功能</p><p>对原来的逻辑卷进行修改</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 ~]<span class="hljs-comment"># cd /users/archlinux/</span><br>[root@node1 archlinux]<span class="hljs-comment"># ll</span><br>total 4<br>drwxr-xr-x<span class="hljs-number"> 2 </span>archlinux archlinux<span class="hljs-number"> 4096 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>pam.d<br>[root@node1 archlinux]<span class="hljs-comment"># mv pam.d/ pum.d</span><br>[root@node1 archlinux]<span class="hljs-comment"># touch file1.txt</span><br>[root@node1 archlinux]<span class="hljs-comment"># ll                           1、新建了一个文件file1.txt 2、给目录pam.d重命名为pum.d</span><br>total 4<br>-rw-r--r--<span class="hljs-number"> 1 </span>root      root        <span class="hljs-number"> 0 </span>Jun<span class="hljs-number"> 21 </span>22:36 file1.txt<br>drwxr-xr-x<span class="hljs-number"> 2 </span>archlinux archlinux<span class="hljs-number"> 4096 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>pum.d<br>[root@node1 archlinux]<span class="hljs-comment"># pwd</span><br>/users/archlinux<br><br>[root@node1 archlinux]<span class="hljs-comment"># cd /mnt/snap/               //快照里还是原来的东西，说明备份效果体现出来了</span><br>[root@node1 snap]<span class="hljs-comment"># ll archlinux/</span><br>total 4<br>drwxr-xr-x<span class="hljs-number"> 2 </span>archlinux archlinux<span class="hljs-number"> 4096 </span>Aug <span class="hljs-number"> 8 </span><span class="hljs-number"> 2021 </span>pam.d<br></code></pre></td></tr></table></figure><p>利用快照还原原来的逻辑卷</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 snap]<span class="hljs-comment"># df -h</span><br>Filesystem                         Size  Used Avail Use% Mounted on<br>devtmpfs                           <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                              <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                              <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root             17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1                         <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                               <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-testlv          2.9G   16M  2.7G   1% /u</span>sers<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/testvg-user--snapshot  2.9G   16M  2.7G   1% /m</span>nt/snap<br>[root@node1 snap]<span class="hljs-comment"># umount /users/</span><br>umount: /users: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(<span class="hljs-number">8</span>) or fuser(<span class="hljs-number">1</span>))<br>[root@node1 snap]<span class="hljs-comment"># umount /users/</span><br>[root@node1 snap]<span class="hljs-comment"># umount /mnt/snap/                  // 卸载时，应退出访问文件系统的进程</span><br>umount: <span class="hljs-regexp">/mnt/</span>snap: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(<span class="hljs-number">8</span>) or fuser(<span class="hljs-number">1</span>))<br>[root@node1 snap]<span class="hljs-comment"># cd /                         </span><br>[root@node1 <span class="hljs-regexp">/]# umount /m</span>nt<span class="hljs-regexp">/snap/</span><br>[root@node1 /]<span class="hljs-comment"># df -h</span><br>Filesystem               Size  Used Avail Use% Mounted on<br>devtmpfs                 <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                    <span class="hljs-number">487</span>M  <span class="hljs-number">7.8</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root   17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1               <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                     <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@node1 <span class="hljs-regexp">/]# lvconvert --merge /</span>dev<span class="hljs-regexp">/testvg/u</span>ser-snapshot <br>  Merging of volume testvg/user-snapshot started.<br>  testvg/testlv: Merged: <span class="hljs-number">100.00</span>%<br> <br> 在使用快照还原后，快照的逻辑卷就消失了，是一次性的。<br>[root@node1 /]<span class="hljs-comment"># lvs</span><br>  LV     VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  root   centos -wi-ao---- &lt;<span class="hljs-number">17.00</span>g                                                    <br>  swap   centos -wi-ao----   <span class="hljs-number">2.00</span>g                                                    <br>  testlv testvg -wi-a-----   <span class="hljs-number">3.00</span>g       <br>  <br>[root@node1 <span class="hljs-regexp">/]# mount /</span>dev<span class="hljs-regexp">/testvg/</span>testlv <span class="hljs-regexp">/users/</span><br>[root@node1 <span class="hljs-regexp">/]# ll /u</span>sers/<br>total <span class="hljs-number">20</span><br>drwx------ <span class="hljs-number">3</span> archlinux archlinux  <span class="hljs-number">4096</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span>:<span class="hljs-number">45</span> archlinux<br>drwx------ <span class="hljs-number">2</span> root      root      <span class="hljs-number">16384</span> Jun <span class="hljs-number">20</span> <span class="hljs-number">10</span>:<span class="hljs-number">35</span> lost+found<br>[root@node1 <span class="hljs-regexp">/]# ll /u</span>sers<span class="hljs-regexp">/archlinux/</span>                   <span class="hljs-regexp">//</span> 已还原到原来的样子<br>total <span class="hljs-number">4</span><br>drwxr-xr-x <span class="hljs-number">2</span> archlinux archlinux <span class="hljs-number">4096</span> Aug  <span class="hljs-number">8</span>  <span class="hljs-number">2021</span> pam.d<br></code></pre></td></tr></table></figure><h2 id="7、创建10G的RAID1，要求CHUNK为128K，文件系统为ext4，有一个空闲盘，开机可自动挂载至-backup目录"><a href="#7、创建10G的RAID1，要求CHUNK为128K，文件系统为ext4，有一个空闲盘，开机可自动挂载至-backup目录" class="headerlink" title="7、创建10G的RAID1，要求CHUNK为128K，文件系统为ext4，有一个空闲盘，开机可自动挂载至/backup目录"></a>7、创建10G的RAID1，要求CHUNK为128K，文件系统为ext4，有一个空闲盘，开机可自动挂载至/backup目录</h2><p>（1）、使用VMware添加两块大小均为10G的硬盘，然后在linux使用命令扫描新添加的硬盘。</p><p>（2）、创建RAID1，</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">mdadm -C <span class="hljs-regexp">/dev/m</span>d0 -a yes -l <span class="hljs-number">1</span> -n <span class="hljs-number">2</span> -x <span class="hljs-number">1</span> -c <span class="hljs-number">128</span>K <span class="hljs-regexp">/dev/</span>sdb  <span class="hljs-regexp">/dev/</span>sdc<br></code></pre></td></tr></table></figure><p>（3）、格式化磁盘，并挂载文件系统</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@localhost ~]mkfs.ext4 <span class="hljs-regexp">/dev/m</span>d0<br>[root@localhost ~]mkdir /backup<br>[root@localhost ~]<span class="hljs-comment"># vim /etc/fstab </span><br>[root@localhost ~]<span class="hljs-comment"># cat /etc/fstab </span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># /etc/fstab</span><br><span class="hljs-comment"># Created by anaconda on Tue Jun 28 17:51:01 2022</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><br><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><br><span class="hljs-comment">#</span><br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root /</span>                       xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br>UUID=<span class="hljs-number">47</span>e57ec3-dc25-<span class="hljs-number">40</span>b5-a567-<span class="hljs-number">619</span>b8697712f /boot                   xfs     defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br><span class="hljs-regexp">/dev/m</span>d0                    /backup    defaults        <span class="hljs-number">0</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h2 id="8、创建一个可用空间为10G的RAID10设备，要求CHUNK为256K，文件系统为ext4，开机可自动挂载至-mydata目录"><a href="#8、创建一个可用空间为10G的RAID10设备，要求CHUNK为256K，文件系统为ext4，开机可自动挂载至-mydata目录" class="headerlink" title="8、创建一个可用空间为10G的RAID10设备，要求CHUNK为256K，文件系统为ext4，开机可自动挂载至/mydata目录"></a>8、创建一个可用空间为10G的RAID10设备，要求CHUNK为256K，文件系统为ext4，开机可自动挂载至/mydata目录</h2><p>（1）、使用VMware添加四块大小均为5G的硬盘，然后在linux使用命令扫描新添加的硬盘。</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@localhost ~]<span class="hljs-comment"># echo &#x27;- - -&#x27;&gt;/sys/class/scsi_host/host0/scan</span><br>[root@localhost ~]<span class="hljs-comment"># ll /dev/sd*</span><br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 0 </span>Jun<span class="hljs-number"> 28 </span>12:38 /dev/sda<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 1 </span>Jun<span class="hljs-number"> 28 </span>12:38 /dev/sda1<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8, <span class="hljs-number"> 2 </span>Jun<span class="hljs-number"> 28 </span>12:38 /dev/sda2<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 16 </span>Jun<span class="hljs-number"> 28 </span>13:03 /dev/sdb<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 32 </span>Jun<span class="hljs-number"> 28 </span>13:03 /dev/sdc<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 48 </span>Jun<span class="hljs-number"> 28 </span>13:03 /dev/sdd<br>brw-rw----.<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 64 </span>Jun<span class="hljs-number"> 28 </span>13:03 /dev/sde<br></code></pre></td></tr></table></figure><p>（2）、创建raid10</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@localhost ~]<span class="hljs-comment"># mdadm -C /dev/md1 -a yes -l 10 -n4 -c 256K /dev/sd&#123;b,c,d,e&#125; </span><br>mdadm: Defaulting to version 1.2 metadata<br>mdadm: array /dev/md1 started.<br>[root@localhost ~]<span class="hljs-comment"># mdadm -D /dev/md1</span><br>/dev/md1:<br>           Version : 1.2<br>     Creation Time : Tue Jun<span class="hljs-number"> 28 </span>13:07:56 2022<br>        Raid Level : raid10<br>        Array Size :<span class="hljs-number"> 10475520 </span>(9.99 GiB 10.73 GB)<br>     Used Dev Size :<span class="hljs-number"> 5237760 </span>(5.00 GiB 5.36 GB)<br>      Raid Devices : 4<br>     Total Devices : 4<br>       Persistence : Superblock is persistent<br><br>       Update Time : Tue Jun<span class="hljs-number"> 28 </span>13:08:10 2022<br>             State : clean, resyncing <br>    Active Devices : 4<br>   Working Devices : 4<br>    Failed Devices : 0<br>     Spare Devices : 0<br><br>            Layout : near=2<br>        Chunk Size : 256K<br><br>Consistency Policy : resync<br><br>     Resync Status : 76% complete<br><br>              Name : localhost.localdomain:1  (local to host localhost.localdomain)<br>              UUID : 81d26fe9:0c024b84:134ca616:d307d1be<br>            Events : 12<br><br>    Number   Major   Minor   RaidDevice State<br>      <span class="hljs-number"> 0 </span>     <span class="hljs-number"> 8 </span>     <span class="hljs-number"> 16 </span>      <span class="hljs-number"> 0 </span>     active sync set-A   /dev/sdb<br>      <span class="hljs-number"> 1 </span>     <span class="hljs-number"> 8 </span>     <span class="hljs-number"> 32 </span>      <span class="hljs-number"> 1 </span>     active sync set-B   /dev/sdc<br>      <span class="hljs-number"> 2 </span>     <span class="hljs-number"> 8 </span>     <span class="hljs-number"> 48 </span>      <span class="hljs-number"> 2 </span>     active sync set-A   /dev/sdd<br>      <span class="hljs-number"> 3 </span>     <span class="hljs-number"> 8 </span>     <span class="hljs-number"> 64 </span>      <span class="hljs-number"> 3 </span>     active sync set-B   /dev/sde<br>       <br>[root@localhost ~]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE   MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk   <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part   /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part   <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm    /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm    [SWAP]<br>sdb               8:16  <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>disk   <br>└─md1             9:1   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>raid10 <br>sdc               8:32  <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>disk   <br>└─md1             9:1   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>raid10 <br>sdd               8:48  <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>disk   <br>└─md1             9:1   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>raid10 <br>sde               8:64  <span class="hljs-number"> 0 </span>   5G <span class="hljs-number"> 0 </span>disk   <br>└─md1             9:1   <span class="hljs-number"> 0 </span>  10G <span class="hljs-number"> 0 </span>raid10 <br>sr0              11:0   <span class="hljs-number"> 1 </span>1024M <span class="hljs-number"> 0 </span>rom    <br></code></pre></td></tr></table></figure><p>（3）、格式化磁盘，并挂载文件系统</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># mkfs.ext4 /dev/md1</span><br>mke2fs 1.42.9 (28-Dec-2013)<br>Filesystem label=<br>OS <span class="hljs-built_in">type</span>: Linux<br>Block size=4096 (<span class="hljs-built_in">log</span>=2)<br>Fragment size=4096 (<span class="hljs-built_in">log</span>=2)<br>Stride=64 blocks, Stripe width=128 blocks<br>655360 inodes, 2618880 blocks<br>130944 blocks (5.00%) reserved <span class="hljs-keyword">for</span> the super user<br>First data block=0<br>Maximum filesystem blocks=2151677952<br>80 block <span class="hljs-built_in">groups</span><br>32768 blocks per group, 32768 fragments per group<br>8192 inodes per group<br>Superblock backups stored on blocks: <br>32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632<br><br>Allocating group tables: <span class="hljs-keyword">done</span>                            <br>Writing inode tables: <span class="hljs-keyword">done</span>                            <br>Creating journal (32768 blocks): <span class="hljs-keyword">done</span><br>Writing superblocks and filesystem accounting information: <span class="hljs-keyword">done</span> <br><br>[root@localhost ~]<span class="hljs-comment"># vim /etc/fstab </span><br>[root@localhost ~]<span class="hljs-comment"># cat /etc/fstab </span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># /etc/fstab</span><br><span class="hljs-comment"># Created by anaconda on Tue Jun 28 17:51:01 2022</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Accessible filesystems, by reference, are maintained under &#x27;/dev/disk&#x27;</span><br><span class="hljs-comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span><br><span class="hljs-comment">#</span><br>/dev/mapper/centos-root /                       xfs     defaults        0 0<br>UUID=47e57ec3-dc25-40b5-a567-619b8697712f /boot                   xfs     defaults        0 0<br>/dev/md1                    /mydata    defaults        0 0<br><br><br>[root@localhost ~]<span class="hljs-comment"># mkdir /mydata</span><br><br>[root@localhost ~]<span class="hljs-comment"># mount -a</span><br>[root@localhost ~]<span class="hljs-comment"># df -hT</span><br>Filesystem              Type      Size  Used Avail Use% Mounted on<br>/dev/mapper/centos-root xfs        17G  1.4G   16G   9% /<br>devtmpfs                devtmpfs  475M     0  475M   0% /dev<br>tmpfs                   tmpfs     487M     0  487M   0% /dev/shm<br>tmpfs                   tmpfs     487M  7.7M  479M   2% /run<br>tmpfs                   tmpfs     487M     0  487M   0% /sys/fs/cgroup<br>/dev/sda1               xfs      1014M  133M  882M  14% /boot<br>tmpfs                   tmpfs      98M     0   98M   0% /run/user/0<br>/dev/md1                ext4      9.8G   37M  9.2G   1% /mydata<br></code></pre></td></tr></table></figure><h2 id="9、静态配置网卡IP，centos-ubuntu实现"><a href="#9、静态配置网卡IP，centos-ubuntu实现" class="headerlink" title="9、静态配置网卡IP，centos/ubuntu实现"></a>9、静态配置网卡IP，centos/ubuntu实现</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs routeros">[root@localhost network-scripts]# cat /etc/sysconfig/network-scripts/ifcfg-ens37<br><span class="hljs-attribute">TYPE</span>=Ethernet<br><span class="hljs-attribute">BOOTPROTO</span>=static<br><span class="hljs-attribute">NAME</span>=ens37<br><span class="hljs-attribute">DEVICE</span>=ens37<br><span class="hljs-attribute">ONBOOT</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPADDR</span>=192.168.23.101<br><span class="hljs-attribute">NETMASK</span>=255.255.255.0<br><span class="hljs-attribute">GATEWAY</span>=192.168.23.254<br><br>tyh@tyh-virtual-machine:/etc/netplan$ vi 01-network-manager-all.yaml<br>network:<br> version: 2<br> renderer: networkd<br> ethernets:<br>   eth0:<br>     addresses: [192.168.23.201/24]  #或者用下面两行,两种格式不能混用<br>     gateway4:192.168.23.254<br></code></pre></td></tr></table></figure><h2 id="10、图文并茂解释TCP-IP-3次握手4次断开。"><a href="#10、图文并茂解释TCP-IP-3次握手4次断开。" class="headerlink" title="10、图文并茂解释TCP/IP 3次握手4次断开。"></a>10、图文并茂解释TCP/IP 3次握手4次断开。</h2><p>(1) TCP/IP的三次握手：<br>①首先 Client 端发送连接请求报文<br>②Server 段接受连接后回复 ACK 报文，并为这次连接分配资源。<br>③Client 端接收到 ACK 报文后也向 Server 段发生 ACK 报文，并分配资源，这样 TCP 连接就建立了。</p><p><img src="1656237530645.png" alt="1656238302242"></p><p><strong>用川航举例子</strong></p><p>①四川8633请求建立连接(SYN)，并且发送出序号。<br>②服务端接受到信号，即有确认号（ACK）,此时并同样返回请求序号Seq<br>③客户端接受到信号，即有确认号（ACK），连接已经建立。<br><img src="20200319134530223.png" alt="在这里插入图片描述"></p><p><strong>小结</strong>：<code>三次握手的关键是要确认对方收到了自己的数据包</code>，这个目标就是通过“确认号（Ack）”字段实现的。计算机会记录下自己发送的数据包序号Seq，待收到对方的数据包后，检测“确认号（Ack）”字段，<code>看Ack = Seq + 1是否成立，如果成立说明对方正确收到了自己的数据包</code>。 </p><p><strong>如果只有两次握手</strong> <code>这个时候客户端没有回应，这样会浪费服务端的资源</code></p><p><img src="20200319135158648.png" alt="在这里插入图片描述"></p><p>为什么需要第三次通信 ？</p><p>1、在第一次通信过程中，A向B发送信息之后，B收到信息后可以确认自己的收信能力和A的发信能力没有问题。<br>2、在第二次通信中，B向A发送信息之后，A可以确认自己的发信能力和B的收信能力没有问题，但是B不知道自己的发信能力到底如何，所以就需要第三次通信。<br>3、在第三次通信中，A向B发送信息之后，B就可以确认自己的发信能力没有问题。<br>4、 小结：3次握手完成两个重要的功能，既要双方做好发送数据的准备工作(双方都知道彼此已准备好)，也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。</p><p>————————————————<br>版权声明：本文为CSDN博主「辰兮要努力」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/weixin_45393094/article/details/104965561">https://blog.csdn.net/weixin_45393094/article/details/104965561</a></p><p>(2) TCP/IP的四次挥手：</p><p>建立连接非常重要，它是数据正确传输的前提；断开连接同样重要，它让计算机释放不再使用的资源。如果连接不能正常断开，不仅会造成数据传输错误，还会导致套接字不能关闭，持续占用资源，如果并发量高，服务器压力堪忧。 </p><p>第一次挥手：Clien发送一个FIN，用来关闭Client到Server的数据传送，Client进入FIN_WAIT_1状态。<br>第二次挥手：Server收到FIN后，发送一个ACK给Client,Server进入CLOSE_WAIT状态。<br>第三次挥手： Server发送一个FIN，用来关闭Server到Client的数据传送，Server进入LAST_ACK状态。<br>第四次挥手：Client收到FIN后，Client进入TIME_WAIT状态，发送ACK给Server，Server进入CLOSED状态，完成四次握手。</p><p><img src="1656239495710.png" alt="1656239495710"></p><p>川航图举例</p><p>①客户端申请断开连接即FIN （我这边准备断开连接了）<br>②服务端接收信息返回，表示我已经接收到 （收到，请稍等，我这边准备一下）<br>③服务端发送信息表示可以断开连接 (我准备好了，你可以断开连接了）<br>④客户端接受信息，同时返回信息通知服务端自己收到信息，开始断开 连接(好的，拜拜！）</p><p><img src="1656239640058.png" alt="1656239640058"></p><p>数据传输完毕后，双方都可释放连接。最开始的时候，客户端和服务器都是处于ESTABLISHED状态，然后客户端主动关闭，服务器被动关闭。</p><p>为什么连接的时候是三次握手，关闭的时候却是四次握手？</p><p>①因为当Server端收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文是用来应答的，SYN报文是用来同步的。<br>②但是关闭连接时，当Server端收到FIN报文时，很可能并不会立即关闭SOCKET，所以只能先回复一个ACK报文，告诉Client端，“你发的FIN报文我收到了”。<br>③只有等到我Server端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送。故需要四步握手。</p><p><strong>补充问题</strong></p><ul><li><strong>📝TCP的三次握手一定能保证传输可靠吗？</strong><code>不能</code></li><li>三次握手比两次更可靠，但也不是完全可靠，而追加更多次握手也不能使连接更可靠了。因此选择了三次握手。</li><li>世界上不存在完全可靠的通信协议。从通信时间成本空间成本以及可靠度来讲，选择了“三次握手”作为点对点通信的一般规则</li></ul><p>————————————————<br>版权声明：本文为CSDN博主「辰兮要努力」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/weixin_45393094/article/details/104965561">https://blog.csdn.net/weixin_45393094/article/details/104965561</a></p><h2 id="11、网卡绑定bond0的实现"><a href="#11、网卡绑定bond0的实现" class="headerlink" title="11、网卡绑定bond0的实现"></a>11、网卡绑定bond0的实现</h2><p>bond聚合链路模式共7种模式：0-6 Mode </p><p>mod=0 ，即：(balance-rr) Round-robin policy（轮询）聚合口数据报文按包轮询从物理接口转 发。<br>mod=1，即： (active-backup) Active-backup policy（主-备份策略）只有Active状态的物理接口 才转发数据报文。<br>mod=2，即：(balance-xor) XOR policy（平衡策略）聚合口数据报文按源目MAC、源目IP、源目 端口进行异或HASH运算得到一个值，根据该值查找接口转发数据报文 。<br>mod=3，即：broadcast（广播策略）这种模式的特点是一个报文会复制两份往bond下的两个接 口分别发送出去，<br>mod=4，即：(802.3ad) IEEE 802.3ad Dynamic link aggregation（IEEE 802.3ad 动态链接聚 合）<br>mod=5，即：(balance-tlb) Adaptive transmit load balancing（适配器传输负载均衡）<br>mod=6，即：(balance-alb) Adaptive load balancing（适配器适应性负载均衡）   </p><p>说明：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dns">常用的模式为 <span class="hljs-number">0,1,3,6</span><br>mode <span class="hljs-number">1</span>、<span class="hljs-number">5</span>、<span class="hljs-number">6</span> 不需要交换机设置<br>mode <span class="hljs-number">0、2、3、4</span>需要交换机设置<br>active-backup、balance-tlb 和 balance-alb 模式不需要交换机的任何特殊配置。其他绑定模式需<br>要配置交换机以便整合链接。如：Cisco 交换机需要在模式 <span class="hljs-number">0</span>、<span class="hljs-number">2</span> 和 <span class="hljs-number">3</span> 中使用 EtherChannel，但在模<br>式<span class="hljs-number">4</span>中需要 LACP和 EtherChannel<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs routeros">[root@localhost network-scripts]# nmcli conne<br>NAME   UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33  4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>ens37  4a5516a4-dfa4-24af-b1c4-e843e312e2fd <span class="hljs-built_in"> ethernet </span> ens37  <br>[root@localhost network-scripts]# nmcli conn<br>NAME   UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33  4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>ens37  4a5516a4-dfa4-24af-b1c4-e843e312e2fd <span class="hljs-built_in"> ethernet </span> ens37  <br><br>[root@localhost network-scripts]# nmcli<span class="hljs-built_in"> connection </span><span class="hljs-built_in">add</span> con-name mybond0 ifname bond0<span class="hljs-built_in"> type </span>bond mode active-backup ipv4.method<span class="hljs-built_in"> manual </span>ipv4.address 192.168.23.101/24<span class="hljs-built_in"></span><br><span class="hljs-built_in">Connection </span><span class="hljs-string">&#x27;mybond0&#x27;</span> (69f8a919-2ef4-4c69-816d-9c401cc67425) successfully added.<br><br>[root@localhost network-scripts]# ls<br>ifcfg-ens33    ifdown-bnep  ifdown-post    ifdown-TeamPort  ifup-eth   ifup-plusb   ifup-Team         network-functions<br>ifcfg-ens37    ifdown-eth   ifdown-ppp     ifdown-tunnel    ifup-ippp  ifup-post    ifup-TeamPort     network-functions-ipv6<br>ifcfg-lo       ifdown-ippp  ifdown-routes  ifup             ifup-ipv6  ifup-ppp     ifup-tunnel<br>ifcfg-mybond0  ifdown-ipv6  ifdown-sit     ifup-aliases     ifup-isdn  ifup-routes  ifup-wireless<br>ifdown         ifdown-isdn  ifdown-Team    ifup-bnep        ifup-plip  ifup-sit     init.ipv6-global<br>[root@localhost network-scripts]# cat ifcfg-mybond0 <br><span class="hljs-attribute">BONDING_OPTS</span>=mode=active-backup<br><span class="hljs-attribute">TYPE</span>=Bond<br><span class="hljs-attribute">BONDING_MASTER</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">PROXY_METHOD</span>=none<br><span class="hljs-attribute">BROWSER_ONLY</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">BOOTPROTO</span>=none<br><span class="hljs-attribute">IPADDR</span>=192.168.23.101<br><span class="hljs-attribute">PREFIX</span>=24<br><span class="hljs-attribute">DEFROUTE</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPV4_FAILURE_FATAL</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">IPV6INIT</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPV6_AUTOCONF</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPV6_DEFROUTE</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">IPV6_FAILURE_FATAL</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">IPV6_ADDR_GEN_MODE</span>=stable-privacy<br><span class="hljs-attribute">NAME</span>=mybond0<br><span class="hljs-attribute">UUID</span>=69f8a919-2ef4-4c69-816d-9c401cc67425<br><span class="hljs-attribute">DEVICE</span>=bond0<br><span class="hljs-attribute">ONBOOT</span>=<span class="hljs-literal">yes</span><br>[root@localhost network-scripts]# nmcli conn<br>NAME     UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33    4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>ens37    4a5516a4-dfa4-24af-b1c4-e843e312e2fd <span class="hljs-built_in"> ethernet </span> ens37  <br>mybond0  69f8a919-2ef4-4c69-816d-9c401cc67425  bond      bond0  <br><br>[root@localhost network-scripts]# nmcli con <span class="hljs-built_in">add</span><span class="hljs-built_in"> type </span>bond-slave ifname ens33 master bond0<span class="hljs-built_in"></span><br><span class="hljs-built_in">Connection </span><span class="hljs-string">&#x27;bond-slave-ens33&#x27;</span> (c700dceb-866f-4ec2-9d3d-192e60208555) successfully added.<br>[root@localhost network-scripts]# nmcli con <span class="hljs-built_in">add</span><span class="hljs-built_in"> type </span>bond-slave ifname ens37 master bond0<span class="hljs-built_in"></span><br><span class="hljs-built_in">Connection </span><span class="hljs-string">&#x27;bond-slave-ens37&#x27;</span> (a92a8c76-fd96-4647-844c-28941760fee6) successfully added.<br>[root@localhost network-scripts]# nmcli conn<br>NAME              UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33             4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>ens37             4a5516a4-dfa4-24af-b1c4-e843e312e2fd <span class="hljs-built_in"> ethernet </span> ens37  <br>mybond0           69f8a919-2ef4-4c69-816d-9c401cc67425  bond      bond0  <br>bond-slave-ens33  c700dceb-866f-4ec2-9d3d-192e60208555 <span class="hljs-built_in"> ethernet </span> --     <br>bond-slave-ens37  a92a8c76-fd96-4647-844c-28941760fee6 <span class="hljs-built_in"> ethernet </span> --  <br><br>[root@localhost network-scripts]# nmcli conn up bond-slave-ens33<span class="hljs-built_in"></span><br><span class="hljs-built_in">Connection </span>successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/5)<br>[root@localhost network-scripts]# nmcli conn<br>NAME              UUID                                 <span class="hljs-built_in"> TYPE </span>     DEVICE <br>ens33             4b102f8b-d8e3-498e-a7b0-80b138f80f5f <span class="hljs-built_in"> ethernet </span> ens33  <br>mybond0           69f8a919-2ef4-4c69-816d-9c401cc67425  bond      bond0  <br>bond-slave-ens37  a92a8c76-fd96-4647-844c-28941760fee6 <span class="hljs-built_in"> ethernet </span> ens37  <br>bond-slave-ens33  c700dceb-866f-4ec2-9d3d-192e60208555 <span class="hljs-built_in"> ethernet </span> --     <br>bond-slave-eth1   5e9bf4b1-c300-4432-8184-4a94dd47d65e <span class="hljs-built_in"> ethernet </span> --     <br>ethernet-ens37    429edf31-7af6-4375-8b8a-9060d6a9d755 <span class="hljs-built_in"> ethernet </span> --    <br></code></pre></td></tr></table></figure><p>查看两块网卡的主从：</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs tcl">[root@localhost network-scripts]# cat /<span class="hljs-keyword">proc</span>/net/bonding/bond0<span class="hljs-title"> </span><br><span class="hljs-title">Ethernet</span> Channel<span class="hljs-title"> Bonding</span> Driver:<span class="hljs-title"> v3.7.1</span> (April 27, 2011)<span class="hljs-title"></span><br><span class="hljs-title"></span><br><span class="hljs-title">Bonding</span> Mode:<span class="hljs-title"> fault-tolerance</span> (active-backup)           // 使用的模式，主-备份策略<span class="hljs-title"></span><br><span class="hljs-title">Primary</span> Slave:<span class="hljs-title"> None</span><br>Currently<span class="hljs-title"> Active</span> Slave:<span class="hljs-title"> ens37</span>                           //<span class="hljs-title"> ens37现在是干活的，ens33为备用</span><br>MII<span class="hljs-title"> Status:</span> up<span class="hljs-title"></span><br><span class="hljs-title">MII</span> Polling<span class="hljs-title"> Interval</span> (ms): 100<span class="hljs-title"></span><br><span class="hljs-title">Up</span> Delay (ms): 0<span class="hljs-title"></span><br><span class="hljs-title">Down</span> Delay (ms): 0<span class="hljs-title"></span><br><span class="hljs-title"></span><br><span class="hljs-title">Slave</span> Interface:<span class="hljs-title"> ens37</span><br>MII<span class="hljs-title"> Status:</span> up<span class="hljs-title"></span><br><span class="hljs-title">Speed:</span> 1000<span class="hljs-title"> Mbps</span><br>Duplex:<span class="hljs-title"> full</span><br>Link<span class="hljs-title"> Failure</span> Count: 0<span class="hljs-title"></span><br><span class="hljs-title">Permanent</span> HW<span class="hljs-title"> addr:</span> 00:0c:29:32:65:0e<span class="hljs-title"></span><br><span class="hljs-title">Slave</span> queue<span class="hljs-title"> ID:</span> 0<span class="hljs-title"></span><br><span class="hljs-title"></span><br><span class="hljs-title">Slave</span> Interface:<span class="hljs-title"> ens33</span><br>MII<span class="hljs-title"> Status:</span> up<span class="hljs-title"></span><br><span class="hljs-title">Speed:</span> 1000<span class="hljs-title"> Mbps</span><br>Duplex:<span class="hljs-title"> full</span><br>Link<span class="hljs-title"> Failure</span> Count: 0<span class="hljs-title"></span><br><span class="hljs-title">Permanent</span> HW<span class="hljs-title"> addr:</span> 00:0c:29:32:65:04<span class="hljs-title"></span><br><span class="hljs-title">Slave</span> queue<span class="hljs-title"> ID:</span> 0<br></code></pre></td></tr></table></figure><p>12、实现免密登陆脚本, expect登陆远程主机，将生成的密钥写入到目标主机, expect测试远程登陆。<br>     1）通过shift读取脚本参数<br>     2）通过select来选择功能.例如功能有</p><ul><li>安装mysql</li><li>安装apache</li><li>免密钥登陆主机<br>当前我们只实现免密钥登陆主机<br>3）通过函数封装每个功能<br>4）将免密钥登陆的过程可以重复进行, while 循环实现重复，需要有退出过程。当用户输入exit时，退出免密钥功能。<br>5）支持输入一批主机免密钥，使用数组 实现</li></ul><p>[root@localhost ~]# vim ssh.sh<br>[root@localhost ~]# cat ssh.sh<br>#!/bin/bash</p><p>read -p “Which IP address you want to connect to?:” ip<br>read -s -p “and password:” pwd     #-s要在前面表示静默输出，保护密码</p><p>yum -y install openssh expect</p><p>expect &lt;&lt; EOF     #表示里面的内容均由expect命令去执行</p><p>set timeout 30     #设置超时时间为30秒，下面的代码需在30秒钟内完成，如果超过，则退出。用来防止ssh远程主机网络不可达时卡住及在远程主机执行命令宕住</p><p>spawn   ssh-keygen  #激活一个交互式会话，在系统中创建一个进程</p><p>expect     {<br>        “.ssh/id_rsa)”       { send    “\r”;  exp_continue } #捕捉关键字，然后回车<br>        “Overwrite (y/n)?”   { send    “y\r”; exp_continue } #捕捉关键字后输入y然后回车<br>        “no passphrase):”    { send    “\r”;  exp_continue }<br>        “again:”             { send    “\r”;  exp_continue }<br>}</p><p>spawn ssh-copy-id root@$ip</p><p>expect {<br>     “yes/no”   { send “yes\r”;  exp_continue }<br>     “password” { send “$pwd\r”; exp_continue }<br>}<br>EOF</p><p>[root@localhost ~]# ./ssh.sh<br>Which IP address you want to connect to?:192.168.216.200<br>and password:1<br>spawn ssh-keygen<br>Generating public/private rsa key pair.<br>Enter file in which to save the key (/root/.ssh/id_rsa):<br>/root/.ssh/id_rsa already exists.<br>Overwrite (y/n)? y<br>Enter passphrase (empty for no passphrase):<br>Enter same passphrase again:<br>Your identification has been saved in /root/.ssh/id_rsa.<br>Your public key has been saved in /root/.ssh/id_rsa.pub.<br>The key fingerprint is:<br>SHA256:xaplvcpVheYg5sR/JU6QBlg+jMy9hYqxR1k7AiqK9Bk <a href="mailto:&#x72;&#x6f;&#111;&#x74;&#64;&#x6c;&#111;&#99;&#x61;&#x6c;&#x68;&#x6f;&#x73;&#116;&#46;&#x6c;&#111;&#99;&#97;&#108;&#100;&#x6f;&#109;&#97;&#105;&#x6e;">&#x72;&#x6f;&#111;&#x74;&#64;&#x6c;&#111;&#99;&#x61;&#x6c;&#x68;&#x6f;&#x73;&#116;&#46;&#x6c;&#111;&#99;&#97;&#108;&#100;&#x6f;&#109;&#97;&#105;&#x6e;</a><br>The key’s randomart image is:<br>+—[RSA 2048]—-+<br>|    .  o+…     |<br>|   . +.O +o. .   |<br>|…E. B &amp;.= = o  |<br>|+.. o= * @ * +   |<br>|o  oo o S o =    |<br>|     . +   +     |<br>|      .   o      |<br>|       . o       |<br>|        o        |<br>+—-[SHA256]—–+<br>spawn ssh-copy-id <a href="mailto:&#x72;&#111;&#111;&#116;&#x40;&#x31;&#57;&#x32;&#46;&#x31;&#54;&#x38;&#x2e;&#50;&#x31;&#x36;&#46;&#50;&#48;&#x30;">&#x72;&#111;&#111;&#116;&#x40;&#x31;&#57;&#x32;&#46;&#x31;&#54;&#x38;&#x2e;&#50;&#x31;&#x36;&#46;&#50;&#48;&#x30;</a><br>/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: “/root/.ssh/id_rsa.pub”<br>/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed<br>/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed – if you are prompted now it is to install the new keys<br><a href="mailto:&#x72;&#x6f;&#111;&#x74;&#x40;&#49;&#57;&#50;&#46;&#x31;&#x36;&#x38;&#x2e;&#50;&#x31;&#54;&#x2e;&#x32;&#48;&#x30;">&#x72;&#x6f;&#111;&#x74;&#x40;&#49;&#57;&#50;&#46;&#x31;&#x36;&#x38;&#x2e;&#50;&#x31;&#54;&#x2e;&#x32;&#48;&#x30;</a>‘s password: </p><p>Number of key(s) added: 1</p><p>Now try logging into the machine, with:   “ssh ‘<a href="mailto:&#114;&#111;&#111;&#x74;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#54;&#x38;&#46;&#50;&#49;&#x36;&#46;&#x32;&#x30;&#48;">&#114;&#111;&#111;&#x74;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#54;&#x38;&#46;&#50;&#49;&#x36;&#46;&#x32;&#x30;&#48;</a>‘“<br>and check to make sure that only the key(s) you wanted were added.</p><h2 id="12、免交互实例（免密登陆）"><a href="#12、免交互实例（免密登陆）" class="headerlink" title="12、免交互实例（免密登陆）"></a>12、免交互实例（免密登陆）</h2><p>#!/bin/bash<br>yum -y install expect<br>ip=$1<br>passwd=$2<br>/usr/bin/expect&lt;&lt;EOF<br>spawn ssh-keygen -t rsa<br>expect {<br>        “(/root/.ssh/id_rsa)”<br>        {send “\r”;exp_continue}<br>        “(empty for no passphrase)”<br>        {send “\r”;exp_continue}<br>        “passphrase again”<br>        {send “\r”}<br>}<br>expect eof<br>EOF<br>/usr/bin/expect&lt;&lt;EOF<br>spawn ssh-copy-id $1<br>expect {<br>        “(yes/no)”<br>        {send “yes\r”;exp_continue}<br>        “password”<br>        {send “$2\r”}<br>}<br>expect eof<br>EOF<br>ssh root@$1 </p>]]></content>
    
    
    <categories>
      
      <category>作业</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>1、计算机基础和linux安装</title>
    <link href="/2022/06/18/1%E3%80%81%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%92%8Clinux%E5%AE%89%E8%A3%85/"/>
    <url>/2022/06/18/1%E3%80%81%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E5%92%8Clinux%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><span id="more"></span><h1 id="安装linux操作系统"><a href="#安装linux操作系统" class="headerlink" title="安装linux操作系统"></a>安装linux操作系统</h1><p>获取发行版</p><p>CentOS</p><p><a href="https://wiki.centos.org/Download">https://wiki.centos.org/Download</a><br><a href="http://mirrors.aliyun.com/">http://mirrors.aliyun.com</a></p><p><a href="https://mirrors.aliyun.com/centos/7.9.2009/isos/x86_64/">https://mirrors.aliyun.com/centos/7.9.2009/isos/x86_64/</a></p><p><a href="http://mirrors.sohu.com/">http://mirrors.sohu.com</a><br><a href="http://mirrors.163.com/">http://mirrors.163.com</a><br><a href="https://mirrors.tuna.tsinghua.edu.cn/centos/">https://mirrors.tuna.tsinghua.edu.cn/centos/</a></p><p>Ubuntu</p><p> <a href="http://cdimage.ubuntu.com/releases/">http://cdimage.ubuntu.com/releases/</a>                Server版</p><p> <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cdimage/releases/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cdimage/releases/</a> <a href="http://releases.ubuntu.com/">http://releases.ubuntu.com/</a> </p><p> <a href="http://mirrors.aliyun.com/ubuntu-releases/">http://mirrors.aliyun.com/ubuntu-releases/</a>      Desktop版 </p><p> <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu-releases/">https://mirrors.tuna.tsinghua.edu.cn/ubuntu-releases/</a> </p><h1 id="linux基础"><a href="#linux基础" class="headerlink" title="linux基础"></a>linux基础</h1><h2 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h2><p><strong>二进制和十进制转换：</strong></p><p>2^0=1=1b<br>2^1=2=10b<br>2^3=8=1000b<br>2^4=16=10000b<br>2^5=32=100000b<br>2^6=64=1000000b<br>2^7=128=10000000b<br>2^8=256=100000000b<br>2^9=512=1000000000b<br>2^10=1024=10000000000b<br>2^11=2048=100000000000b<br>2^12=4096=1000000000000b</p><p>[root@node1 ~]# <strong>yum install bc</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><pre><code class="hljs scala">[root<span class="hljs-meta">@node</span>1 ~]# bc        <span class="hljs-comment">// 交互式使用计算器</span><br>bc <span class="hljs-number">1.06</span><span class="hljs-number">.95</span><br><span class="hljs-type">Copyright</span> <span class="hljs-number">1991</span><span class="hljs-number">-1994</span>, <span class="hljs-number">1997</span>, <span class="hljs-number">1998</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">2004</span>, <span class="hljs-number">2006</span> <span class="hljs-type">Free</span> <span class="hljs-type">Software</span> <span class="hljs-type">Foundation</span>, <span class="hljs-type">Inc</span>.<br><span class="hljs-type">This</span> is free software <span class="hljs-keyword">with</span> <span class="hljs-type">ABSOLUTELY</span> <span class="hljs-type">NO</span> <span class="hljs-type">WARRANTY</span>.<br><span class="hljs-type">For</span> details <span class="hljs-class"><span class="hljs-keyword">type</span> `<span class="hljs-title">warranty</span>&#x27;. </span><br><span class="hljs-number">2</span>*<span class="hljs-number">3</span>          <span class="hljs-comment">// 乘法</span><br><span class="hljs-number">6</span><br><span class="hljs-number">2</span>^<span class="hljs-number">3</span>          <span class="hljs-comment">// 2的3次方</span><br><span class="hljs-number">8</span><br>obase=<span class="hljs-number">2</span>      <span class="hljs-comment">// 将输入的值，转换为二进制</span><br><span class="hljs-number">10</span><br><span class="hljs-number">1010</span><br><span class="hljs-number">8</span><br><span class="hljs-number">1000</span><br><br>[root<span class="hljs-meta">@node</span>1 ~]# echo <span class="hljs-string">&quot;obase=2;255&quot;</span>|bc     <span class="hljs-comment">// 非交互式，将输入的默认十进制数字，转换为二进制 </span><br><span class="hljs-number">11111111</span><br><br>[root<span class="hljs-meta">@node</span>1 ~]# echo <span class="hljs-string">&quot;obase=10;8&quot;</span>|bc<br><span class="hljs-number">8</span><br><br><br>[root<span class="hljs-meta">@node</span>1 ~]# echo <span class="hljs-string">&quot;obase=10;ibase=8;377&quot;</span>|bc  <span class="hljs-comment">// 非交互式，将输入的八进制数字，转换为十进制</span><br><span class="hljs-number">255</span><br><br>[root<span class="hljs-meta">@node</span>1 ~]# echo <span class="hljs-string">&quot;obase=10;ibase=2;11111111&quot;</span>|bc  <span class="hljs-comment">// 非交互式，将输入的二进制数字，转换为十进制</span><br><span class="hljs-number">255</span><br><br>[root<span class="hljs-meta">@node</span>1 ~]# echo <span class="hljs-string">&quot;obase=16;ibase=2;11111111&quot;</span>|bc  <span class="hljs-comment">// 非交互式，将输入的二进制数字，转换为十六进制</span><br><span class="hljs-type">FF</span><br></code></pre></td></tr></table></figure><h2 id="设置主机名"><a href="#设置主机名" class="headerlink" title="设置主机名"></a>设置主机名</h2><p>注意： 主机名不支持使用下划线，但支持横线，可使用字母，横线或数字组合 </p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@localhost</span> ~]<span class="hljs-meta"># hostnamectl set-hostname node1</span><br>[root<span class="hljs-symbol">@localhost</span> ~]<span class="hljs-meta"># hostname</span><br>node1<br>[root<span class="hljs-symbol">@node1</span> ~]<span class="hljs-meta"># cat /etc/hostname </span><br>node1<br></code></pre></td></tr></table></figure><h2 id="查看硬件信息"><a href="#查看硬件信息" class="headerlink" title="查看硬件信息"></a>查看硬件信息</h2><h3 id="查看cpu"><a href="#查看cpu" class="headerlink" title="查看cpu"></a>查看cpu</h3><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs tcl">[root@node1 ~]# lscpu<br>Architecture:          x86_64<br>CPU op-mode(s):        <span class="hljs-number">32</span>-bit, <span class="hljs-number">64</span>-bit<br>Byte Order:            Little Endian<br>CPU(s):                <span class="hljs-number">1</span><br>On-line CPU(s) <span class="hljs-keyword">list</span>:   <span class="hljs-number">0</span><br>Thread(s) per core:    <span class="hljs-number">1</span><br>Core(s) per <span class="hljs-keyword">socket</span>:    <span class="hljs-number">1</span><br>Socket(s):             <span class="hljs-number">1</span><br>NUMA node(s):          <span class="hljs-number">1</span><br>Vendor ID:             GenuineIntel<br>CPU family:            <span class="hljs-number">6</span><br>Model:                 <span class="hljs-number">140</span><br>Model name:            <span class="hljs-number">11</span>th Gen Intel(R) Core(TM) i5<span class="hljs-number">-1135</span>G7 @ <span class="hljs-number">2.40</span>GHz<br>Stepping:              <span class="hljs-number">1</span><br>CPU MHz:               <span class="hljs-number">2419.204</span><br>CPU max MHz:           <span class="hljs-number">0.0000</span><br>CPU min MHz:           <span class="hljs-number">0.0000</span><br>BogoMIPS:              <span class="hljs-number">4838.40</span><br>Hypervisor vendor:     VMware<br>Virtualization type:   full<br>L1d cache:             <span class="hljs-number">48</span>K<br>L1i cache:             <span class="hljs-number">32</span>K<br>L2 cache:              <span class="hljs-number">1280</span>K<br>L3 cache:              <span class="hljs-number">8192</span>K<br>NUMA node0 CPU(s):     <span class="hljs-number">0</span><br>Flags:                 fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm <span class="hljs-number">3</span>dnowprefetch epb invpcid_single fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid rdseed adx smap xsaveopt dtherm ida arat pln pts hwp hwp_notify hwp_act_window hwp_epp hwp_pkg_req<br><br>[root@node1 ~]# cat /<span class="hljs-keyword">proc</span>/cpuinfo<span class="hljs-title"> </span><br><span class="hljs-title">processor</span>: 0<span class="hljs-title"></span><br><span class="hljs-title">vendor_id</span>:<span class="hljs-title"> GenuineIntel</span><br>cpu<span class="hljs-title"> family</span>: 6<span class="hljs-title"></span><br><span class="hljs-title">model</span>: 140<span class="hljs-title"></span><br><span class="hljs-title">model</span> name: 11th<span class="hljs-title"> Gen</span> Intel(R)<span class="hljs-title"> Core(TM)</span> i5-1135G7 @ 2.40GHz<span class="hljs-title"></span><br><span class="hljs-title">stepping</span>: 1<span class="hljs-title"></span><br><span class="hljs-title">microcode</span>: 0xa4<span class="hljs-title"></span><br><span class="hljs-title">cpu</span> MHz: 2419.204<span class="hljs-title"></span><br><span class="hljs-title">cache</span> size: 8192<span class="hljs-title"> KB</span><br>physical<span class="hljs-title"> id</span>: 0<span class="hljs-title"></span><br><span class="hljs-title">siblings</span>: 1<span class="hljs-title"></span><br><span class="hljs-title">core</span> id: 0<span class="hljs-title"></span><br><span class="hljs-title">cpu</span> cores: 1<span class="hljs-title"></span><br><span class="hljs-title">apicid</span>: 0<span class="hljs-title"></span><br><span class="hljs-title">initial</span> apicid: 0<span class="hljs-title"></span><br><span class="hljs-title">fpu</span>:<span class="hljs-title"> yes</span><br>fpu_exception:<span class="hljs-title"> yes</span><br>cpuid<span class="hljs-title"> level</span>: 27<span class="hljs-title"></span><br><span class="hljs-title">wp</span>:<span class="hljs-title"> yes</span><br>flags:<span class="hljs-title"> fpu</span> vme<span class="hljs-title"> de</span> pse<span class="hljs-title"> tsc</span> msr<span class="hljs-title"> pae</span> mce<span class="hljs-title"> cx8</span> apic<span class="hljs-title"> sep</span> mtrr<span class="hljs-title"> pge</span> mca<span class="hljs-title"> cmov</span> pat<span class="hljs-title"> pse36</span> clflush<span class="hljs-title"> dts</span> mmx<span class="hljs-title"> fxsr</span> sse<span class="hljs-title"> sse2</span> ss<span class="hljs-title"> syscall</span> nx<span class="hljs-title"> pdpe1gb</span> rdtscp<span class="hljs-title"> lm</span> constant_tsc<span class="hljs-title"> arch_perfmon</span> pebs<span class="hljs-title"> bts</span> nopl<span class="hljs-title"> xtopology</span> tsc_reliable<span class="hljs-title"> nonstop_tsc</span> aperfmperf<span class="hljs-title"> eagerfpu</span> pni<span class="hljs-title"> pclmulqdq</span> ssse3<span class="hljs-title"> fma</span> cx16<span class="hljs-title"> pcid</span> sse4_1<span class="hljs-title"> sse4_2</span> x2apic<span class="hljs-title"> movbe</span> popcnt<span class="hljs-title"> tsc_deadline_timer</span> aes<span class="hljs-title"> xsave</span> avx<span class="hljs-title"> f16c</span> rdrand<span class="hljs-title"> hypervisor</span> lahf_lm<span class="hljs-title"> abm</span> 3dnowprefetch<span class="hljs-title"> epb</span> invpcid_single<span class="hljs-title"> fsgsbase</span> tsc_adjust<span class="hljs-title"> bmi1</span> avx2<span class="hljs-title"> smep</span> bmi2<span class="hljs-title"> invpcid</span> rdseed<span class="hljs-title"> adx</span> smap<span class="hljs-title"> xsaveopt</span> dtherm<span class="hljs-title"> ida</span> arat<span class="hljs-title"> pln</span> pts<span class="hljs-title"> hwp</span> hwp_notify<span class="hljs-title"> hwp_act_window</span> hwp_epp<span class="hljs-title"> hwp_pkg_req</span><br>bogomips: 4838.40<span class="hljs-title"></span><br><span class="hljs-title">clflush</span> size: 64<span class="hljs-title"></span><br><span class="hljs-title">cache_alignment</span>: 64<span class="hljs-title"></span><br><span class="hljs-title">address</span> sizes: 42<span class="hljs-title"> bits</span> physical, 48<span class="hljs-title"> bits</span> virtual<span class="hljs-title"></span><br><span class="hljs-title">power</span> management:<br><br>[root@node1 ~]#<span class="hljs-title"> getconf</span> LONG_BIT          // 查看cpu位数<br>64<br><br>[root@node1 ~]#<span class="hljs-title"> grep</span> &quot;model<span class="hljs-title"> name&quot;</span>  /<span class="hljs-keyword">proc</span>/cpuinfo  |cut -d &quot;:&quot; -f2<br> 11th<span class="hljs-title"> Gen</span> Intel(R)<span class="hljs-title"> Core(TM)</span> i5-1135G7 @ 2.40GHz<br> <br>[root@node1 ~]#<span class="hljs-title"> grep</span> &quot;processor&quot; /<span class="hljs-keyword">proc</span>/cpuinfo  |wc -l  // 查看逻辑CPU的个数<br>1<br></code></pre></td></tr></table></figure><h3 id="查看内存"><a href="#查看内存" class="headerlink" title="查看内存"></a>查看内存</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs yaml">[<span class="hljs-string">root@node1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># free</span><br>              <span class="hljs-string">total</span>        <span class="hljs-string">used</span>        <span class="hljs-string">free</span>      <span class="hljs-string">shared</span>  <span class="hljs-string">buff/cache</span>   <span class="hljs-string">available</span><br><span class="hljs-attr">Mem:</span>         <span class="hljs-number">995676</span>      <span class="hljs-number">124876</span>      <span class="hljs-number">776380</span>        <span class="hljs-number">7840       </span><span class="hljs-number">94420</span>      <span class="hljs-number">748284</span><br><span class="hljs-attr">Swap:</span>       <span class="hljs-number">2097148</span>           <span class="hljs-number">0</span>     <span class="hljs-number">2097148</span><br><br>[<span class="hljs-string">root@node1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># free -h</span><br>              <span class="hljs-string">total</span>        <span class="hljs-string">used</span>        <span class="hljs-string">free</span>      <span class="hljs-string">shared</span>  <span class="hljs-string">buff/cache</span>   <span class="hljs-string">available</span><br><span class="hljs-attr">Mem:</span>           <span class="hljs-string">972M</span>        <span class="hljs-string">123M</span>        <span class="hljs-string">753M</span>        <span class="hljs-number">7.</span><span class="hljs-string">6M</span>         <span class="hljs-string">95M</span>        <span class="hljs-string">727M</span><br><span class="hljs-attr">Swap:</span>          <span class="hljs-number">2.</span><span class="hljs-string">0G</span>          <span class="hljs-string">0B</span>        <span class="hljs-number">2.</span><span class="hljs-string">0G</span><br><br>[<span class="hljs-string">root@node1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># cat /proc/meminfo </span><br><span class="hljs-attr">MemTotal:</span>         <span class="hljs-number">995676</span> <span class="hljs-string">kB</span>                 <span class="hljs-string">//</span> <span class="hljs-string">内存总量</span><br><span class="hljs-attr">MemFree:</span>          <span class="hljs-number">776668</span> <span class="hljs-string">kB</span><span class="hljs-string">//</span> <span class="hljs-string">空闲内存量</span><br><span class="hljs-attr">MemAvailable:</span>     <span class="hljs-number">748572</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Buffers:</span>            <span class="hljs-number">2108 </span><span class="hljs-string">kB</span><br><span class="hljs-attr">Cached:</span>            <span class="hljs-number">76396</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">SwapCached:</span>            <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Active:</span>            <span class="hljs-number">50152</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Inactive:</span>          <span class="hljs-number">58288</span> <span class="hljs-string">kB</span><br><span class="hljs-string">Active(anon):</span>      <span class="hljs-number">30412</span> <span class="hljs-string">kB</span><br><span class="hljs-string">Inactive(anon):</span>     <span class="hljs-number">7364 </span><span class="hljs-string">kB</span><br><span class="hljs-string">Active(file):</span>      <span class="hljs-number">19740</span> <span class="hljs-string">kB</span><br><span class="hljs-string">Inactive(file):</span>    <span class="hljs-number">50924</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Unevictable:</span>           <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Mlocked:</span>               <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">SwapTotal:</span>       <span class="hljs-number">2097148</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">SwapFree:</span>        <span class="hljs-number">2097148</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Dirty:</span>                 <span class="hljs-number">4</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Writeback:</span>             <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">AnonPages:</span>         <span class="hljs-number">29968</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Mapped:</span>            <span class="hljs-number">21552</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Shmem:</span>              <span class="hljs-number">7840 </span><span class="hljs-string">kB</span><br><span class="hljs-attr">Slab:</span>              <span class="hljs-number">39224</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">SReclaimable:</span>      <span class="hljs-number">15916</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">SUnreclaim:</span>        <span class="hljs-number">23308</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">KernelStack:</span>        <span class="hljs-number">3824 </span><span class="hljs-string">kB</span><br><span class="hljs-attr">PageTables:</span>         <span class="hljs-number">3588 </span><span class="hljs-string">kB</span><br><span class="hljs-attr">NFS_Unstable:</span>          <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Bounce:</span>                <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">WritebackTmp:</span>          <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">CommitLimit:</span>     <span class="hljs-number">2594984</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Committed_AS:</span>     <span class="hljs-number">232484</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">VmallocTotal:</span>   <span class="hljs-number">34359738367</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">VmallocUsed:</span>      <span class="hljs-number">177448</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">VmallocChunk:</span>   <span class="hljs-number">34359310332</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">Percpu:</span>            <span class="hljs-number">22528</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">HardwareCorrupted:</span>     <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">AnonHugePages:</span>      <span class="hljs-number">8192 </span><span class="hljs-string">kB</span><br><span class="hljs-attr">CmaTotal:</span>              <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">CmaFree:</span>               <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">HugePages_Total:</span>       <span class="hljs-number">0</span><br><span class="hljs-attr">HugePages_Free:</span>        <span class="hljs-number">0</span><br><span class="hljs-attr">HugePages_Rsvd:</span>        <span class="hljs-number">0</span><br><span class="hljs-attr">HugePages_Surp:</span>        <span class="hljs-number">0</span><br><span class="hljs-attr">Hugepagesize:</span>       <span class="hljs-number">2048 </span><span class="hljs-string">kB</span><br><span class="hljs-attr">DirectMap4k:</span>       <span class="hljs-number">67456</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">DirectMap2M:</span>      <span class="hljs-number">980992</span> <span class="hljs-string">kB</span><br><span class="hljs-attr">DirectMap1G:</span>           <span class="hljs-number">0</span> <span class="hljs-string">kB</span><br></code></pre></td></tr></table></figure><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-punctuation">[</span><span class="hljs-variable">root</span><span class="hljs-operator">@</span><span class="hljs-variable">node1</span> <span class="hljs-operator">~</span><span class="hljs-punctuation">]</span><span class="hljs-type">#</span> <span class="hljs-variable">dmidecode</span> <span class="hljs-operator">-</span><span class="hljs-variable">t</span> <span class="hljs-variable">memory</span><span class="hljs-operator">|</span><span class="hljs-variable">grep</span> <span class="hljs-operator">-</span><span class="hljs-variable">i</span> <span class="hljs-variable">size</span><br><span class="hljs-variable">Maximum</span> <span class="hljs-variable">Memory</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-number">32768</span> <span class="hljs-variable">MB</span><br><span class="hljs-variable">Maximum</span> <span class="hljs-built_in">Total</span> <span class="hljs-variable">Memory</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-number">491520</span> <span class="hljs-variable">MB</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-number">1024</span> <span class="hljs-variable">MB</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Single</span><span class="hljs-operator">-</span><span class="hljs-variable">bank</span> <span class="hljs-variable">Connection</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-number">1024</span> <span class="hljs-variable">MB</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Single</span><span class="hljs-operator">-</span><span class="hljs-variable">bank</span> <span class="hljs-variable">Connection</span><span class="hljs-punctuation">)</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Installed</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-built_in">Enabled</span> <span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-built_in">Not</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-number">1024</span> <span class="hljs-variable">MB</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br><span class="hljs-variable">Size</span><span class="hljs-operator">:</span> <span class="hljs-variable">No</span> <span class="hljs-built_in">Module</span> <span class="hljs-variable">Installed</span><br></code></pre></td></tr></table></figure><h4 id="范例：内存故障"><a href="#范例：内存故障" class="headerlink" title="范例：内存故障"></a>范例：内存故障</h4><p>2019-12-25，央视西区20套高清备播出服务器，多个频道出现播出异常，视频服务器MSV-G的播出应用日志显示内存异常，在对应的uml-e存储使用命令查看内存，发现有一跟内存出现故障，不被系统所识别了，最终更换硬件得以解决。</p><p>dmidecode -t memory|grep Size   （正常是三根内存，每根4G） </p><p><img src="1655632709294.png" alt="1655632709294"></p><h3 id="查看硬盘和分区情况"><a href="#查看硬盘和分区情况" class="headerlink" title="查看硬盘和分区情况"></a>查看硬盘和分区情况</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@node1 ~]<span class="hljs-comment"># ll /dev/sd*</span><br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 0 </span>Jun<span class="hljs-number"> 19 </span>04:25 /dev/sda<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 1 </span>Jun<span class="hljs-number"> 19 </span>04:25 /dev/sda1<br>brw-rw----<span class="hljs-number"> 1 </span>root disk 8,<span class="hljs-number"> 2 </span>Jun<span class="hljs-number"> 19 </span>04:25 /dev/sda2<br><br>[root@node1 ~]<span class="hljs-comment"># df -h</span><br>Filesystem               Size  Used Avail Use% Mounted on<br>devtmpfs                 475M    <span class="hljs-number"> 0 </span> 475M   0% /dev<br>tmpfs                    487M    <span class="hljs-number"> 0 </span> 487M   0% /dev/shm<br>tmpfs                    487M  7.7M  479M   2% /run<br>tmpfs                    487M    <span class="hljs-number"> 0 </span> 487M   0% /sys/fs/cgroup<br>/dev/mapper/centos-root   17G  1.3G   16G   8% /<br>/dev/sda1               1014M  138M  877M  14% /boot<br>tmpfs                     98M    <span class="hljs-number"> 0 </span>  98M   0% /run/user/0<br><br>[root@node1 ~]<span class="hljs-comment"># lsblk</span><br>NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT<br>sda               8:0   <span class="hljs-number"> 0 </span>  20G <span class="hljs-number"> 0 </span>disk <br>├─sda1            8:1   <span class="hljs-number"> 0 </span>   1G <span class="hljs-number"> 0 </span>part /boot<br>└─sda2            8:2   <span class="hljs-number"> 0 </span>  19G <span class="hljs-number"> 0 </span>part <br>  ├─centos-root 253:0   <span class="hljs-number"> 0 </span>  17G <span class="hljs-number"> 0 </span>lvm  /<br>  └─centos-swap 253:1   <span class="hljs-number"> 0 </span>   2G <span class="hljs-number"> 0 </span>lvm  [SWAP]<br>sr0              11:0   <span class="hljs-number"> 1 </span> 4.4G <span class="hljs-number"> 0 </span>rom<br><br>[root@node1 ~]<span class="hljs-comment"># cat /proc/partitions </span><br>major minor  <span class="hljs-comment">#blocks  name</span><br><br>  <span class="hljs-number"> 8 </span>      <span class="hljs-number"> 0 </span> <span class="hljs-number"> 20971520 </span>sda<br>  <span class="hljs-number"> 8 </span>      <span class="hljs-number"> 1 </span>  <span class="hljs-number"> 1048576 </span>sda1<br>  <span class="hljs-number"> 8 </span>      <span class="hljs-number"> 2 </span> <span class="hljs-number"> 19921920 </span>sda2<br> <span class="hljs-number"> 11 </span>      <span class="hljs-number"> 0 </span>  <span class="hljs-number"> 4601856 </span>sr0<br><span class="hljs-number"> 253 </span>      <span class="hljs-number"> 0 </span> <span class="hljs-number"> 17821696 </span>dm-0<br><span class="hljs-number"> 253 </span>      <span class="hljs-number"> 1 </span>  <span class="hljs-number"> 2097152 </span>dm-1<br></code></pre></td></tr></table></figure><h4 id="范例-扫描新加的磁盘"><a href="#范例-扫描新加的磁盘" class="headerlink" title="范例: 扫描新加的磁盘"></a>范例: 扫描新加的磁盘</h4><p>增加硬盘后需要扫描后，才能被识别到。</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@node1 ~]# ll <span class="hljs-regexp">/dev/</span>sd*<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">8</span>, <span class="hljs-number">0</span> Jun <span class="hljs-number">19</span> <span class="hljs-number">04</span>:<span class="hljs-number">25</span> <span class="hljs-regexp">/dev/</span>sda<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">8</span>, <span class="hljs-number">1</span> Jun <span class="hljs-number">19</span> <span class="hljs-number">04</span>:<span class="hljs-number">25</span> <span class="hljs-regexp">/dev/</span>sda1<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">8</span>, <span class="hljs-number">2</span> Jun <span class="hljs-number">19</span> <span class="hljs-number">04</span>:<span class="hljs-number">25</span> <span class="hljs-regexp">/dev/</span>sda2<br><br>[root@node1 ~]# echo - - - &gt; <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host0/scan;<br>[root@node1 ~]# echo - - - &gt; <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host1/scan;<br>[root@node1 ~]# echo - - - &gt; <span class="hljs-regexp">/sys/</span><span class="hljs-keyword">class</span><span class="hljs-regexp">/scsi_host/</span>host2/scan;<br><br>[root@node1 ~]# ll <span class="hljs-regexp">/dev/</span>sd*<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">8</span>,  <span class="hljs-number">0</span> Jun <span class="hljs-number">19</span> <span class="hljs-number">04</span>:<span class="hljs-number">25</span> <span class="hljs-regexp">/dev/</span>sda<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">8</span>,  <span class="hljs-number">1</span> Jun <span class="hljs-number">19</span> <span class="hljs-number">04</span>:<span class="hljs-number">25</span> <span class="hljs-regexp">/dev/</span>sda1<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">8</span>,  <span class="hljs-number">2</span> Jun <span class="hljs-number">19</span> <span class="hljs-number">04</span>:<span class="hljs-number">25</span> <span class="hljs-regexp">/dev/</span>sda2<br>brw-rw---- <span class="hljs-number">1</span> root disk <span class="hljs-number">8</span>, <span class="hljs-number">16</span> Jun <span class="hljs-number">19</span> <span class="hljs-number">06</span>:<span class="hljs-number">13</span> <span class="hljs-regexp">/dev/</span>sdb<br><br>[root@node1 ~]# lsblk<br>NAME            MAJ:MIN RM  <span class="hljs-keyword">SIZE</span> RO TYPE MOUNTPOINT<br>sda               <span class="hljs-number">8</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">20</span>G  <span class="hljs-number">0</span> disk <br>├─sda1            <span class="hljs-number">8</span>:<span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>G  <span class="hljs-number">0</span> part /boot<br>└─sda2            <span class="hljs-number">8</span>:<span class="hljs-number">2</span>    <span class="hljs-number">0</span>   <span class="hljs-number">19</span>G  <span class="hljs-number">0</span> part <br>  ├─centos-root <span class="hljs-number">253</span>:<span class="hljs-number">0</span>    <span class="hljs-number">0</span>   <span class="hljs-number">17</span>G  <span class="hljs-number">0</span> lvm  /<br>  └─centos-swap <span class="hljs-number">253</span>:<span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">2</span>G  <span class="hljs-number">0</span> lvm  [SWAP]<br>sdb               <span class="hljs-number">8</span>:<span class="hljs-number">16</span>   <span class="hljs-number">0</span>    <span class="hljs-number">2</span>G  <span class="hljs-number">0</span> disk <br>sr0              <span class="hljs-number">11</span>:<span class="hljs-number">0</span>    <span class="hljs-number">1</span>  <span class="hljs-number">4.4</span>G  <span class="hljs-number">0</span> rom<br><br>[root@node1 ~]# df -h<br>Filesystem               <span class="hljs-keyword">Size</span>  Used Avail Use% Mounted on<br>devtmpfs                 <span class="hljs-number">475</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">475</span>M   <span class="hljs-number">0</span>% /dev<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/dev/</span>shm<br>tmpfs                    <span class="hljs-number">487</span>M  <span class="hljs-number">7.7</span>M  <span class="hljs-number">479</span>M   <span class="hljs-number">2</span>% /run<br>tmpfs                    <span class="hljs-number">487</span>M     <span class="hljs-number">0</span>  <span class="hljs-number">487</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/sys/</span>fs/cgroup<br><span class="hljs-regexp">/dev/m</span>apper<span class="hljs-regexp">/centos-root   17G  1.3G   16G   8% /</span><br><span class="hljs-regexp">/dev/</span>sda1               <span class="hljs-number">1014</span>M  <span class="hljs-number">138</span>M  <span class="hljs-number">877</span>M  <span class="hljs-number">14</span>% /boot<br>tmpfs                     <span class="hljs-number">98</span>M     <span class="hljs-number">0</span>   <span class="hljs-number">98</span>M   <span class="hljs-number">0</span>% <span class="hljs-regexp">/run/u</span>ser/<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>基础</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第二周作业-2022-6-13</title>
    <link href="/2022/06/18/%E7%AC%AC%E4%BA%8C%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-13/"/>
    <url>/2022/06/18/%E7%AC%AC%E4%BA%8C%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-6-13/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>：报全程班和单就业的小伙伴，本周建议学习内容：第七、八、九、十天 。</p><span id="more"></span><p>请同学们完成作业后，将博客作业提交到此链接：<a href="https://www.wjx.top/vj/POHTQOH.aspx">https://www.wjx.top/vj/POHTQOH.aspx</a></p><h1 id="章节内容"><a href="#章节内容" class="headerlink" title="章节内容"></a>章节内容</h1><p>第七天：</p><p>用户组合权限管理</p><p>1、用户和组配置文件及管理命令</p><p>2、文件权限管理</p><p>3、默认权限和特殊权限</p><p>4、文件特殊属性和FACL</p><p>5、文本编辑之神vim</p><p>6、文本编辑之神vim</p><p>7、文件处理工具</p><p>“第八天：</p><p>文本处理工具和正则表达式</p><p>1、基本正则表达式</p><p>2、基本正则表达式和扩展正则表达式</p><p>3、文本处理三剑客之grep</p><p>4、shell脚本编程基础知识</p><p>5、shell脚本编程基础</p><p>6、shell脚本编程关于变量</p><p>7、shell脚本编程特殊变量和脚本安全</p><p>8、shell脚本编程算数运算”</p><p>“第九天：</p><p>文本处理和shell编程基础</p><p>1、shell脚本编程逻辑运算和条件测试</p><p>2、shell脚本编程条件判断和条件组合</p><p>3、shell脚本编程条件判断if和case</p><p>4、shell脚本编程for循环</p><p>5、文件查找locate和find</p><p>6、文件打包和压缩</p><p>6、文件打包和压缩”    </p><p>“第十天：</p><p>文本处理sed&amp;软件管理</p><p>1、文本处理三剑客之sed的高级用法</p><p>2、软件运行和编译过程及库调用机制</p><p>3、rpm包管理器常用用法</p><p>4、yum实现和配置文件</p><p>5、yum的私有仓库和内核升级</p><p>6、源码编译安装软件</p><p>7、源码编译安装软件实战”    “完成一个shell脚本，脚本的作用。 </p><h1 id="作业："><a href="#作业：" class="headerlink" title="作业："></a>作业：</h1><ol><li>运行脚本可以显示出本机的ip地址</li><li>如果ip地址中有3这个数字，那么就打印出当前的系统时间</li><li>如果ip地址中不含3这个数字，就批量建立用户magedu_00, magedu_01, … magedu_100并且所有用户同属于magedu组</li><li>打印出/etc/passwd这个文件中可以登陆的用户（非/usr/sbin/nologin）</li><li>yum安装nginx服务，并且启动该服务</li><li>一个脚本完成”</li></ol><p>========================================</p><h2 id="1、运行脚本可以显示出本机的ip地址"><a href="#1、运行脚本可以显示出本机的ip地址" class="headerlink" title="1、运行脚本可以显示出本机的ip地址"></a>1、运行脚本可以显示出本机的ip地址</h2><figure class="highlight d"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><pre><code class="hljs d">方法一、<br>[root<span class="hljs-keyword">@node1</span> zuoye]# cat get_ip-<span class="hljs-number">1.</span>sh <br><span class="hljs-meta">#!/bin/bash</span><br>echo This host ip <span class="hljs-keyword">is</span> <span class="hljs-string">&quot;`hostname -I`&quot;</span><br>[root<span class="hljs-keyword">@node1</span> zuoye]# bash get_ip-<span class="hljs-number">1.</span>sh <br>This host ip <span class="hljs-keyword">is</span> <span class="hljs-number">10.0</span><span class="hljs-number">.21</span><span class="hljs-number">.101</span> <span class="hljs-number">10.0</span><span class="hljs-number">.21</span><span class="hljs-number">.5</span> <br><br>方法二、<br>[root<span class="hljs-keyword">@node1</span> zuoye]# cat get_ip-<span class="hljs-number">2.</span>sh <br><span class="hljs-meta">#!/bin/bash</span><br>echo This host ip <span class="hljs-keyword">is</span> <span class="hljs-string">&quot;`ifconfig|grep netmask|tr -s &quot;</span> <span class="hljs-string">&quot;|cut -d &quot;</span> <span class="hljs-string">&quot; -f3|grep -v 127`&quot;</span><br>[root<span class="hljs-keyword">@node1</span> zuoye]# bash get_ip-<span class="hljs-number">2.</span>sh <br>This host ip <span class="hljs-keyword">is</span> <span class="hljs-number">10.0</span><span class="hljs-number">.21</span><span class="hljs-number">.101</span><br><span class="hljs-number">10.0</span><span class="hljs-number">.21</span><span class="hljs-number">.5</span><br></code></pre></td></tr></table></figure><h2 id="2、如果ip地址中有3这个数字，那么就"><a href="#2、如果ip地址中有3这个数字，那么就" class="headerlink" title="2、如果ip地址中有3这个数字，那么就"></a>2、如果ip地址中有3这个数字，那么就</h2><p>打印出当前的系统时间</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs perl">方法一、条件测试 短路与<br>[root@node1 zuoye]<span class="hljs-comment"># cat zuoye2.sh </span><br><span class="hljs-comment">#!/bin/bash</span><br>hostname -I |<span class="hljs-keyword">grep</span> <span class="hljs-number">2</span> &gt; <span class="hljs-regexp">/dev/null</span>o;[ <span class="hljs-string">`echo $?`</span> -eq <span class="hljs-number">0</span> ] &amp;&amp; echo <span class="hljs-string">&quot;This host ip has num 2&quot;</span>. &amp;&amp; echo The current <span class="hljs-keyword">time</span> is: <span class="hljs-string">`date`</span>.<br>[root@node1 zuoye]<span class="hljs-comment"># bash zuoye2.sh </span><br>This host ip has num <span class="hljs-number">2</span>.<br>The current <span class="hljs-keyword">time</span> is: Mon Jun <span class="hljs-number">13</span> <span class="hljs-number">20</span>:<span class="hljs-number">31</span>:<span class="hljs-number">49</span> CST <span class="hljs-number">2022</span>.<br>[root@node1 zuoye]<span class="hljs-comment"># vim zuoye2.sh </span><br>[root@node1 zuoye]<span class="hljs-comment"># cat zuoye2.sh </span><br><span class="hljs-comment">#!/bin/bash</span><br>hostname -I |<span class="hljs-keyword">grep</span> <span class="hljs-number">3</span> &gt; <span class="hljs-regexp">/dev/null</span>o;[ <span class="hljs-string">`echo $?`</span> -eq <span class="hljs-number">0</span> ] &amp;&amp; echo <span class="hljs-string">&quot;This host ip has num 3&quot;</span>. &amp;&amp; echo The current <span class="hljs-keyword">time</span> is: <span class="hljs-string">`date`</span>.<br>[root@node1 zuoye]<span class="hljs-comment"># bash zuoye2.sh </span><br>[root@node1 zuoye]<span class="hljs-comment"># hostname -I</span><br><span class="hljs-number">10.0</span>.<span class="hljs-number">21.101</span> <span class="hljs-number">10.0</span>.<span class="hljs-number">21.5</span> <br>方法二、 <span class="hljs-keyword">if</span> <span class="hljs-keyword">else</span> 条件判断<br>[root@node1 zuoye]<span class="hljs-comment"># cat zuoye22.sh </span><br><span class="hljs-comment">#!/bin/bash</span><br>hostname -I |<span class="hljs-keyword">grep</span> <span class="hljs-number">3</span> &gt; <span class="hljs-regexp">/dev/null</span>;<br><span class="hljs-keyword">if</span> [ <span class="hljs-string">`echo $?`</span> -eq <span class="hljs-number">0</span> ]; then <br>echo <span class="hljs-string">&quot;This host ip has num 3&quot;</span>. ;<br>echo The current <span class="hljs-keyword">time</span> is: <span class="hljs-string">`date`</span>.<br><span class="hljs-keyword">else</span> echo <span class="hljs-string">&quot;This host ip does&#x27;t  have num 3&quot;</span>.<br>fi<br>[root@node1 zuoye]<span class="hljs-comment"># bash zuoye22.sh </span><br>This host ip does<span class="hljs-string">&#x27;t  have num 3.</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h2 id="3、如果ip地址中不含3这个数字，就"><a href="#3、如果ip地址中不含3这个数字，就" class="headerlink" title="3、如果ip地址中不含3这个数字，就"></a>3、如果ip地址中不含3这个数字，就</h2><p>批量建立用户magedu_00, magedu_01, … magedu_100并且所有用户同属于magedu组</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br></pre></td><td class="code"><pre><code class="hljs routeros">[root@node1 zuoye]# cat zuoye3.sh <br><span class="hljs-comment">#!/bin/bash</span><br>hostname -I |grep 3 &gt; /dev/<span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> [ `echo $?` -eq 0 ]; then <br>echo <span class="hljs-string">&quot;This host ip has num 3&quot;</span>. ;<br>echo The current time is: `date`.<br><span class="hljs-keyword">else</span> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;00<span class="hljs-built_in">..</span>100&#125; ;<span class="hljs-keyword">do</span><br>useradd -r magedu_<span class="hljs-variable">$i</span> &amp;&amp; usermod -g magedu magedu_<span class="hljs-variable">$i</span>;echo magedu_<span class="hljs-variable">$i</span> is created<br>done<br>fi<br>[root@node1 zuoye]# <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;00<span class="hljs-built_in">..</span>100&#125; ;<span class="hljs-keyword">do</span> userdel -r magedu_<span class="hljs-variable">$i</span>;done<br><br>扩展：如果ip地址中不含3这个数字，就批量创建用户和并设置随机密码<br>[root@node1 zuoye]# cat zuoye3.sh <br><span class="hljs-comment">#!/bin/bash</span><br>hostname -I |grep 3 &gt; /dev/<span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> [ `echo $?` -eq 0 ]; then <br>echo <span class="hljs-string">&quot;This host ip has num 3&quot;</span>. ;<br>echo The current time is: `date`.<br><span class="hljs-keyword">else</span> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;00<span class="hljs-built_in">..</span>100&#125; ;<span class="hljs-keyword">do</span><br>useradd -r magedu_<span class="hljs-variable">$i</span> &amp;&amp; usermod -g magedu magedu_<span class="hljs-variable">$i</span> &amp;&amp; echo magedu_<span class="hljs-variable">$i</span> is created;<br><span class="hljs-attribute">PASS</span>=`cat /dev/urandom | tr -dc <span class="hljs-string">&#x27;[:alnum:]&#x27;</span> |head -c12`<br>echo <span class="hljs-variable">$PASS</span> | passwd --stdin magedu_<span class="hljs-variable">$i</span> &amp;&gt; /dev/<span class="hljs-literal">null</span><br>echo magedu_<span class="hljs-variable">$i</span>:<span class="hljs-variable">$PASS</span> &gt;&gt; ./user.log<br>done<br>fi<br>[root@node1 zuoye]# bash zuoye3.sh <br>magedu_000 is created<br>magedu_001 is created<br>magedu_002 is created<br>magedu_003 is created<br>magedu_004 is created<br>magedu_005 is created<br>magedu_006 is created<br>magedu_007 is created<br>magedu_008 is created<br>magedu_009 is created<br>magedu_010 is created<br>magedu_011 is created<br>magedu_012 is created<br>magedu_013 is created<br>magedu_014 is created<br>magedu_015 is created<br>magedu_016 is created<br>magedu_017 is created<br>magedu_018 is created<br>magedu_019 is created<br>magedu_020 is created<br>magedu_021 is created<br>magedu_022 is created<br>magedu_023 is created<br>magedu_024 is created<br>magedu_025 is created<br>magedu_026 is created<br>magedu_027 is created<br>magedu_028 is created<br>magedu_029 is created<br>magedu_030 is created<br>magedu_031 is created<br>magedu_032 is created<br>magedu_033 is created<br>magedu_034 is created<br>magedu_035 is created<br>magedu_036 is created<br>magedu_037 is created<br>magedu_038 is created<br>magedu_039 is created<br>magedu_040 is created<br>magedu_041 is created<br>magedu_042 is created<br>magedu_043 is created<br>magedu_044 is created<br>magedu_045 is created<br>magedu_046 is created<br>magedu_047 is created<br>magedu_048 is created<br>magedu_049 is created<br>magedu_050 is created<br>magedu_051 is created<br>magedu_052 is created<br>magedu_053 is created<br>magedu_054 is created<br>magedu_055 is created<br>magedu_056 is created<br>magedu_057 is created<br>magedu_058 is created<br>magedu_059 is created<br>magedu_060 is created<br>magedu_061 is created<br>magedu_062 is created<br>magedu_063 is created<br>magedu_064 is created<br>magedu_065 is created<br>magedu_066 is created<br>magedu_067 is created<br>magedu_068 is created<br>magedu_069 is created<br>magedu_070 is created<br>magedu_071 is created<br>magedu_072 is created<br>magedu_073 is created<br>magedu_074 is created<br>magedu_075 is created<br>magedu_076 is created<br>magedu_077 is created<br>magedu_078 is created<br>magedu_079 is created<br>magedu_080 is created<br>magedu_081 is created<br>magedu_082 is created<br>magedu_083 is created<br>magedu_084 is created<br>magedu_085 is created<br>magedu_086 is created<br>magedu_087 is created<br>magedu_088 is created<br>magedu_089 is created<br>magedu_090 is created<br>magedu_091 is created<br>magedu_092 is created<br>magedu_093 is created<br>magedu_094 is created<br>magedu_095 is created<br>magedu_096 is created<br>magedu_097 is created<br>magedu_098 is created<br>magedu_099 is created<br>magedu_100 is created<br><br>[root@node1 zuoye]# cat user.log <br>magedu_000:ngoXZcZtFM28<br>magedu_001:L0JyTPd0bfQM<br>magedu_002:XNfFY36gjYTr<br>magedu_003:vhAhBzDj2oUc<br>magedu_004:TZbScFvMVeiO<br>magedu_005:2TVas8htZXYX<br>magedu_006:EwvIRjNi5Oiv<br>magedu_007:G7AKhtcKWZ8A<br>magedu_008:8DKJdgxk7F4I<br>magedu_009:eHrpn5lE1Wdu<br>magedu_010:QYIs3awovdH0<br>magedu_011:6NBULpqbOtfh<br>magedu_012:fmp6HJH9PbqD<br>magedu_013:wvMKTtLpB5pK<br>magedu_014:AQ80kKi0PQhO<br>magedu_015:YZZtBVPSmYvB<br>magedu_016:gMDOGsaGZ5Hi<br>magedu_017:HtRtRVDMq8zk<br>magedu_018:Rk5KZYfsezYF<br>magedu_019:ENISdlgAJ8Bx<br>magedu_020:UrxbiWXnTHNV<br>magedu_021:b5sYerc257Tz<br>magedu_022:6fTUvHQkreAd<br>magedu_023:IdLcPl0pa289<br>magedu_024:yanXbkz42bhD<br>magedu_025:r9XV4tUg2rK9<br>magedu_026:CaAdmM867Yav<br>magedu_027:VlZfx9VeKrxI<br>magedu_028:7PmFPJ5lvV1S<br>magedu_029:XBNqvpvtrTIJ<br>magedu_030:mmV3EOrJ9nZo<br>magedu_031:N3kfijfz2VYF<br>magedu_032:mCpF5yJQDscj<br>magedu_033:IsMMOIMsQbQk<br>magedu_034:nZlWpj66OW6j<br>magedu_035:e2unqmriketl<br>magedu_036:K3cvboMp7Apc<br>magedu_037:awhlL9WKGuYA<br>magedu_038:4kHsl6g9I8Nf<br>magedu_039:EVFRrQjcB2rh<br>magedu_040:lsEWha9CUmrP<br>magedu_041:Tani9CJPikcq<br>magedu_042:JQVgY82heJES<br>magedu_043:daKcPxEupObm<br>magedu_044:RcB6zH6gHUIk<br>magedu_045:u39G3zx4e4iw<br>magedu_046:VyJEdTWlOuUY<br>magedu_047:j1PvyfvSDwiT<br>magedu_048:xLr772I0pF8k<br>magedu_049:Unw1y7h3czFS<br>magedu_050:v7iBonS9lTA1<br>magedu_051:LNVBMSuKyCXN<br>magedu_052:xbLJvdhOhpmI<br>magedu_053:9uXkizxnZMqY<br>magedu_054:Rik4PPFDV4bE<br>magedu_055:Ub4Wf287dhtD<br>magedu_056:uaxfCGWfZaIB<br>magedu_057:SA9WwUU3eid2<br>magedu_058:qCRMjehD8Wxd<br>magedu_059:EISWlqfMhVos<br>magedu_060:FAGgWhq030RX<br>magedu_061:IKVJtIbbtM1v<br>magedu_062:le3LyfgFTeUH<br>magedu_063:JoPMXG2sC3Yx<br>magedu_064:zq6OQmgbKu1Q<br>magedu_065:Tg5jSP8aSwws<br>magedu_066:IMcqRPLX6gbU<br>magedu_067:owodd8Hlfn9y<br>magedu_068:AyqeltE734bB<br>magedu_069:YKYzVVhLi1Kn<br>magedu_070:Zb7ucYqjH05C<br>magedu_071:Iq2Xv9ZbOr17<br>magedu_072:EPms8IJKckuF<br>magedu_073:uYPxGXkTsWR9<br>magedu_074:mrGNx1FmPyF5<br>magedu_075:LpskRDatHcED<br>magedu_076:GBQErsPTs2Eh<br>magedu_077:PlT8baBRl34y<br>magedu_078:AdvF4QYUc1Rn<br>magedu_079:cIBMz0GdhUiF<br>magedu_080:0uGSu56s9wp7<br>magedu_081:p0GWgd3JdbCn<br>magedu_082:Vc9Op4LsxxkK<br>magedu_083:PEgtUsIyJMNu<br>magedu_084:7yXQdtx1kSeE<br>magedu_085:2am6D3Z3CP7V<br>magedu_086:0todSNhZucUQ<br>magedu_087:L0OUakK8sdzv<br>magedu_088:cMVeSWXBmfh1<br>magedu_089:wTObAQ9X77gt<br>magedu_090:H11hKKvvHJPW<br>magedu_091:7yL3MxwqnD13<br>magedu_092:8opQ0FxBl5qc<br>magedu_093:nm5ZL6qXNL1L<br>magedu_094:25M7LWguHDbi<br>magedu_095:CftnnQIWVwa4<br>magedu_096:3VD7SWp3KnHZ<br>magedu_097:kLBoYEQjkKjQ<br>magedu_098:Rk934H6CLnjG<br>magedu_099:oQkVH3hRANOe<br>magedu_100:KjmazVhViy0q<br>magedu_000:xOwcmfX4iSnw<br>magedu_001:6TUzdeZg0Vf8<br>magedu_002:OE0inG4llrtD<br>magedu_003:aqWyAcbz0AiE<br>magedu_004:ETyyNRYTlnnd<br>magedu_005:jm6OetYLI6FT<br>magedu_006:oWtl0aQNgYbm<br>magedu_007:FcIM7IuMl4uN<br>magedu_008:rH2r6Sqvha6X<br>magedu_009:NttNWNGIraWQ<br>magedu_010:v1faq54KoRD1<br>magedu_011:qr4VtFEmKVHH<br>magedu_012:OCpo47tk8LlR<br>magedu_013:BX5D5YLi9Obu<br>magedu_014:KuRuPCX9G6Mu<br>magedu_015:A630LpGLaQfD<br>magedu_016:7RLykk4RnHXC<br>magedu_017:yHLbbf4uKM8w<br>magedu_018:GUokYv2luIt5<br>magedu_019:fYqGonBESWLo<br>magedu_020:P1agEpkHpLyV<br>magedu_021:zUk95yPNkZ3F<br>magedu_022:5qM5rxiYO5eV<br>magedu_023:gCSNLRau9v4G<br>magedu_024:5MYicxFQLsAs<br>magedu_025:Q7s1t1iuCTSr<br>magedu_026:RQn91tdk9d3E<br>magedu_027:7Mos0fNgAZHo<br>magedu_028:FzEPAQjaH8Lu<br>magedu_029:xenrpOcBgVP3<br>magedu_030:7AwpsFURwk6t<br>magedu_031:vnPhBTV6SRBN<br>magedu_032:9xLN9ZlNFvgZ<br>magedu_033:JGgJAJQzUcEd<br>magedu_034:PaiB1T8Q0z9q<br>magedu_035:qhDolfnKMMUE<br>magedu_036:eQh9mCVg1lFk<br>magedu_037:cbmdYgA3EiqB<br>magedu_038:DXkbdfDrIa91<br>magedu_039:2xPYDZ5T3nv2<br>magedu_040:OibXPx10GPpa<br>magedu_041:ydIKM0173dLq<br>magedu_042:bN7Nft38KjnH<br>magedu_043:oLkqoi5213g8<br>magedu_044:B3UqO2R95juP<br>magedu_045:8uk3H2VsYfVV<br>magedu_046:3kD5ITJmorga<br>magedu_047:MIgEajdqXiQN<br>magedu_048:RJ7EhXeYpWuO<br>magedu_049:Ud9INMFqLI5q<br>magedu_050:wrTXRf93YKfM<br>magedu_051:KDSiRBVpuH29<br>magedu_052:ItSxHs8JXgtv<br>magedu_053:g0LvTFk6lnSM<br>magedu_054:jwvsjoJqBkp1<br>magedu_055:RBAfBbFVkJ6f<br>magedu_056:uWcCNDj7G2QC<br>magedu_057:n8o6nc8ZUvUf<br>magedu_058:yATVaYn87mrF<br>magedu_059:FYHj6l8eu9Ni<br>magedu_060:SXG7DdXijiF3<br>magedu_061:gDq0bNm5tblU<br>magedu_062:glEHGcTKfewO<br>magedu_063:RNZaLQG15s1l<br>magedu_064:OSZZSoyhPDfS<br>magedu_065:5le8x4op8685<br>magedu_066:KWZLwDsXPj96<br>magedu_067:439vJYOXwyyy<br>magedu_068:NtA0qJSDthbV<br>magedu_069:vsslNPmkNq0E<br>magedu_070:7d2JTtvGcBhp<br>magedu_071:xmC2xMC6rKXS<br>magedu_072:SGeJ1uBBw4e3<br>magedu_073:XOxjIOcW4cz5<br>magedu_074:m9uNeYREPXVD<br>magedu_075:k4rlQn3Y4gK0<br>magedu_076:5nrKBgB3vrCa<br>magedu_077:7dqd2g0Id9UP<br>magedu_078:076d1mSBohXu<br>magedu_079:zr2scFxUCjox<br>magedu_080:1u9O9E25poYq<br>magedu_081:zUfruaS6lpbA<br>magedu_082:QwuytWsJNQF2<br>magedu_083:jtM6NpY1HXEQ<br>magedu_084:nWJR8rChNcce<br>magedu_085:8WXneDRlHFtq<br>magedu_086:jjdsEovkCSFS<br>magedu_087:A6mNhLUl7NAT<br>magedu_088:uo7JmWN8xe5E<br>magedu_089:VbVPcBiHrRhd<br>magedu_090:oSKQdfkDBaeb<br>magedu_091:sCRgxjztoBdD<br>magedu_092:ypiUHadyoMbw<br>magedu_093:eG3E79b2Er0k<br>magedu_094:n7Zugt3Q88Fd<br>magedu_095:831Y8M8WUdTk<br>magedu_096:dojC5AAc92fp<br>magedu_097:dA3kYyLphxtj<br>magedu_098:tpkUQBevzbMF<br>magedu_099:VBTnydNaekZP<br>magedu_100:qBWoUA8a6YgF<br><br>[root@node1 ~]# <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;00<span class="hljs-built_in">..</span>100&#125;;<span class="hljs-keyword">do</span> id magedu_<span class="hljs-variable">$i</span>;done<br><span class="hljs-attribute">uid</span>=998(magedu_000) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=997(magedu_001) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=996(magedu_002) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=995(magedu_003) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=994(magedu_004) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=993(magedu_005) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=992(magedu_006) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=991(magedu_007) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=990(magedu_008) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=989(magedu_009) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=988(magedu_010) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=987(magedu_011) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=986(magedu_012) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=985(magedu_013) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=984(magedu_014) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=983(magedu_015) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=982(magedu_016) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=981(magedu_017) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=980(magedu_018) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=979(magedu_019) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=978(magedu_020) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=977(magedu_021) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=976(magedu_022) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=975(magedu_023) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=974(magedu_024) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=973(magedu_025) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=972(magedu_026) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=971(magedu_027) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=970(magedu_028) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=969(magedu_029) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=968(magedu_030) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=967(magedu_031) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=966(magedu_032) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=965(magedu_033) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=964(magedu_034) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=963(magedu_035) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=962(magedu_036) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=961(magedu_037) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=960(magedu_038) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=959(magedu_039) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=958(magedu_040) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=957(magedu_041) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=956(magedu_042) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=955(magedu_043) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=954(magedu_044) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=953(magedu_045) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=952(magedu_046) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=951(magedu_047) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=950(magedu_048) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=949(magedu_049) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=948(magedu_050) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=947(magedu_051) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=946(magedu_052) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=945(magedu_053) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=944(magedu_054) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=943(magedu_055) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=942(magedu_056) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=941(magedu_057) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=940(magedu_058) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=939(magedu_059) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=938(magedu_060) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=937(magedu_061) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=936(magedu_062) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=935(magedu_063) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=934(magedu_064) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=933(magedu_065) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=932(magedu_066) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=931(magedu_067) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=930(magedu_068) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=929(magedu_069) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=928(magedu_070) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=927(magedu_071) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=926(magedu_072) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=925(magedu_073) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=924(magedu_074) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=923(magedu_075) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=922(magedu_076) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=921(magedu_077) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=920(magedu_078) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=919(magedu_079) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=918(magedu_080) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=917(magedu_081) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=916(magedu_082) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=915(magedu_083) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=914(magedu_084) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=913(magedu_085) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=912(magedu_086) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=911(magedu_087) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=910(magedu_088) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=909(magedu_089) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=908(magedu_090) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=907(magedu_091) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=906(magedu_092) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=905(magedu_093) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=904(magedu_094) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=903(magedu_095) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=902(magedu_096) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=901(magedu_097) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=900(magedu_098) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=899(magedu_099) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br><span class="hljs-attribute">uid</span>=898(magedu_100) <span class="hljs-attribute">gid</span>=1002(magedu) <span class="hljs-attribute">groups</span>=1002(magedu)<br></code></pre></td></tr></table></figure><h2 id="4、打印出-etc-passwd这个文件中可以登陆的用户（非-usr-sbin-nologin）"><a href="#4、打印出-etc-passwd这个文件中可以登陆的用户（非-usr-sbin-nologin）" class="headerlink" title="4、打印出/etc/passwd这个文件中可以登陆的用户（非/usr/sbin/nologin）"></a>4、打印出/etc/passwd这个文件中可以登陆的用户（非/usr/sbin/nologin）</h2><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@node1</span> zuoye]<span class="hljs-meta"># user_list=`cat /etc/passwd|grep -v nologin|cut -d <span class="hljs-string">&quot;:&quot;</span> -f1`</span><br>[root<span class="hljs-symbol">@node1</span> zuoye]<span class="hljs-meta"># echo <span class="hljs-string">&quot;可以登录的用户：$user_list&quot;</span>|xargs</span><br>可以登录的用户：root sync <span class="hljs-built_in">shutdown</span> halt user01 user02 magedu_000 magedu_001 magedu_002 magedu_003 magedu_004 magedu_005 magedu_006 magedu_007 magedu_008 magedu_009 magedu_010 magedu_011 magedu_012 magedu_013 magedu_014 magedu_015 magedu_016 magedu_017 magedu_018 magedu_019 magedu_020 magedu_021 magedu_022 magedu_023 magedu_024 magedu_025 magedu_026 magedu_027 magedu_028 magedu_029 magedu_030 magedu_031 magedu_032 magedu_033 magedu_034 magedu_035 magedu_036 magedu_037 magedu_038 magedu_039 magedu_040 magedu_041 magedu_042 magedu_043 magedu_044 magedu_045 magedu_046 magedu_047 magedu_048 magedu_049 magedu_050 magedu_051 magedu_052 magedu_053 magedu_054 magedu_055 magedu_056 magedu_057 magedu_058 magedu_059 magedu_060 magedu_061 magedu_062 magedu_063 magedu_064 magedu_065 magedu_066 magedu_067 magedu_068 magedu_069 magedu_070 magedu_071 magedu_072 magedu_073 magedu_074 magedu_075 magedu_076 magedu_077 magedu_078 magedu_079 magedu_080 magedu_081 magedu_082 magedu_083 magedu_084 magedu_085 magedu_086 magedu_087 magedu_088 magedu_089 magedu_090 magedu_091 magedu_092 magedu_093 magedu_094 magedu_095 magedu_096 magedu_097 magedu_098 magedu_099 magedu_100<br></code></pre></td></tr></table></figure><h2 id="5、yum安装nginx服务，并且启动该服务"><a href="#5、yum安装nginx服务，并且启动该服务" class="headerlink" title="5、yum安装nginx服务，并且启动该服务"></a>5、yum安装nginx服务，并且启动该服务</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@centos7 yum.repos.d]<span class="hljs-comment">#cat nginx.repo </span><br>[nginx-stable]<br>name=nginx stable repo<br>baseurl=http:<span class="hljs-regexp">//</span>nginx.org<span class="hljs-regexp">/packages/</span>centos<span class="hljs-regexp">/$releasever/</span><span class="hljs-variable">$basearch</span>/<br>gpgcheck=<span class="hljs-number">1</span><br>enabled=<span class="hljs-number">1</span><br>gpgkey=https:<span class="hljs-regexp">//</span>nginx.org<span class="hljs-regexp">/keys/</span>nginx_signing.key<br>module_hotfixes=true<br><br>[nginx-ainline]<br>name=nginx mainline repo<br>baseurl=http:<span class="hljs-regexp">//</span>nginx.org<span class="hljs-regexp">/packages/m</span>ainline<span class="hljs-regexp">/centos/</span><span class="hljs-variable">$releasever</span><span class="hljs-regexp">/$basearch/</span><br>gpgcheck=<span class="hljs-number">1</span><br>enabled=<span class="hljs-number">1</span><br>gpgkey=https:<span class="hljs-regexp">//</span>nginx.org<span class="hljs-regexp">/keys/</span>nginx_siging.key<br>module_hotfixes=true<br><br>[root@centos7 yum.repos.d]<span class="hljs-comment">#yum list nginx</span><br>Loaded plugins: fastestmirror<br>Loading mirror speeds from cached hostfile<br> * base: mirrors.aliyun.com<br> * extras: mirrors.aliyun.com<br> * updates: mirrors.aliyun.com<br>nginx-ainline                                                                                                                                                | <span class="hljs-number">2.9</span> kB  <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>     <br>nginx-stable                                                                                                                                                 | <span class="hljs-number">2.9</span> kB  <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>     <br>(<span class="hljs-number">1</span><span class="hljs-regexp">/2): nginx-stable/</span><span class="hljs-number">7</span><span class="hljs-regexp">/x86_64/</span>primary_db                                                                                                                      |  <span class="hljs-number">75</span> kB  <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01</span>     <br>(<span class="hljs-number">2</span><span class="hljs-regexp">/2): nginx-ainline/</span><span class="hljs-number">7</span><span class="hljs-regexp">/x86_64/</span>primary_db                                                                                                                     | <span class="hljs-number">235</span> kB  <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">02</span>     <br>Installed Packages<br>nginx.x86_64                                                                     <span class="hljs-number">1</span>:<span class="hljs-number">1.20</span>.<span class="hljs-number">1</span>-<span class="hljs-number">9</span>.el7                                                                         @epel       <br>Available Packages<br>nginx.x86_64      <br><br>[root@centos7 yum.repos.d]<span class="hljs-comment">#yum install nginx</span><br>[root@centos7 yum.repos.d]<span class="hljs-comment">#rpm -q nginx</span><br>nginx-<span class="hljs-number">1.22</span>.<span class="hljs-number">0</span>-<span class="hljs-number">1</span>.el7.ngx.x86_64<br>[root@centos7 yum.repos.d]<span class="hljs-comment">#rpm -qi nginx</span><br>Name        : nginx<br>Epoch       : <span class="hljs-number">1</span><br>Version     : <span class="hljs-number">1.22</span>.<span class="hljs-number">0</span><br>Release     : <span class="hljs-number">1</span>.el7.ngx<br>Architecture: x86_64<br>Install Date: Tue <span class="hljs-number">14</span> Jun <span class="hljs-number">2022</span> <span class="hljs-number">09</span>:<span class="hljs-number">57</span>:<span class="hljs-number">59</span> PM CST<br>Group       : System Environment/Daemons<br>Size        : <span class="hljs-number">2913059</span><br>License     : <span class="hljs-number">2</span>-clause BSD-like license<br>Signature   : RSA/SHA256, Tue <span class="hljs-number">24</span> May <span class="hljs-number">2022</span> <span class="hljs-number">11</span>:<span class="hljs-number">52</span>:<span class="hljs-number">21</span> PM CST, Key ID abf5bd827bd9bf62<br>Source RPM  : nginx-<span class="hljs-number">1.22</span>.<span class="hljs-number">0</span>-<span class="hljs-number">1</span>.el7.ngx.src.rpm<br>Build Date  : Tue <span class="hljs-number">24</span> May <span class="hljs-number">2022</span> <span class="hljs-number">11</span>:<span class="hljs-number">35</span>:<span class="hljs-number">18</span> PM CST<br>Build Host  : ip-<span class="hljs-number">10</span>-<span class="hljs-number">1</span>-<span class="hljs-number">17</span>-<span class="hljs-number">70</span>.eu-central-<span class="hljs-number">1</span>.compute.internal<br>Relocations : (not relocatable)<br>Vendor      : NGINX Packaging &lt;nginx-packaging@f5.com&gt;<br>URL         : https:<span class="hljs-regexp">//</span>nginx.org/<br>Summary     : High performance web server<br>Description :<br>nginx [engine x] is an HTTP and reverse proxy server, as well as<br>a mail proxy server.<br>[root@centos7 yum.repos.d]<span class="hljs-comment">#rpm -ql nginx</span><br><span class="hljs-regexp">/etc/</span>logrotate.d/nginx<br><span class="hljs-regexp">/etc/</span>nginx<br><span class="hljs-regexp">/etc/</span>nginx/conf.d<br><span class="hljs-regexp">/etc/</span>nginx<span class="hljs-regexp">/conf.d/</span>default.conf<br><span class="hljs-regexp">/etc/</span>nginx/fastcgi_params<br><span class="hljs-regexp">/etc/</span>nginx/mime.types<br><span class="hljs-regexp">/etc/</span>nginx/modules<br><span class="hljs-regexp">/etc/</span>nginx/nginx.conf<br><span class="hljs-regexp">/etc/</span>nginx/scgi_params<br><span class="hljs-regexp">/etc/</span>nginx/uwsgi_params<br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/systemd/</span>system/nginx-debug.service<br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/systemd/</span>system/nginx.service<br><span class="hljs-regexp">/usr/</span>lib64/nginx<br><span class="hljs-regexp">/usr/</span>lib64<span class="hljs-regexp">/nginx/m</span>odules<br><span class="hljs-regexp">/usr/</span>libexec<span class="hljs-regexp">/initscripts/</span>legacy-actions/nginx<br><span class="hljs-regexp">/usr/</span>libexec<span class="hljs-regexp">/initscripts/</span>legacy-actions<span class="hljs-regexp">/nginx/</span>check-reload<br><span class="hljs-regexp">/usr/</span>libexec<span class="hljs-regexp">/initscripts/</span>legacy-actions<span class="hljs-regexp">/nginx/u</span>pgrade<br><span class="hljs-regexp">/usr/</span>sbin/nginx<br><span class="hljs-regexp">/usr/</span>sbin/nginx-debug<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/doc/</span>nginx-<span class="hljs-number">1.22</span>.<span class="hljs-number">0</span><br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/doc/</span>nginx-<span class="hljs-number">1.22</span>.<span class="hljs-number">0</span>/COPYRIGHT<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/man/m</span>an8/nginx.<span class="hljs-number">8</span>.gz<br><span class="hljs-regexp">/usr/</span>share/nginx<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nginx/</span>html<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nginx/</span>html/<span class="hljs-number">50</span>x.html<br><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nginx/</span>html/index.html<br><span class="hljs-regexp">/var/</span>cache/nginx<br><span class="hljs-regexp">/var/</span>log/nginx<br><br>[root@centos7 yum.repos.d]<span class="hljs-comment">#systemctl start nginx</span><br>[root@centos7 yum.repos.d]<span class="hljs-comment">#systemctl status nginx</span><br>● nginx.service - nginx - high performance web server<br>   Loaded: loaded (<span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/systemd/</span>system/nginx.service; disabled; vendor preset: disabled)<br>   Active: active (running) since Tue <span class="hljs-number">2022</span>-<span class="hljs-number">06</span>-<span class="hljs-number">14</span> <span class="hljs-number">22</span>:<span class="hljs-number">13</span>:<span class="hljs-number">17</span> CST; <span class="hljs-number">2</span>s ago<br>     Docs: http:<span class="hljs-regexp">//</span>nginx.org<span class="hljs-regexp">/en/</span>docs/<br>  Process: <span class="hljs-number">40232</span> ExecStart=<span class="hljs-regexp">/usr/</span>sbin<span class="hljs-regexp">/nginx -c /</span>etc<span class="hljs-regexp">/nginx/</span>nginx.conf (code=exited, status=<span class="hljs-number">0</span>/SUCCESS)<br> Main PID: <span class="hljs-number">40233</span> (nginx)<br>    Tasks: <span class="hljs-number">3</span><br>   Memory: <span class="hljs-number">2.1</span>M<br>   CGroup: <span class="hljs-regexp">/system.slice/</span>nginx.service<br>           ├─<span class="hljs-number">40233</span> nginx: master process <span class="hljs-regexp">/usr/</span>sbin<span class="hljs-regexp">/nginx -c /</span>etc<span class="hljs-regexp">/nginx/</span>nginx.conf<br>           ├─<span class="hljs-number">40234</span> nginx: worker process<br>           └─<span class="hljs-number">40235</span> nginx: worker process<br><br>Jun <span class="hljs-number">14</span> <span class="hljs-number">22</span>:<span class="hljs-number">13</span>:<span class="hljs-number">17</span> centos7.magedu.com systemd[<span class="hljs-number">1</span>]: Starting nginx - high performance web server...<br>Jun <span class="hljs-number">14</span> <span class="hljs-number">22</span>:<span class="hljs-number">13</span>:<span class="hljs-number">17</span> centos7.magedu.com systemd[<span class="hljs-number">1</span>]: Started nginx - high performance web server.<br><br></code></pre></td></tr></table></figure><h2 id="6、一个脚本完成”"><a href="#6、一个脚本完成”" class="headerlink" title="6、一个脚本完成”"></a>6、一个脚本完成”</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node1 zuoye]<span class="hljs-comment"># cat zuoye44.sh </span><br><span class="hljs-comment">#!/bin/bash</span><br>hostname -I |grep 3 &gt; /dev/null;<br><span class="hljs-keyword">if</span> [ `<span class="hljs-built_in">echo</span> $?` -eq 0 ]; <span class="hljs-keyword">then</span> <br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This host ip has num 3&quot;</span>. ;<br><span class="hljs-built_in">echo</span> The current time is: `<span class="hljs-built_in">date</span>`.<br><span class="hljs-keyword">else</span> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;00..100&#125; ;<span class="hljs-keyword">do</span><br>useradd -r magedu_<span class="hljs-variable">$i</span> &amp;&amp; usermod -g magedu magedu_<span class="hljs-variable">$i</span> &amp;&amp; <span class="hljs-built_in">echo</span> magedu_<span class="hljs-variable">$i</span> is created;<br>PASS=`<span class="hljs-built_in">cat</span> /dev/urandom | <span class="hljs-built_in">tr</span> -dc <span class="hljs-string">&#x27;[:alnum:]&#x27;</span> |<span class="hljs-built_in">head</span> -c12`<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PASS</span> | passwd --stdin magedu_<span class="hljs-variable">$i</span> &amp;&gt; /dev/null<br><span class="hljs-built_in">echo</span> magedu_<span class="hljs-variable">$i</span>:<span class="hljs-variable">$PASS</span> &gt;&gt; ./user.log<br><span class="hljs-keyword">done</span><br><span class="hljs-keyword">fi</span><br>user_list=`<span class="hljs-built_in">cat</span> /etc/passwd|grep -v nologin|<span class="hljs-built_in">cut</span> -d <span class="hljs-string">&quot;:&quot;</span> -f1`<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;可以登录的用户：<span class="hljs-variable">$user_list</span>&quot;</span>|xargs<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>作业</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>第一周作业-2022-5-30</title>
    <link href="/2022/06/18/%E7%AC%AC%E4%B8%80%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-5-30/"/>
    <url>/2022/06/18/%E7%AC%AC%E4%B8%80%E5%91%A8%E4%BD%9C%E4%B8%9A-2022-5-30/</url>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>：报全程班和单就业的小伙伴，本周建议学习内容： 第四、五、六天。</p><p>请同学们完成作业后，将博客作业提交到此链接：<a href="https://www.wjx.top/vj/POHTQOH.aspx">https://www.wjx.top/vj/POHTQOH.aspx</a> </p><span id="more"></span><h1 id="章节内容"><a href="#章节内容" class="headerlink" title="章节内容"></a>章节内容</h1><p> 第四天：<br> 计算机基础和Linux安装<br> 1、计算机基础<br> 2、服务器硬件组成<br> 3、操作系统相关技术和Unix历史<br> 4、Linux各种版本的安装<br> 第五天：<br> 计算机基础和帮助<br> 1、Linux远程连接和基本操作<br> 2、Linux的终端和运行命令<br> 3、Linux命令格式<br> 4、Linux常用命令<br> 5、ASCII和Unicode编码及各种符号用法<br> 6、Linux查看帮助用法<br> 7、Linux的目录结构和文件类型<br> 第六天：<br> 文件管理和IO重定向<br> 1、文件路径和文件访问<br> 2、文件通配符<br> 3、文件管理命令<br> 4、文件的删除和节点表结构<br> 5、硬链接和软链接及重定向<br> 6、重定向和管道<br> 7、用户和组管理初步</p><h1 id="作业"><a href="#作业" class="headerlink" title="作业"></a>作业</h1><ol><li>图文并茂解释开源协定的区别？</li><li>安装centos ubuntu系统.</li><li>通过计算机基础和帮助的学习，完成学习ifconfig命令的使用。</li><li>总结linux FHS结构。</li></ol><p>===================================</p><h2 id="问题1、图文并茂解释开源协定的区别？"><a href="#问题1、图文并茂解释开源协定的区别？" class="headerlink" title="问题1、图文并茂解释开源协定的区别？"></a>问题1、图文并茂解释开源协定的区别？</h2><p>开源软件遵循的协定有这些： GPL、BSD、MIT、Mozilla、Apache和LGPL。就自己的理解，说出他们之间的区别和特性。</p><p>1）<strong>GPL</strong>： GNU General Public License </p><p>自由软件基金会：Free Software Foundation </p><p>允许用户任意复制、传递、修改及再发布 </p><p>基于自由软件修改再次发布的软件，仍需遵守GPL。</p><p>GPL协议和BSD, Apache Licence等鼓励代码重用的许可很不一样。GPL的出发点是代码的开源/免费使用和引用/修改/衍生代码的开源/免费使用，但不允许修改后和衍生的代码做为闭源的商业软件发布和销售。这也就是为什么我们能用免费的各种linux，包括商业公司的linux和linux上各种各样的由个人，组织，以及商业软件公司开发的免费软件了。</p><p>2）<strong>LGPL</strong>： Lesser General Public License，LGPL相对于GPL较为宽松，允许不公开全部源代码。</p><p>LGPL允许商业软件通过类库引用(link)方式使用LGPL类库而不需要开源商业软件的代码。这使得采用LGPL协议的开源代码可以被商业软件作为类库引用并发布和销售。</p><p>因此LGPL协议的开源代码很适合作为第三方类库被商业软件引用，但不适合希望以LGPL协议代码为基础，通过修改和衍生的方式做二次开发的商业软件采用。</p><p><strong>BSD</strong>  是”Berkeley Software Distribution”的缩写，意思是”伯克利软件发行版”。</p><p>是一个给于使用者很大自由的协议。可以自由的使用，修改源代码，也可以将修改后的代码作为开源或者专有软件再发布。 当你发布使用了BSD协议的代码，或则以BSD协议代码为基础做二次开发自己的产品时，需要满足三个条件：</p><ul><li>1． 如果再发布的产品中包含源代码，则在源代码中必须带有原来代码中的BSD协议。</li><li>2． 如果再发布的只是二进制类库/软件，则需要在类库/软件的文档和版权声明中包含原来代码中的BSD协议。</li><li>3． 不可以用开源代码的作者/机构名字和原来产品的名字做市场推广。</li></ul><p>BSD代码鼓励代码共享，但需要尊重代码作者的著作权。BSD由于允许使用者修改和重新发布代码，也允许使用或在BSD代码上开发商业软件发布和销售，因此是对商业集成很友好的协议。而很多的公司企业在选用开源产品的时候都首选BSD协议，因为可以完全控制这些第三方的代码，在必要的时候可以修改或者二次开发。</p><p>4）<strong>MIT</strong>  MIT源自麻省理工学院（Massachusetts Institute of Technology, MIT），又称X11协议。与BSD类似，但是比BSD协议更加宽松，是目前最少限制的协议。这个协议唯一的条件就是在修改后的代码或者发行包包含原作者的许可信息。适用商业软件。使用MIT的软件项目有：jquery、Node.js。</p><p>5）<strong>Mozilla</strong>  MPL (Mozilla Public License 1.1) MPL协议允许免费重发布、免费修改，但要求修改后的代码版权归软件的发起者。这种授权维护了商业软件的利益，它要求基于这种软件的修改无偿贡献版权给该软件。这样，围绕该软件的所有代码的版权都集中在发起开发人的手中。但MPL是允许修改，无偿使用得。MPL软件对链接没有要求。</p><p>6）<strong>Apache</strong> </p><p>Apache License（Apache许可证），是Apache软件基金会发布的一个自由软件许可证。</p><p>Apache Licence是著名的非盈利开源组织Apache采用的协议。该协议和BSD类似，同样鼓励代码共享和最终原作者的著作权，同样允许源代码修改和再发布。但是也需要遵循以下条件：</p><ul><li>需要给代码的用户一份Apache Licence。</li><li>如果修改了代码，需要在被修改的文件中说明。</li><li>在衍生的代码中（修改和有源代码衍生的代码中）需要带有原来代码中的协议，商标，专利声明和其他原来作者规定需要包含的说明。</li><li>如果在发布的产品中包含一个Notice文件，则在Notice文件中需要带有Apache Licence。你可以在Notice中增加自己的许可，但是不可以表现为对Apache Licence构成更改。</li><li>Apache Licence也是对商业应用友好的许可。使用者也可以在需要的时候修改代码来满足并作为开源或商业产品发布/销售。</li></ul><p>使用这个协议的好处是:</p><ul><li>永久权利 一旦被授权，永久拥有。</li><li>全球范围的权利 在一个国家获得授权，适用于所有国家。假如你在美国，许可是从印度授权的，也没有问题。</li><li>授权免费 无版税， 前期、后期均无任何费用。</li><li>授权无排他性 任何人都可以获得授权</li><li>授权不可撤消 一旦获得授权，没有任何人可以取消。比如，你基于该产品代码开发了衍生产品，你不用担心会在某一天被禁止使用该代码</li></ul><p><img src="https://img-blog.csdnimg.cn/7f706e5985a94f77ab492fbb545a5425.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/14a664ecd88e4f4a82b2aa2ca7667b4d.png" alt="img"></p><h2 id="问题2、安装centos-ubuntu系统"><a href="#问题2、安装centos-ubuntu系统" class="headerlink" title="问题2、安装centos ubuntu系统."></a>问题2、安装centos ubuntu系统.</h2><h2 id="问题3、通过计算机基础和帮助的学习，完成学习ifconfig命令的使用。"><a href="#问题3、通过计算机基础和帮助的学习，完成学习ifconfig命令的使用。" class="headerlink" title="问题3、通过计算机基础和帮助的学习，完成学习ifconfig命令的使用。"></a>问题3、通过计算机基础和帮助的学习，完成学习ifconfig命令的使用。</h2><p>最小化安装的centos系统，没有ifconfig命令，需要先安装net-tools-2.0-0.25.20131004git.el7.x86_64。</p><p>[root@node1 ~]# yum provides ifconfig<br> Loaded plugins: fastestmirror<br> Repository cr is listed more than once in the configuration<br> Repository fasttrack is listed more than once in the configuration<br> Loading mirror speeds from cached hostfile<br> extras/7/x86_64/filelists_db                                          | 277 kB  00:00:00<br> mysql-connectors-community/x86_64/filelists_db                        |  35 kB  00:00:00<br> mysql-tools-community/x86_64/filelists_db                             | 325 kB  00:00:00<br> mysql80-community/x86_64/filelists_db                                 | 1.9 MB  00:00:00<br> updates/7/x86_64/filelists_db                                         | 8.7 MB  00:00:01<br> <strong>net-tools-2.0-0.25.20131004git.el7.x86_64</strong> : Basic networking tools<br> Repo        : @base<br> Matched from:<br> Filename    : /usr/sbin/ifconfig</p><p>在linux中我们可以使用ifconfig命令查看网卡配置与网络状态等信息，好比我们在windows中查看网络配置信息ipconfig命令一样。</p><p><strong>ifconfig [interface]</strong></p><p>interface是可选项，不加此选项则显示系统中所有网卡的信息。如果添加此选项，则显示指定网卡的信息。</p><p>[root@node2 ~]#ifconfig<br> ens33: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>         inet 192.168.126.12  netmask 255.255.255.0  broadcast 192.168.126.255<br>         inet6 fe80::20c:29ff:fed7:a24c  prefixlen 64  scopeid 0x20<link><br>         ether 00:0c:29:d7:a2:4c  txqueuelen 1000  (Ethernet)<br>         RX packets 1183  bytes 100770 (98.4 KiB)<br>         RX errors 0  dropped 0  overruns 0  frame 0<br>         TX packets 197  bytes 22103 (21.5 KiB)<br>         TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</p><p>lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536<br>         inet 127.0.0.1  netmask 255.0.0.0<br>         inet6 ::1  prefixlen 128  scopeid 0x10<host><br>         loop  txqueuelen 1000  (Local Loopback)<br>         RX packets 0  bytes 0 (0.0 B)<br>         RX errors 0  dropped 0  overruns 0  frame 0<br>         TX packets 0  bytes 0 (0.0 B)<br>         TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</p><p>如上所示，使用ifconfig命令获取到的主要信息有：</p><p>1、主机被检测到的网卡有ens33，UP表示“接口已启用”，RUNNING表示“接口在工作中”，BROADCAST表示“主机支持广播”，MULTICAST表示“主机支持多播”，mtu 1500表示“最大传输单元 1500字节”</p><p><strong>inet 192.168.126.12  netmask 255.255.255.0  broadcast 192.168.126.255</strong></p><p>解释：inet ：网卡的IP地址；netmask ：网络掩码；broadcast ：广播地址。</p><p><strong>ether 00:0c:29:d7:a2:4c  txqueuelen 1000  (Ethernet)</strong></p><p>解释：连接类型：Ethernet (以太网)或者HWaddr (此网卡的硬件mac地址)；txqueuelen (网卡设置的传送队列长度)</p><p>RX packets 1183  bytes 100770 (98.4 KiB)<br> RX errors 0  dropped 0  overruns 0  frame 0</p><p>解释：接收时，正确的数据包数1183；接收的数据量(98.4 KiB）；</p><p> 接收时，产生错误的数据包数为0，丢弃的数据包数为0；overruns 表示接收时，由于速度过快而丢失的数据包数为0；RX frame 表示接收时，发生frame错误而丢失的数据包数为0。</p><p>ifconfig不仅可以查看网卡配置与网络状态，还可以进行网络配置，常见用法如下：</p><p><img src="https://img-blog.csdnimg.cn/2ebb79beb4024757933b1032519eb9fd.png" alt="img"></p><p>注意：用ifconfig命令配置的网卡信息，在网卡重启或者机器重启后，所做的配置就不存在了。如果需要网络配置永久生效，需要修改相应的配置文件。</p><p>使用find命令过滤即可找到对应的网卡配置文件：</p><p>[root@node2 ~]#find /etc/ -name <em>ens33</em><br> /etc/sysconfig/network-scripts/ifcfg-ens33</p><h2 id="问题4、总结linux-FHS结构。"><a href="#问题4、总结linux-FHS结构。" class="headerlink" title="问题4、总结linux FHS结构。"></a>问题4、总结linux FHS结构。</h2><p>linux的文件系统分层结构FileSystem Hierarchy Standdard(简称FHS)。</p><p>定义了在Linux系统中的目录结构和目录内容,即让用户了解到已安装软件通常放置哪个目录下。类似于Windows操作系统中C盘的文件目录,FHS采用树形结构组织文件,定义了系统中每个区域的用途、所需要的最小构成的文件和目录,同时还给出了例外处理和矛盾处理。</p><p>文件系统目录结构：</p><p><img src="https://img-blog.csdnimg.cn/6fb9a2608f1b4268bc757b034024d1c5.png" alt="img"></p><p>文件和目录被组织成一个单根倒置树结构 ；</p><p>文件系统从根目录下开始，用“/”表示；</p><p>常见文件系统的目录功能：</p><p>/boot：存放内核文件(vmlinuz)、引导加载器(bootloader, grub)等引导文件都存放于此目录 </p><p>/bin：所有用户使用的基本命令，OS启动即会用到的程序 </p><p>/sbin：管理类的基本命令，OS启动即会用到的程序 </p><p>/lib：启动时程序依赖的基本共享库文件，以及内核模块文件(/lib/modules) </p><p>/lib64：专用于x86_64系统上的辅助共享库文件存放位置 </p><p>/etc：配置文件目录 </p><p>/home/USERNAME：普通用户家目录 </p><p>/root：管理员的家目录 </p><p>/media：便携式移动设备挂载点 </p><p>/mnt：临时文件系统挂载点 </p><p>/dev：设备文件及特殊文件存储位置 </p><p>b: block device，随机访问 </p><p>c: character device，线性访问 </p><p>/opt：第三方应用程序的安装位置 </p><p>/tmp：临时文件存储位置</p>]]></content>
    
    
    <categories>
      
      <category>作业</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>搭建个人博客</title>
    <link href="/2022/06/18/%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    <url>/2022/06/18/%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="前言：完全免费"><a href="#前言：完全免费" class="headerlink" title="前言：完全免费"></a>前言：完全免费</h1><span id="more"></span><ol><li><p>通过<strong>淘宝账号</strong>登陆, <code>codeup.aliyun.com</code>,  免费。</p></li><li><p>登陆 <code>github.com</code> ，注册一个账号，免费。我这里账号是<code>slcnx</code></p></li><li><p>安装windows git,  <a href="https://gitforwindows.org/">https://gitforwindows.org/</a> 下载之后，直接安装。</p><p>需要先验证git, windows 打开 <code>CMD</code> , 输入 <code>git --version</code> <strong>看到</strong>版本号，说明git安装OK</p><p><img src="image-20220513093045210.png" alt="image-20220513093045210"></p></li><li><p>安装windows node,  <a href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a> 下载之后，直接安装</p><p>需要先验证node, windows 打开 <code>CMD</code> , 输入 <code>node --version</code> <strong>看到</strong>版本号，说明node安装OK</p><p><img src="image-20220513093341959.png" alt="image-20220513093341959"></p></li><li><p>安装vscode, <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a> 下载之后，直接安装</p></li><li><p>安装typora, <a href="https://typora.io/releases/all">https://typora.io/releases/all</a> 下载, 直接安装</p></li></ol><!--more--><h1 id="准备hexo基础模板"><a href="#准备hexo基础模板" class="headerlink" title="准备hexo基础模板"></a>准备hexo基础模板</h1><p>克隆git, 在CMD执行, 以下目录</p><figure class="highlight awk"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs awk">git clone --recurse-submodules https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/slcnx/</span>hexo-template.git blog<br></code></pre></td></tr></table></figure><blockquote><p>不成功多执行几次， 当看到100% 就表示成功了</p></blockquote><p><img src="image-20220513094643815.png" alt="image-20220513094643815"></p><p>现在进入克隆目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> blog<br></code></pre></td></tr></table></figure><p><img src="image-20220513093934096.png" alt="image-20220513093934096"></p><p>克隆子项目<code>git submodule update --init --recursive</code></p><p><img src="image-20220513094748529.png" alt="image-20220513094748529"></p><p>现在安装依赖<code> npm install</code></p><p><img src="image-20220513095055192.png" alt="image-20220513095055192"></p><p>现在在命令行输入 <code>start .</code></p><p><img src="image-20220513093954383.png" alt="image-20220513093954383"></p><p>看到以下界面</p><p><img src="image-20220513094013505.png" alt="image-20220513094013505"></p><h1 id="vscode打开目录-运行服务"><a href="#vscode打开目录-运行服务" class="headerlink" title="vscode打开目录, 运行服务"></a>vscode打开目录, 运行服务</h1><p>回到上一级目录，<code>blog</code>目录, 右键 <strong>通过 Code</strong> 打开</p><p><img src="image-20220513094214889.png" alt="image-20220513094214889"></p><p>进入到以下界面</p><p><img src="image-20220513094228729.png" alt="image-20220513094228729"></p><p>现在安装插件, 并退出vscode程序，之后重新 <code>blog</code>目录, 右键 <strong>通过 Code</strong> 打开</p><p><img src="image-20220513094320097.png" alt="image-20220513094320097"></p><p>现在快捷键 <strong>ctrl + shift + `</strong>  运行  <strong>npx hexo s</strong> </p><p><img src="image-20220513095212339.png" alt="image-20220513095212339"></p><p>访问本地的4000 <a href="http://localhost:4000/">http://localhost:4000/</a></p><p><img src="image-20220513095237808.png" alt="image-20220513095237808"></p><h1 id="github准备"><a href="#github准备" class="headerlink" title="github准备"></a>github准备</h1><h2 id="准备github仓库"><a href="#准备github仓库" class="headerlink" title="准备github仓库"></a>准备github仓库</h2><p>查看自己的账号名 , 我的为 <code>slcnx</code></p><p><img src="image-20220513095332738.png" alt="image-20220513095332738"></p><p>新建仓库  <code>slcnx.github.io</code> 格式是<code>用户名.github.io</code></p><p><img src="image-20220513095640820.png" alt="image-20220513095640820"></p><p><img src="image-20220513095652519.png" alt="image-20220513095652519"></p><h2 id="添加一个测试文件"><a href="#添加一个测试文件" class="headerlink" title="添加一个测试文件"></a>添加一个测试文件</h2><p><img src="image-20220513095752726.png" alt="image-20220513095752726"></p><p>一定要添加<code>index.html</code></p><p><img src="image-20220513095822054.png" alt="image-20220513095822054"></p><p>添加之后，刷新网页，过3分钟的样子，右下角出现 active</p><p><img src="image-20220513095942064.png" alt="image-20220513095942064"></p><p>访问网页 <a href="https://slcnx.github.io/">https://slcnx.github.io</a>  <code>用户名.github.io</code></p><p><img src="image-20220513100016239.png" alt="image-20220513100016239"></p><p>现在表示github.com已经正常</p><h2 id="配置github"><a href="#配置github" class="headerlink" title="配置github"></a>配置github</h2><p><img src="image-20220513100103791.png" alt="image-20220513100103791"></p><p><img src="image-20220513100129679.png" alt="image-20220513100129679"></p><p>现在需要生成一个公钥和密钥<code>ssh-keygen -t rsa -b 4096 -f id_rsa_2048 -P &#39;&#39;</code> 命令一定要对</p><blockquote><p>此处一定要在<code>Linux</code>主机上生成。之后下载 id_rsa_2048 id_rsa_2048.pub 到本地 博客blog目录</p></blockquote><p>vscode中查看公钥，复制公钥</p><p><img src="image-20220513100509093.png" alt="image-20220513100509093"></p><p><img src="image-20220513100606627.png" alt="image-20220513100606627"></p><p>看到以下内容表示OK</p><p><img src="image-20220513100630996.png" alt="image-20220513100630996"></p><h2 id="获取github的ssh地址"><a href="#获取github的ssh地址" class="headerlink" title="获取github的ssh地址"></a>获取github的ssh地址</h2><p><img src="image-20220513100825116.png" alt="image-20220513100825116"> </p><p><code>git@github.com:slcnx/slcnx.github.io.git</code></p><p>有docker的同学可以, 可以运行以下命令验证是否正常。<b style="color: red;">没有docker的同学，就不需要执行以下命令</b></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">docker build <span class="hljs-attr">--build-arg</span> GITHUB=git@github<span class="hljs-selector-class">.com</span>:slcnx/slcnx<span class="hljs-selector-class">.github</span><span class="hljs-selector-class">.io</span><span class="hljs-selector-class">.git</span> <span class="hljs-attr">--build-arg</span> EMAIL=<span class="hljs-string">&#x27;2192383945@qq.com&#x27;</span> <span class="hljs-attr">--build-arg</span> GUSER=<span class="hljs-string">&#x27;songliangcheng&#x27;</span> ./<br></code></pre></td></tr></table></figure><h1 id="codeup准备"><a href="#codeup准备" class="headerlink" title="codeup准备"></a>codeup准备</h1><h2 id="准备codeup仓库"><a href="#准备codeup仓库" class="headerlink" title="准备codeup仓库"></a>准备codeup仓库</h2><p><img src="image-20220513101358650.png" alt="image-20220513101358650"></p><p><img src="image-20220513101431944.png" alt="image-20220513101431944"></p><p>获取https地址 <code>https://codeup.aliyun.com/5f73e5a3728df4b180fab5ca/myblog-2022-05-13.git</code></p><p><img src="image-20220513101457691.png" alt="image-20220513101457691"></p><h2 id="本地推送代码"><a href="#本地推送代码" class="headerlink" title="本地推送代码"></a>本地推送代码</h2><p>先在blog目录中， 即进入CMD中，在blog目录中</p><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig"><span class="hljs-string">git</span> <span class="hljs-string">remote</span> <span class="hljs-built_in">set-url</span> <span class="hljs-string">origin</span> <span class="hljs-string">https</span>://<span class="hljs-string">codeup</span>.<span class="hljs-string">aliyun</span>.<span class="hljs-string">com</span>/<span class="hljs-string">5f73e5a3728df4b180fab5ca</span>/<span class="hljs-string">myblog-2022-05-13</span>.<span class="hljs-string">git</span><br></code></pre></td></tr></table></figure><p><img src="image-20220513101730325.png" alt="image-20220513101730325"></p><p>推送代码, 双击push.sh</p><p><img src="image-20220513101816443.png" alt="image-20220513101816443"></p><p>代码仓库, 已经有数据了</p><p><img src="image-20220513101839833.png" alt="image-20220513101839833"></p><h2 id="添加流水线"><a href="#添加流水线" class="headerlink" title="添加流水线"></a>添加流水线</h2><h3 id="进入流水线页面"><a href="#进入流水线页面" class="headerlink" title="进入流水线页面"></a>进入流水线页面</h3><p><img src="image-20220513101902870.png" alt="image-20220513101902870"></p><p><img src="image-20220513101910710.png" alt="image-20220513101910710"></p><p><img src="image-20220513101941108.png" alt="image-20220513101941108"></p><h3 id="配置流水线"><a href="#配置流水线" class="headerlink" title="配置流水线"></a>配置流水线</h3><p>因为代码中有submodule, 就启用</p><p><img src="image-20220513102015626.png" alt="image-20220513102015626"></p><p>定义构建镜像</p><p><img src="image-20220513102242848.png" alt="image-20220513102242848"></p><p><img src="image-20220513102317624.png" alt="image-20220513102317624"></p><p>配置构建参考，<strong>非常关键</strong>, 这里有3个参数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">EMAIL       你的QQ邮箱 <br>GUSER       你的用户名，任意<br>GITHUB      这里一定是你上面github创建的仓库的ssh地址，参考4.4获取githubssh地址。我的为 git@github.com:slcnx/slcnx.github.io.git<br></code></pre></td></tr></table></figure><p><img src="image-20220513103303012.png" alt="image-20220513103303012"></p><p>不需要发布所以删除kubernetes</p><p><img src="image-20220513102349111.png" alt="image-20220513102349111"></p><p>保存并运行</p><p><img src="image-20220513102407557.png" alt="image-20220513102407557"></p><h3 id="运行流水线"><a href="#运行流水线" class="headerlink" title="运行流水线"></a>运行流水线</h3><p><img src="image-20220513102417620.png" alt="image-20220513102417620"></p><h3 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h3><p><img src="image-20220513102440868.png" alt="image-20220513102440868"></p><p><img src="image-20220513103852668.png" alt="image-20220513103852668"></p><h3 id="查看github-com"><a href="#查看github-com" class="headerlink" title="查看github.com"></a>查看github.com</h3><p><img src="image-20220513103918387.png" alt="image-20220513103918387"></p><h1 id="查看网页"><a href="#查看网页" class="headerlink" title="查看网页"></a>查看网页</h1><p><a href="https://slcnx.github.io/">https://slcnx.github.io/</a></p><p><img src="image-20220513102518346.png" alt="image-20220513102518346"></p><h1 id="写新的文章"><a href="#写新的文章" class="headerlink" title="写新的文章"></a>写新的文章</h1><h2 id="添加文章"><a href="#添加文章" class="headerlink" title="添加文章"></a>添加文章</h2><p>运行<code>addarticle.sh</code>脚本, 写标题  <strong>第3个文章</strong></p><p><img src="image-20220513102558031.png" alt="image-20220513102558031"></p><p>会自动弹出博客编写页面 编写<strong>第3个文章</strong></p><p><img src="image-20220513103034036.png" alt="image-20220513103034036"></p><p><img src="image-20220513103100965.png" alt="image-20220513103100965"></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">第3个文章</span><br><span class="hljs-attr">tags:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">linux</span><br><span class="hljs-attr">categories:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">hexo</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2022-05-13 10:26:14</span><br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-comment"># 背景</span><br><br><span class="hljs-string">hello</span><br><br><span class="hljs-type">![image</span><span class="hljs-number">-20220513102937310</span><span class="hljs-string">](第3个文章/image-20220513102937310.png)</span><br><br><span class="hljs-string">&lt;!--more--&gt;</span><br></code></pre></td></tr></table></figure><h2 id="发布文章"><a href="#发布文章" class="headerlink" title="发布文章"></a>发布文章</h2><p>运行push.sh脚本</p><p><img src="image-20220513102729742.png" alt="image-20220513102729742"></p><h2 id="查看网页-1"><a href="#查看网页-1" class="headerlink" title="查看网页"></a>查看网页</h2><p><img src="image-20220513104016387.png" alt="image-20220513104016387"></p><h1 id="自定义网页样式"><a href="#自定义网页样式" class="headerlink" title="自定义网页样式"></a>自定义网页样式</h1>]]></content>
    
    
    <categories>
      
      <category>完全免费</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>免费搞网站-gitpages</title>
    <link href="/2022/05/12/%E5%85%8D%E8%B4%B9%E6%90%9E%E7%BD%91%E7%AB%99-gitpages/"/>
    <url>/2022/05/12/%E5%85%8D%E8%B4%B9%E6%90%9E%E7%BD%91%E7%AB%99-gitpages/</url>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>完全免费的git网站搭建, 参考 <a href="https://blog.csdn.net/yaorongke/article/details/119089190">https://blog.csdn.net/yaorongke/article/details/119089190</a></p><p>实现的目标: 本地写markdown, 推送github即可以看 github.io 域名查看网页。</p><p>实现的工具</p><ul><li><code>nodejs</code>           hexo生成网站</li><li><code>codeup.aliyun.com</code>    保存自己的博客代码</li><li><code>github.com</code>   静态页面展示 </li><li><code>vscode</code>   开发工具</li></ul><span id="more"></span><h1 id="生成静态页面"><a href="#生成静态页面" class="headerlink" title="生成静态页面"></a>生成静态页面</h1><p>参考  <a href="https://blog.csdn.net/yaorongke/article/details/119089190">https://blog.csdn.net/yaorongke/article/details/119089190</a> 确保访问OK</p><p>slcnx.github.io 仓库名</p><p>准备index.html</p><figure class="highlight xml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>主页<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  hello world<br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="20220512214701-16524035403072.png" alt="image-20220512214700115"></p><p><img src="20220512214623.png" alt="image-20220512214617755"></p><h1 id="docker推送github"><a href="#docker推送github" class="headerlink" title="docker推送github"></a>docker推送github</h1><p>新建临时目录，vscode打开, 准备以下文件</p><p>id_rsa_2048 <strong>需要linux生成或xshell生成，不可以自己生成</strong></p><p>id_rsa_2048的公钥加入到以上仓库中</p><p><img src="20220512225649.png" alt="image-20220512225647448"></p><p>Dockerfile</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">FROM</span> node:latest<br><br><br>WORKDIR /data/git <br><br><span class="hljs-built_in">ADD</span> id_rsa_2048 /root/.ssh/<br><span class="hljs-built_in">RUN</span>  chmod 600 /root/.ssh/id_rsa_2048 <br><br><span class="hljs-built_in">ADD</span> . ./<br><br><span class="hljs-comment"># 生成网页</span><br><span class="hljs-comment">#RUN npm run build </span><br><br><br><span class="hljs-comment"># 上传到GIT</span><br><br><span class="hljs-built_in">RUN</span> install -dv /data/page/ &amp;&amp; cp -a index.html /data/page/<br><br><br>WORKDIR /data/page/<br>ENV <span class="hljs-attribute">GIT_SSH_COMMAND</span>=<span class="hljs-string">&#x27;ssh -i /root/.ssh/id_rsa_2048  -o IdentitiesOnly=yes -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no&#x27;</span><br><span class="hljs-built_in">RUN</span> git<span class="hljs-built_in"> config </span>--global init.defaultBranch main &amp;&amp; git<span class="hljs-built_in"> config </span>--global user.email <span class="hljs-string">&#x27;2192383945@qq.com&#x27;</span> &amp;&amp; git<span class="hljs-built_in"> config </span>--global user.name <span class="hljs-string">&#x27;songliangcheng&#x27;</span>  &amp;&amp; \<br>    git<span class="hljs-built_in"> config </span>--global pull.rebase <span class="hljs-literal">true</span> &amp;&amp; \<br>    git init &amp;&amp; \<br>    git remote <span class="hljs-built_in">add</span> origin git@github.com:slcnx/slcnx.github.io.git &amp;&amp; git <span class="hljs-built_in">add</span> -A &amp;&amp; git commit -m init &amp;&amp; git push --force origin main <br></code></pre></td></tr></table></figure><p>index.html</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>主页<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    cat<br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">D:\vscode_projects\myblog&gt;docker build -t <span class="hljs-built_in">test</span> .<br></code></pre></td></tr></table></figure><p><img src="20220512223352.png" alt="image-20220512223351323"></p><h1 id="本地生成hexo仓库"><a href="#本地生成hexo仓库" class="headerlink" title="本地生成hexo仓库"></a>本地生成hexo仓库</h1><h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install hexo-cli -g<br><br><span class="hljs-comment"># 当前目录为项目根</span><br>hexo init test1blog<br><span class="hljs-built_in">cd</span> test1blog<br><br><span class="hljs-comment"># 内容</span><br>$ <span class="hljs-built_in">ls</span><br>_config.landscape.yml  node_modules/  package-lock.json  <span class="hljs-built_in">source</span>/<br>_config.yml            package.json   scaffolds/         themes/<br></code></pre></td></tr></table></figure><h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta">hexo <span class="hljs-keyword">server</span><br></code></pre></td></tr></table></figure><p><img src="20220512224452.png" alt="image-20220512224451207"></p><h2 id="发布到github"><a href="#发布到github" class="headerlink" title="发布到github"></a>发布到github</h2><p>在以上目录 <code>test1blog</code> 中生成以下文件</p><ol><li><p><code>.dockerignore</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">node_modules/<br></code></pre></td></tr></table></figure></li><li><p><code>Dockerfile</code></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> node:latest<br><br><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /data/git </span><br><br><span class="hljs-keyword">ADD</span><span class="language-bash"> id_rsa_2048 /root/.ssh/</span><br><span class="hljs-keyword">RUN</span><span class="language-bash">  <span class="hljs-built_in">chmod</span> 600 /root/.ssh/id_rsa_2048 </span><br><br><span class="hljs-keyword">ADD</span><span class="language-bash"> . ./</span><br><br><span class="hljs-comment"># 生成网页</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> npm install &amp;&amp; npm run build </span><br><br><span class="hljs-comment"># 上传到GIT</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> install -dv /data/page/ &amp;&amp; <span class="hljs-built_in">cp</span> -a public /data/page/</span><br><br><span class="hljs-keyword">ARG</span> GITHUB<br><span class="hljs-keyword">ARG</span> GUSER <br><span class="hljs-keyword">ARG</span> EMAIL <br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /data/page/public/</span><br><span class="hljs-keyword">ENV</span> GIT_SSH_COMMAND=<span class="hljs-string">&#x27;ssh -i /root/.ssh/id_rsa_2048  -o IdentitiesOnly=yes -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no&#x27;</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> git config --global init.defaultBranch main &amp;&amp; git config --global user.email <span class="hljs-variable">$EMAIL</span>  &amp;&amp; git config --global user.name <span class="hljs-variable">$GUSER</span>  &amp;&amp; \</span><br><span class="language-bash">    git config --global pull.rebase <span class="hljs-literal">true</span> &amp;&amp; \</span><br><span class="language-bash">    git init &amp;&amp; \</span><br><span class="language-bash">    git remote add origin <span class="hljs-variable">$GITHUB</span> &amp;&amp; git add -A &amp;&amp; git commit -m init &amp;&amp; git push --force origin main </span><br></code></pre></td></tr></table></figure></li><li><p><code>id_rsa_2048</code> 以上与github互通的密钥</p></li><li><p>发布</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">docker build <span class="hljs-attr">--build-arg</span> GITHUB=git@github<span class="hljs-selector-class">.com</span>:slcnx/slcnx<span class="hljs-selector-class">.github</span><span class="hljs-selector-class">.io</span><span class="hljs-selector-class">.git</span> <span class="hljs-attr">--build-arg</span> EMAIL=<span class="hljs-string">&#x27;2192383945@qq.com&#x27;</span> <span class="hljs-attr">--build-arg</span> GUSER=<span class="hljs-string">&#x27;songliangcheng&#x27;</span> ./<br></code></pre></td></tr></table></figure></li></ol><p><img src="20220512225143.png" alt="image-20220512225141348"></p><h1 id="codeup一键发布"><a href="#codeup一键发布" class="headerlink" title="codeup一键发布"></a>codeup一键发布</h1><h2 id="添加codeup仓库"><a href="#添加codeup仓库" class="headerlink" title="添加codeup仓库"></a>添加codeup仓库</h2><p>将当前仓库加入到自己的codeup中</p><p><img src="20220512230442.png" alt="image-20220512230441057"></p><p>复制https地址 <a href="https://codeup.aliyun.com/5f73e5a3728df4b180fab5ca/myblog-2022-05-12.git">https://codeup.aliyun.com/5f73e5a3728df4b180fab5ca/myblog-2022-05-12.git</a></p><h2 id="初始化代码"><a href="#初始化代码" class="headerlink" title="初始化代码"></a>初始化代码</h2><p>将上面test1blog中，初始化，添加代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">git config --global init.defaultBranch main<br>git init<br>git remote add origin https://codeup.aliyun.com/5f73e5a3728df4b180fab5ca/myblog-2022-05-12.git<br></code></pre></td></tr></table></figure><p>添加文件 <code>.gitignore</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Logs</span><br>logs<br>*.<span class="hljs-built_in">log</span><br>npm-debug.log*<br>yarn-debug.log*<br>yarn-error.log*<br>lerna-debug.log*<br>.pnpm-debug.log*<br><br><span class="hljs-comment"># Diagnostic reports (https://nodejs.org/api/report.html)</span><br>report.[0-9]*.[0-9]*.[0-9]*.[0-9]*.json<br><br><span class="hljs-comment"># Runtime data</span><br>pids<br>*.pid<br>*.seed<br>*.pid.lock<br><br><span class="hljs-comment"># Directory for instrumented libs generated by jscoverage/JSCover</span><br>lib-cov<br><br><span class="hljs-comment"># Coverage directory used by tools like istanbul</span><br>coverage<br>*.lcov<br><br><span class="hljs-comment"># nyc test coverage</span><br>.nyc_output<br><br><span class="hljs-comment"># Grunt intermediate storage (https://gruntjs.com/creating-plugins#storing-task-files)</span><br>.grunt<br><br><span class="hljs-comment"># Bower dependency directory (https://bower.io/)</span><br>bower_components<br><br><span class="hljs-comment"># node-waf configuration</span><br>.lock-wscript<br><br><span class="hljs-comment"># Compiled binary addons (https://nodejs.org/api/addons.html)</span><br>build/Release<br><br><span class="hljs-comment"># Dependency directories</span><br>node_modules/<br>jspm_packages/<br><br><span class="hljs-comment"># Snowpack dependency directory (https://snowpack.dev/)</span><br>web_modules/<br><br><span class="hljs-comment"># TypeScript cache</span><br>*.tsbuildinfo<br><br><span class="hljs-comment"># Optional npm cache directory</span><br>.npm<br><br><span class="hljs-comment"># Optional eslint cache</span><br>.eslintcache<br><br><span class="hljs-comment"># Optional stylelint cache</span><br>.stylelintcache<br><br><span class="hljs-comment"># Microbundle cache</span><br>.rpt2_cache/<br>.rts2_cache_cjs/<br>.rts2_cache_es/<br>.rts2_cache_umd/<br><br><span class="hljs-comment"># Optional REPL history</span><br>.node_repl_history<br><br><span class="hljs-comment"># Output of &#x27;npm pack&#x27;</span><br>*.tgz<br><br><span class="hljs-comment"># Yarn Integrity file</span><br>.yarn-integrity<br><br><span class="hljs-comment"># dotenv environment variable files</span><br>.<span class="hljs-built_in">env</span><br>.env.development.local<br>.env.test.local<br>.env.production.local<br>.env.local<br><br><span class="hljs-comment"># parcel-bundler cache (https://parceljs.org/)</span><br>.cache<br>.parcel-cache<br><br><span class="hljs-comment"># Next.js build output</span><br>.next<br>out<br><br><span class="hljs-comment"># Nuxt.js build / generate output</span><br>.nuxt<br>dist<br><br><span class="hljs-comment"># Gatsby files</span><br>.cache/<br><span class="hljs-comment"># Comment in the public line in if your project uses Gatsby and not Next.js</span><br><span class="hljs-comment"># https://nextjs.org/blog/next-9-1#public-directory-support</span><br><span class="hljs-comment"># public</span><br><br><span class="hljs-comment"># vuepress build output</span><br>.vuepress/dist<br><br><span class="hljs-comment"># vuepress v2.x temp and cache directory</span><br>.temp<br>.cache<br><br><span class="hljs-comment"># Docusaurus cache and generated files</span><br>.docusaurus<br><br><span class="hljs-comment"># Serverless directories</span><br>.serverless/<br><br><span class="hljs-comment"># FuseBox cache</span><br>.fusebox/<br><br><span class="hljs-comment"># DynamoDB Local files</span><br>.dynamodb/<br><br><span class="hljs-comment"># TernJS port file</span><br>.tern-port<br><br><span class="hljs-comment"># Stores VSCode versions used for testing VSCode extensions</span><br>.vscode-test<br><br><span class="hljs-comment"># yarn v2</span><br>.yarn/cache<br>.yarn/unplugged<br>.yarn/build-state.yml<br>.yarn/install-state.gz<br>.pnp.*<br><br><br><span class="hljs-comment"># 静态文件</span><br>public <br></code></pre></td></tr></table></figure><h2 id="推送aliyun"><a href="#推送aliyun" class="headerlink" title="推送aliyun"></a>推送aliyun</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 状态</span><br>$ git status<br>hint: core.useBuiltinFSMonitor will be deprecated soon; use core.fsmonitor instead<br>hint: Disable this message with <span class="hljs-string">&quot;git config advice.useCoreFSMonitorConfig false&quot;</span><br>On branch main<br><br>No commits yet<br><br>Untracked files:<br>  (use <span class="hljs-string">&quot;git add &lt;file&gt;...&quot;</span> to include <span class="hljs-keyword">in</span> what will be committed)<br>        .dockerignore<br>        .github/<br>        .gitignore<br>        .npmignore<br>        Dockerfile<br>        _config.landscape.yml<br>        _config.yml<br>        db.json<br>        id_rsa_2048<br>        package-lock.json<br>        package.json<br>        scaffolds/<br>        <span class="hljs-built_in">source</span>/<br>        themes/<br>        <br><span class="hljs-comment"># 生成标志</span><br>$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;1111&#x27;</span> &gt;&gt; <span class="hljs-built_in">source</span>/_posts/hello-world.md<br><br><span class="hljs-comment"># 推送</span><br>git add . <br>git commit -m init<br><br>$ git push origin main<br>Enumerating objects: 122, <span class="hljs-keyword">done</span>.<br>Counting objects: 100% (122/122), <span class="hljs-keyword">done</span>.<br>Delta compression using up to 8 threads<br>Compressing objects: 100% (110/110), <span class="hljs-keyword">done</span>.<br>Writing objects: 100% (122/122), 580.00 KiB | 7.34 MiB/s, <span class="hljs-keyword">done</span>.<br>Total 122 (delta 0), reused 0 (delta 0), pack-reused 0<br>To https://codeup.aliyun.com/5f73e5a3728df4b180fab5ca/myblog-2022-05-12.git<br> * [new branch]      main -&gt; main<br><br></code></pre></td></tr></table></figure><h2 id="aliyun验证"><a href="#aliyun验证" class="headerlink" title="aliyun验证"></a>aliyun验证</h2><p><img src="20220512231059.png" alt="image-20220512231058218"></p><h2 id="添加流水线"><a href="#添加流水线" class="headerlink" title="添加流水线"></a>添加流水线</h2><p><img src="20220512231120.png" alt="image-20220512231118465"></p><p><img src="20220512231146.png" alt="image-20220512231145367"></p><p><img src="20220513000840.png" alt="image-20220513000838863"></p><p><img src="20220512231255.png" alt="image-20220512231253578"></p><p><img src="20220512231628.png" alt="image-20220512231626849"></p><p>删除kubernetes发布</p><p>保存并运行</p><p><img src="20220512231324.png" alt="image-20220512231322519"></p><h2 id="查看运行日志"><a href="#查看运行日志" class="headerlink" title="查看运行日志"></a>查看运行日志</h2><p><img src="20220512232021.png" alt="image-20220512232019242"></p><h2 id="查看github进度"><a href="#查看github进度" class="headerlink" title="查看github进度"></a>查看github进度</h2><p><img src="20220512232122.png" alt="image-20220512232121239"></p><h2 id="查看页面"><a href="#查看页面" class="headerlink" title="查看页面"></a>查看页面</h2><p>当进度为</p><p><img src="20220512232141.png" alt="image-20220512232140087"></p><p><img src="20220512232151.png" alt="image-20220512232150142"></p><h1 id="开发方式"><a href="#开发方式" class="headerlink" title="开发方式"></a>开发方式</h1><h2 id="准备vscode"><a href="#准备vscode" class="headerlink" title="准备vscode"></a>准备vscode</h2><p>在vscode中加载 codeup的仓库</p><p>安装插件 typora  <strong>安装后需要重启vscode</strong></p><p><img src="20220512231737.png" alt="image-20220512231735959"></p><h2 id="本地开发"><a href="#本地开发" class="headerlink" title="本地开发"></a>本地开发</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># clone 代码</span><br><br><span class="hljs-comment"># 安装依赖</span><br>npm install<br><br><span class="hljs-comment"># 运行服务</span><br>npx hexo server<br></code></pre></td></tr></table></figure><blockquote><p><code>npx command</code> 相当于加载了<code>$(npm bin)</code> 目录到环境变量, 后面的命令可以执行</p></blockquote><p>通过本地调试出合理的界面, 推送aliyun, 就可以一键发布</p><h2 id="本地添加文章"><a href="#本地添加文章" class="headerlink" title="本地添加文章"></a>本地添加文章</h2><p>脚本 <code>addarticle.sh</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">echo -ne <span class="hljs-string">&quot;Enter a \033[1;31mtitle\033[0m for your blog: &quot;</span>; read title<br>[ $? -ne <span class="hljs-number">0</span> ] &amp;&amp; echo <span class="hljs-string">&#x27;exit&#x27;</span> &amp;&amp; sleep <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-keyword">exit</span> <span class="hljs-number">1</span><br>[ -z <span class="hljs-string">&quot;$title&quot;</span> ] &amp;&amp; echo title must be exists. &amp;&amp; sleep <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-keyword">exit</span> <span class="hljs-number">1</span><br>npx hexo new <span class="hljs-string">&quot;$title&quot;</span><br><br>start $(readlink -f .)<span class="hljs-regexp">/source/</span>_posts<br></code></pre></td></tr></table></figure><p>生成文章, 运行脚本</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">第1个文章</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2022-05-12 23:27:58</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><h2 id="个性化页面展示"><a href="#个性化页面展示" class="headerlink" title="个性化页面展示"></a>个性化页面展示</h2><p><a href="https://blog.csdn.net/yaorongke/article/details/119089190">https://blog.csdn.net/yaorongke/article/details/119089190</a></p><ul><li><code>hexo站点配置</code></li><li><code>fluid</code>主题配置</li><li><code>阅读量</code></li><li><code>评论功能</code></li></ul><p>例如修改标题 <code>_config.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">&quot;5-12 23:30&quot;</span><br><span class="hljs-comment"># ...</span><br><br><span class="hljs-attr">post_asset_folder:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 处理typora相对路径</span><br>npm install hexo-typora-asset --registry https://registry.npmjs.org --save<br></code></pre></td></tr></table></figure><p>typora中的配置</p><p><img src="image-20220513092438970.png" alt="image-20220513092438970"></p><p>重启 <code>npx hexo server</code></p><p><img src="20220512233119.png" alt="image-20220512233117729"></p><h2 id="文章默认页面-可选"><a href="#文章默认页面-可选" class="headerlink" title="文章默认页面(可选)"></a>文章默认页面(可选)</h2><p><a href="https://hexo.io/docs/writing#Scaffolds">https://hexo.io/docs/writing#Scaffolds</a></p><p>当我们写大量的文章,发现主页不应该显示所有内容,需要readmore, readmore之前有1小段简介</p><p>如下, 上面的nginx文章会<code>显示标题,简介,readmore</code>, 而下面的hello world就显示所有, 这两者区别在于</p><p>后者,默认</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">第1个文章</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2022-05-12 23:27:58</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><p>前者</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">第1个文章</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2022-05-12 23:27:58</span><br><span class="hljs-attr">tags:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">hello</span><br><span class="hljs-attr">categories:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">nginx</span><br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-comment"># 背景</span><br><br><span class="hljs-string">这篇讲解如何编译安装nginx,</span> <span class="hljs-string">优化nginx</span><br><br><span class="hljs-string">&lt;!--more--&gt;</span><br></code></pre></td></tr></table></figure><p><img src="20220512234116.png" alt="image-20220512234114962"></p><p>要实现每个文章创建均生成nginx这样的模板, 编辑 <code>scaffolds/post.md</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> &#123;&#123; <span class="hljs-string">title</span> &#125;&#125;<br><span class="hljs-attr">date:</span> &#123;&#123; <span class="hljs-string">date</span> &#125;&#125;<br><span class="hljs-attr">tags:</span><br><span class="hljs-bullet">-</span> <br><span class="hljs-attr">categories:</span><br><span class="hljs-bullet">-</span> <br><span class="hljs-meta">---</span><br><span class="hljs-meta"></span><br><span class="hljs-comment"># 背景</span><br><br><span class="hljs-string">&lt;!--more--&gt;</span><br></code></pre></td></tr></table></figure><p>现在运行脚本 <code>addarticle.sh</code> 添加<strong>第2个文章</strong></p><p>网页已经达到效果</p><p><img src="20220512234553.png" alt="image-20220512234551537"></p><h2 id="准备一个主题-fluid"><a href="#准备一个主题-fluid" class="headerlink" title="准备一个主题 fluid"></a>准备一个主题 fluid</h2><blockquote><p>使用此主题后, 不需要前面的文章默认页面, 每个页面不需要加<code>&lt;!--more--&gt;</code> 主题会自动抽取前多少个字符,作为描述的.</p></blockquote><p>Fluid主题 <a href="https://blog.csdn.net/yaorongke/article/details/119089190">https://blog.csdn.net/yaorongke/article/details/119089190</a></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">$ git submodule add https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/fluid-dev/</span>hexo-theme-fluid.git themes/fluid<br></code></pre></td></tr></table></figure><p>编辑 <code>_config.yml</code></p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs clean"># Extensions<br>## Plugins: https:<span class="hljs-comment">//hexo.io/plugins/</span><br>## Themes: https:<span class="hljs-comment">//hexo.io/themes/</span><br>theme: fluid<br></code></pre></td></tr></table></figure><p>重启 <code>npx hexo server</code></p><p><img src="20220512235039.png" alt="image-20220512235038001"></p><p>配置主题 <code>fluid</code> 需要准备一个文件 <code>_config.主题名.yml</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">cp themes<span class="hljs-regexp">/fluid/</span>_config.yml _config.fluid.yml<br></code></pre></td></tr></table></figure><p>测试配置是否生效,修改 <code>_config.fluid.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># 首页副标题的独立设置</span><br><span class="hljs-comment"># Independent config of home page subtitle</span><br><span class="hljs-attr">slogan:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br><br>  <span class="hljs-comment"># 为空则按 hexo config.subtitle 显示</span><br>  <span class="hljs-comment"># If empty, text based on `subtitle` in hexo config</span><br>  <span class="hljs-attr">text:</span> <span class="hljs-string">&quot;Hello 05-12 .... &quot;</span><br></code></pre></td></tr></table></figure><p>重启 <code>npx hexo server</code></p><p><img src="20220512235647.png" alt="image-20220512235645718"></p><h2 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h2><p>准备脚本 <code>push.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>git config --<span class="hljs-built_in">local</span> pull.rebase <span class="hljs-literal">true</span><br>git add .<br>git commit -m <span class="hljs-string">&quot;笔记本-`date +%F_%T`&quot;</span><br><br><br>git push origin main<br><br>git pull origin main<br>[ $? -ne 0 ] &amp;&amp; <span class="hljs-built_in">exit</span> -1<br><br>git push origin main<br><br><span class="hljs-comment"># test</span><br>start $(<span class="hljs-built_in">readlink</span> -f .)/source/_posts<br></code></pre></td></tr></table></figure><p><a href="https://slcnx.github.io/">https://slcnx.github.io/</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
